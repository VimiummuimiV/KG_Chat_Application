// ==UserScript==
// @name         KG_Chat_Application
// @namespace    klavogonki
// @version      3.7.2
// @description  Enhance the chat abilities
// @author       Patcher
// @match        *://klavogonki.ru/*
// @exclude      *://klavogonki.ru/g/?gmid=*
// @exclude      *://klavogonki.ru/chatlogs/*
// @exclude      *://klavogonki.ru/storage/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=klavogonki.ru
// @grant        GM_xmlhttpRequest
// @downloadURL  https://update.greasyfork.org/scripts/529368/KG_Chat_Application.user.js
// @updateURL    https://update.greasyfork.org/scripts/529368/KG_Chat_Application.meta.js
// ==/UserScript==

(()=>{"use strict";var e={56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72:e=>{var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var a={},i=[],s=0;s<e.length;s++){var c=e[s],l=o.base?c[0]+o.base:c[0],d=a[l]||0,m="".concat(l," ").concat(d);a[l]=d+1;var u=n(m),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)t[u].references++,t[u].updater(p);else{var h=r(p,o);o.byIndex=s,t.splice(s,0,{identifier:m,updater:h,references:1})}i.push(m)}return i}function r(e,t){var n=t.domAPI(t);n.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var a=o(e=e||[],r=r||{});return function(e){e=e||[];for(var i=0;i<a.length;i++){var s=n(a[i]);t[s].references--}for(var c=o(e,r),l=0;l<a.length;l++){var d=n(a[l]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}a=c}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(i[c]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},416:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.update-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5);z-index:1200}.update-popup{position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);background:var(--main-background-color) !important;padding:1em;border:1px solid #333 !important;border-radius:.4em !important;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;color:#cdb398 !important;font-family:"Gill Sans","Gill Sans MT",Calibri,"Trebuchet MS",sans-serif;z-index:1250;max-width:400px;min-width:300px}.update-popup .update-header{margin-top:0 !important;font-size:1.5em !important;text-align:center !important;color:var(--secondary-accent-color) !important}.update-popup .update-script{margin:1rem 0 !important;text-align:center !important;font-size:1.2em !important;color:#4285f4 !important}.update-popup p{margin:.5rem 0;text-align:center}.update-popup p .version{font-weight:bold;color:var(--secondary-accent-color) !important}.update-popup .button-container{display:flex;justify-content:center;margin-top:15px}.update-popup .button-container button{padding:5px 10px !important;width:100% !important;border-radius:.2em !important;cursor:pointer !important;font-size:1rem !important;border:none !important;transition:background-color .15s !important}.update-popup .button-container button.update-later{margin-right:10px;background:#f1f1f1}.update-popup .button-container button.update-skip{margin-right:10px;background:#fc0;color:#333}.update-popup .button-container button.update-now{background:#4285f4;color:#fff}.update-popup .button-container button:hover{opacity:.9}',""]);const s=i},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},550:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap);"]),i.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap);"]),i.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Iansui&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap);"]),i.push([e.id,'.light-theme{--main-background-color: #ffffff;--secondary-background-color: #f0f0f0;--main-text-color: #555555;--main-accent-color: #555555;--secondary-accent-color: #ff7f50;--third-accent-color: #77b300;--link-color: #007acc;--link-hover-color: #005f99;--drag-area-background-color: #e0e0e0;--scrollbar-thumb-color: #eaeaea;--scrollbar-track-color: #ffffff;--border-color: #eaeaea;--confirm-button-color: #2e6c30;--confirm-button-hover-color: #38833c;--confirm-button-text-color: #90ee90;--yes-button-color: #5f821f;--no-button-color: #b34a2a;--theme-button-color: #2a75b3;--hotkey-label-text-color: #40bfff;--hotkey-label-background-color: #7ed4ff60;--hotkey-label-border-color: #7ed4ff66;--private-mode-color: #9b2b2b !important;--private-mode-placeholder-color: #9b2b2b99 !important;--private-mode-background-color: #ff6b6b55 !important;--private-message-sent-color: #228b22 !important;--private-message-sent-background-color: #228b2220 !important;--private-message-sent-border-color: #228b2230 !important;--private-message-sent-time-color: #228b22 !important;--private-message-received-color: #b22222 !important;--private-message-received-background-color: #b2222220 !important;--private-message-received-border-color: #b2222230 !important;--private-message-received-time-color: #b22222 !important;--system-message-color: #d2691e !important;--system-message-background-color: #d2691e20 !important;--system-message-border-color: #d2691e30 !important;--system-message-time-color: #d2691e !important}.light-gray-theme{--main-background-color: #d3d3d3;--secondary-background-color: #e0e0e0;--main-text-color: #3e3e3e;--main-accent-color: #3e3e3e;--secondary-accent-color: #ff7f50;--third-accent-color: #77b300;--link-color: #005f99;--link-hover-color: #007acc;--drag-area-background-color: #c0c0c0;--scrollbar-thumb-color: #bdbdbd;--scrollbar-track-color: #d3d3d3;--border-color: #bdbdbd;--confirm-button-color: #2e6c30;--confirm-button-hover-color: #38833c;--confirm-button-text-color: #90ee90;--yes-button-color: #5f821f;--no-button-color: #b34a2a;--theme-button-color: #2a75b3;--hotkey-label-text-color: #3aa1d5;--hotkey-label-background-color: #7ed4ff60;--hotkey-label-border-color: #7ed4ff;--private-mode-color: #9b2b2b !important;--private-mode-placeholder-color: #9b2b2bbb !important;--private-mode-background-color: #ff6b6b70 !important;--private-message-sent-color: #228b22 !important;--private-message-sent-background-color: #228b2220 !important;--private-message-sent-border-color: #228b2230 !important;--private-message-sent-time-color: #228b22 !important;--private-message-received-color: #b22222 !important;--private-message-received-background-color: #b2222220 !important;--private-message-received-border-color: #b2222230 !important;--private-message-received-time-color: #b22222 !important;--system-message-color: #d2691e !important;--system-message-background-color: #d2691e20 !important;--system-message-border-color: #d2691e30 !important;--system-message-time-color: #d2691e !important}.dark-theme{--main-background-color: #1e1e1e;--secondary-background-color: #2a2a2a;--main-text-color: #cdb398;--main-accent-color: #cdb398;--secondary-accent-color: #ffa500;--third-accent-color: #00ff58;--link-color: #82b32a;--link-hover-color: #95cc30;--drag-area-background-color: #161616cc;--scrollbar-thumb-color: #333333;--scrollbar-track-color: #1e1e1e;--border-color: #333333;--confirm-button-color: #2e6c30;--confirm-button-hover-color: #38833c;--confirm-button-text-color: #90ee90;--yes-button-color: #82b32a;--no-button-color: #b34a2a;--theme-button-color: #b3a52a;--hotkey-label-text-color: #7ed4ff;--hotkey-label-background-color: #7ed4ff1a;--hotkey-label-border-color: #7ed4ff66;--private-mode-color: #ff6b6b !important;--private-mode-placeholder-color: #ff6b6bbb !important;--private-mode-background-color: #ff6b6b38 !important;--private-message-sent-color: #00d000;--private-message-sent-background-color: #00ff0020 !important;--private-message-sent-border-color: #00ff0030 !important;--private-message-sent-time-color: #00ff0060 !important;--private-message-received-color: #ff4d4d !important;--private-message-received-background-color: #ff4d4d20 !important;--private-message-received-border-color: #ff4d4d30 !important;--private-message-received-time-color: #ff4d4d60 !important;--system-message-color: #ffa500 !important;--system-message-background-color: #ffa50020 !important;--system-message-border-color: #ffa60030 !important;--system-message-time-color: #ffa50060 !important}#app-chat-container{border-radius:.4em .4em 0 0 !important;position:fixed;bottom:0;left:0;height:300px;background-color:var(--main-background-color) !important;color:var(--main-text-color) !important;border:1px solid var(--border-color) !important;display:flex;font-family:sans-serif;z-index:999;min-width:320px !important;box-sizing:border-box;max-width:100vw;overflow:hidden;transition:opacity .3s ease,transform .4s cubic-bezier(0.68, -0.55, 0.265, 1.55)}#app-chat-container a{color:var(--link-color) !important;transition:color .15s !important}#app-chat-container a:hover{color:var(--link-hover-color) !important}#app-chat-container img{text-align:unset !important;position:unset !important;padding:unset;margin:unset;display:unset;max-width:unset}#app-chat-container .break-content{display:inline-flex !important;flex-basis:100% !important;margin:0 !important;white-space:pre-wrap !important;flex-wrap:wrap !important}#app-chat-container.maximized{position:fixed !important;z-index:1010 !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;width:100vw !important;height:100vh !important;border-radius:0 !important;overflow:hidden !important;background-color:var(--main-background-color) !important;display:flex !important;flex-direction:column !important}#app-chat-container:not(.visible-chat):not(.hidden-chat):not(.maximized):not(.floating-chat){display:none;opacity:0}#app-chat-container.visible-chat{transform:translateY(0) !important}#app-chat-container.hidden-chat{opacity:1;transform:translateY(calc(100% - 25px)) !important}#app-chat-container.floating-chat{border-radius:.4em !important}#app-chat-container .font-size-control{position:absolute !important;top:0 !important;left:0 !important;display:flex !important;align-items:center !important;justify-content:center !important;height:25px !important;padding:0 10px !important;gap:5px !important;z-index:6 !important}#app-chat-container .font-size-control .font-size-slider{width:80px !important;height:4px !important;-webkit-appearance:none !important;appearance:none !important;background-color:var(--secondary-background-color) !important;outline:none !important;border-radius:2px !important;transition:opacity .2s !important}#app-chat-container .font-size-control .font-size-slider::-webkit-slider-thumb{-webkit-appearance:none !important;appearance:none !important;width:10px !important;height:10px !important;border-radius:50% !important;background:var(--main-accent-color) !important;cursor:pointer !important}#app-chat-container .font-size-control .font-size-slider::-moz-range-thumb{width:10px !important;height:10px !important;border-radius:50% !important;background:var(--main-accent-color) !important;cursor:pointer !important;border:none !important}#app-chat-container .resize-handle{position:absolute !important;background:rgba(0,0,0,0) !important;z-index:1000 !important}#app-chat-container .resize-handle.top{top:-3px !important;left:0 !important;right:0 !important;height:6px !important;cursor:ns-resize !important}#app-chat-container .resize-handle.left{left:-3px !important;top:0 !important;bottom:0 !important;width:6px !important;cursor:ew-resize !important}#app-chat-container .resize-handle.right{right:-3px !important;top:0 !important;bottom:0 !important;width:6px !important;cursor:ew-resize !important}#app-chat-container .chat-wrapper{display:flex !important;flex-direction:row !important;flex:1 !important;min-width:320px !important;overflow:hidden !important;background-color:var(--main-background-color) !important}#app-chat-container .chat-content{margin-top:25px;background-color:var(--main-background-color) !important;display:flex !important;flex-direction:column !important;flex:1 !important;overflow:hidden !important}#app-chat-container .messages-panel{flex:1 !important;overflow-y:auto !important;overflow-x:hidden !important;padding:1em !important;display:flex;flex-direction:column !important;gap:.2em !important;scrollbar-width:thin !important;scrollbar-color:var(--scrollbar-thumb-color) var(--scrollbar-track-color) !important}#app-chat-container .messages-panel.keyboard-active{transition:margin-bottom .3s ease !important}#app-chat-container .messages-panel::-webkit-scrollbar{width:8px !important}#app-chat-container .messages-panel::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb-color) !important}#app-chat-container .messages-panel::-webkit-scrollbar-track{background-color:var(--scrollbar-track-color) !important}#app-chat-container .input-container{display:flex !important;width:100%;align-items:center !important;padding:1em !important;gap:.5em !important;border-top:1px solid var(--border-color) !important;background-color:var(--main-background-color) !important}#app-chat-container #message-input{outline:none !important;flex:1 !important;background:#2a2a2a !important;background-color:var(--secondary-background-color) !important;color:var(--main-text-color) !important;padding:.5em !important;border-radius:.2em !important;min-width:0 !important;border:none !important;position:relative;font-family:inherit !important;line-height:normal !important;transition:font-size .2s ease !important}#app-chat-container #message-input.private-mode{background-color:var(--private-mode-background-color) !important;color:var(--private-mode-color) !important;caret-color:var(--private-mode-color) !important}#app-chat-container #message-input.private-mode::placeholder{color:var(--private-mode-placeholder-color) !important}#app-chat-container .length-field-popup{position:absolute !important;display:flex !important;font-size:12px !important;font-weight:bold !important;font-family:"Montserrat",Iansui,sans-serif !important;bottom:60px;transition:left 100ms ease-out !important;height:20px !important;align-items:center !important;justify-content:center !important;padding:2px 4px;opacity:0;border:none !important;z-index:101 !important}#app-chat-container .user-list-container{margin-top:25px;width:fit-content !important;min-width:180px !important;max-width:fit-content !important;overflow-y:auto !important;overflow-x:hidden !important;padding:1em !important;background-color:var(--main-background-color) !important;color:var(--main-text-color) !important;border-left:1px solid var(--border-color) !important;scrollbar-width:thin !important;scrollbar-color:var(--scrollbar-thumb-color) var(--scrollbar-track-color) !important}#app-chat-container .user-list-container::-webkit-scrollbar-thumb{background-color:var(--scrollbar-thumb-color) !important}#app-chat-container .user-list-container::-webkit-scrollbar-track{background-color:var(--scrollbar-track-color) !important}#app-chat-container .reveal-userlist-btn{position:absolute !important;top:50% !important;right:-1px !important;transform:translateY(-50%) !important;z-index:1000 !important;display:flex;align-items:center !important;justify-content:center !important;padding:.4em !important;background-color:var(--secondary-background-color) !important;font-size:18px !important;font-family:"Noto Color Emoji",sans-serif !important;font-weight:bold !important;border:1px solid var(--border-color) !important;border-radius:.4em 0 0 .4em !important;cursor:pointer !important;transition:background .2s ease,opacity .2s ease !important}#app-chat-container .reveal-userlist-btn:hover{background-color:var(--main-background-color) !important}#app-chat-container .hidden-userlist{display:flex}#app-chat-container .shown-userlist{display:none}#app-chat-container .message{padding:.2em .4em !important;display:flex;flex-direction:row;border-radius:.2em !important;width:100%;max-width:100% !important;word-break:break-word !important;background-color:var(--main-background-color) !important}#app-chat-container .message .pending-emoji{margin-left:.5em !important}#app-chat-container .message .message-text{display:inline-flex !important;flex-wrap:wrap !important}#app-chat-container .message .message-text .emoji-adjuster{font-family:"Noto Color Emoji",sans-serif !important;font-size:1.25em !important;display:inline-flex !important}#app-chat-container .message .message-text .mention{display:inline-flex !important;font-family:Montserrat !important;font-weight:500 !important;letter-spacing:.05em !important}#app-chat-container .message .message-text .md-heading{font-family:"Montserrat",sans-serif !important;margin:0 !important;padding:0 !important;color:#bf9d70 !important}#app-chat-container .message .message-text .md-heading.md-h1{font-size:1.8em !important;font-weight:bold !important}#app-chat-container .message .message-text .md-heading.md-h2{font-size:1.6em !important;font-weight:bold !important}#app-chat-container .message .message-text .md-heading.md-h3{font-size:1.4em !important;font-weight:bold !important}#app-chat-container .message .message-text .md-heading.md-h4{font-size:1.2em !important;font-weight:bold !important}#app-chat-container .message .message-text .md-heading.md-h5{font-size:1.1em !important;font-weight:bold !important}#app-chat-container .message .message-text .md-heading.md-h6{font-size:1em !important;font-weight:bold !important}#app-chat-container .message .message-text code,#app-chat-container .message .message-text .md-code{display:inline-flex !important;font-size:1em !important;font-family:"Consolas",monospace !important;background-color:#2a2a2a !important;border:1px solid #333 !important;border-radius:.2em !important;padding:.1em .2em !important;color:#82b32a !important;filter:none !important;white-space:break-spaces !important}#app-chat-container .message .message-text .md-bold{font-weight:bold !important;color:var(--main-text-color) !important}#app-chat-container .message .message-text .md-italic{font-style:italic !important;color:var(--main-text-color) !important}#app-chat-container .message .message-text .md-strikethrough{text-decoration:line-through !important;color:var(--main-text-color) !important}#app-chat-container .message.banned{background-color:rgba(138,43,226,.1254901961) !important;border:1px solid rgba(138,43,226,.1882352941) !important;border-left:3px solid #8a2be2 !important;width:fit-content !important}#app-chat-container .message.banned .time{color:#8a2be2 !important}#app-chat-container .message.banned .username,#app-chat-container .message.banned .message-text{color:#b875f7 !important}#app-chat-container .message.system{background-color:var(--system-message-background-color) !important;border:1px solid var(--system-message-border-color) !important;border-left:3px solid var(--system-message-color) !important;width:fit-content !important;align-items:center !important}#app-chat-container .message.system .time{margin-right:unset !important;color:var(--system-message-time-color) !important}#app-chat-container .message.system .username{display:none !important}#app-chat-container .message.system .message-text{color:var(--system-message-color) !important}#app-chat-container .message.private-message{width:fit-content !important}#app-chat-container .message.private-message.sent{background-color:var(--private-message-sent-background-color) !important;border:1px solid var(--private-message-sent-border-color) !important;border-left:3px solid var(--private-message-sent-color) !important}#app-chat-container .message.private-message.sent .time{color:var(--private-message-sent-time-color) !important}#app-chat-container .message.private-message.sent .username,#app-chat-container .message.private-message.sent .message-text{color:var(--private-message-sent-color) !important}#app-chat-container .message.private-message.received{background-color:var(--private-message-received-background-color) !important;border:1px solid var(--private-message-received-border-color) !important;border-left:3px solid var(--private-message-received-color) !important}#app-chat-container .message.private-message.received .time{color:var(--private-message-received-time-color) !important}#app-chat-container .message.private-message.received .username,#app-chat-container .message.private-message.received .message-text{color:var(--private-message-received-color) !important}#app-chat-container .message-info{margin-right:1em !important;white-space:nowrap !important;height:fit-content !important}#app-chat-container .message-info .time{font-size:.9em !important;margin-right:1em !important;color:#666 !important}#app-chat-container .message-info .username{font-size:1em !important}#app-chat-container .username,#app-chat-container .time{cursor:pointer !important;transition:opacity .2s ease !important}#app-chat-container .username:hover,#app-chat-container .time:hover{opacity:.7 !important}#app-chat-container .user-item{display:flex !important;align-items:center !important;padding:.2em !important;margin-bottom:.2em !important;border-radius:.2em !important;max-width:100% !important;text-overflow:ellipsis !important}#app-chat-container .user-item .user-avatar{display:flex !important;justify-content:center !important;align-items:center !important;width:24px !important;height:24px !important;font-size:18px !important;border-radius:.1em !important;margin-right:1em !important;text-align:center !important;line-height:24px !important;flex-shrink:0 !important}#app-chat-container .user-item .user-avatar.image-avatar{cursor:pointer !important;transform-origin:left !important;transition:transform .15s ease-out !important}#app-chat-container .user-item .user-avatar.image-avatar:hover{transform:scale(2) !important}#app-chat-container .user-item .user-avatar.svg-avatar{font-family:"Noto Color Emoji",sans-serif !important}#app-chat-container .user-item .user-info{flex:1 !important;min-width:0 !important;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important}#app-chat-container .user-item .game-indicator{cursor:pointer !important}#app-chat-container .user-item .role,#app-chat-container .user-item .traffic-icon{font-family:"Noto Color Emoji",sans-serif !important}#app-chat-container .header-button{position:absolute !important;top:0 !important;width:25px !important;height:25px !important;z-index:5 !important}#app-chat-container .button{display:flex !important;align-items:center !important;justify-content:center !important;cursor:pointer !important;background-color:rgba(0,0,0,0) !important;border:none !important;outline:none !important;margin:0 !important;padding:0 !important;transition:all .15s ease-out}#app-chat-container .button:hover{filter:brightness(1.2) !important}#app-chat-container .emoji-trigger,#app-chat-container .private-mode-exit,#app-chat-container .send-button{font-family:"Noto Color Emoji",sans-serif !important;height:28px !important;width:28px !important;font-size:1.5em !important}#app-chat-container .chat-toggle-button{right:0 !important}#app-chat-container .button .yes{fill:var(--yes-button-color) !important}#app-chat-container .button .no{fill:var(--no-button-color) !important}#app-chat-container .chat-maximize-button{right:25px !important}#app-chat-container .chat-help-button{right:50px !important}#app-chat-container .chat-theme-button{right:75px !important}#app-chat-container .chat-theme-button .theme{fill:var(--theme-button-color) !important}#app-chat-container .chat-drag-area{border-radius:.4em .4em 0 0 !important;position:absolute !important;top:0 !important;left:0 !important;right:0 !important;height:25px !important;cursor:move !important;background-color:var(--drag-area-background-color) !important;border-bottom:1px solid var(--border-color) !important}#app-chat-container .image-container .processed-image{margin-right:.5em !important}#app-chat-container .image-container .clickable-thumbnail{display:flex !important;align-items:center;opacity:1;transition:opacity .15s ease-in-out;border:none !important;max-width:150px !important;max-height:150px !important;cursor:pointer;background-color:rgba(0,0,0,0);margin:.5em .5em 0 0 !important;overflow:hidden !important;border-radius:.2em !important;box-shadow:0 0 2px rgba(0,0,0,.5) !important}#app-chat-container .image-container .clickable-thumbnail:hover{opacity:.8}#app-chat-container .image-container .clickable-thumbnail img{max-height:100% !important;max-width:100% !important;background-color:rgba(0,0,0,0);object-fit:contain}#app-chat-container .video-wrapper{display:flex;flex-direction:column}#app-chat-container .video-wrapper .processed-video{margin-bottom:.2em !important}#app-chat-container .video-wrapper .youtube-info{display:flex !important;flex-direction:column !important;margin-bottom:.2em !important;font-family:"Montserrat",sans-serif !important;font-size:.9em !important;color:#8ede87 !important;font-weight:500 !important;white-space:break-spaces !important}#app-chat-container .video-container,#app-chat-container .youtube-thumb{border-radius:.4em !important;display:flex;border:none;height:200px !important;width:356px !important;background-color:var(--main-background-color) !important}#app-chat-container .youtube-thumb{cursor:pointer !important;object-fit:cover !important}#app-chat-container .youtube-thumb:hover{filter:brightness(0.8);transition:filter .3s ease}.dimming-element{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.5019607843);z-index:1010 !important;opacity:0;transition:opacity .3s ease}.scaled-thumbnail{top:50%;left:50%;transform-origin:center center;transform:translate(-50%, -50%) scale(1);position:fixed;opacity:0;z-index:1015 !important;max-height:90vh;max-width:90vw;cursor:pointer;border-radius:.6em !important;box-shadow:0 0 2px rgba(0,0,0,.5) !important}.delete-btn{z-index:1020 !important;padding:8px 16px;background-color:hsl(0,50%,20%);color:hsl(0,60%,70%);border:1px solid hsl(0,50%,35%);transition:all .3s;cursor:pointer;filter:brightness(1);border-radius:.2em !important}.delete-btn:hover{filter:brightness(1.5)}.toggle-button{font:bold .9em "Montserrat",sans-serif;position:absolute;top:0;right:2em;padding:8px 16px;transition:filter .3s;border-radius:0 0 .2em .2em !important;border-top:none;min-width:4em}.toggle-button.toggle-hidden{background:linear-gradient(to top, hsl(0, 50%, 20%), hsl(0, 50%, 25%));color:hsl(0,60%,70%);border-left:1px solid hsl(0,50%,35%);border-right:1px solid hsl(0,50%,35%);border-bottom:1px solid hsl(0,50%,35%)}.toggle-button.toggle-shown{background:linear-gradient(to top, hsl(30, 50%, 20%), hsl(30, 50%, 25%));color:hsl(30,60%,70%);border-left:1px solid hsl(30,50%,35%);border-right:1px solid hsl(30,50%,35%);border-bottom:1px solid hsl(30,50%,35%)}.toggle-button:hover{filter:brightness(1.5)}.toggle-button-hidden{background-color:hsl(0,20%,10%);color:hsl(0,50%,50%);border:1px solid hsl(0,50%,50%)}.toggle-button-show{background-color:hsl(90,20%,10%);color:hsl(90,50%,50%);border:1px solid hsl(90,50%,50%)}.toggle-button-hide{background-color:hsl(50,20%,10%);color:hsl(50,50%,50%);border:1px solid hsl(50,50%,50%)}.selected-message{background-clip:padding-box !important}.selected-message.message-mode{background-color:hsla(0,50%,50%,.2) !important;box-shadow:inset 0px 0px 0px 1px hsla(0,50%,50%,.4) !important}.selected-message.username-mode{background-color:hsla(145,50%,30%,.2) !important;box-shadow:inset 0px 0px 0px 1px hsla(145,50%,50%,.4) !important}.selected-message.time-mode{background-color:hsla(200,50%,30%,.2) !important;box-shadow:inset 0px 0px 0px 1px hsla(200,50%,50%,.4) !important}.shown-message{background-color:hsla(30,60%,30%,.2) !important;box-shadow:inset 0px 0px 0px 1px hsla(30,60%,50%,.4) !important;background-clip:padding-box !important}.hidden-message{display:none !important}.new-messages-separator{display:flex;align-items:center;height:1em !important}.new-messages-separator .separator-line{flex-grow:1 !important;border:none !important;border-top:1px solid rgba(255,132,0,.568627451) !important;margin:0 !important}.new-messages-separator .separator-icon{background-color:rgba(255,132,0,.2509803922) !important;border-radius:.2em !important;padding:.2em .4em !important;font-family:"Noto Color Emoji" !important}.bounce-in{animation:bounceIn 500ms forwards}.bounce-out{animation:bounceOut 500ms forwards}@keyframes bounceIn{0%{transform:translateY(0);opacity:0}50%{transform:translateY(-10px);opacity:1}100%{transform:translateY(0);opacity:1}}@keyframes bounceOut{0%{transform:translateY(0);opacity:1}50%{transform:translateY(-10px);opacity:1}100%{transform:translateY(0);opacity:0}}@media(max-width: 780px){#app-chat-container .chat-wrapper{width:100% !important;border-right:none !important}}@media screen and (max-width: 768px),(hover: none),(pointer: coarse){body{background-color:#1e1e1e !important}#app-chat-container{height:100% !important;width:100vw !important;position:fixed !important;top:0 !important;bottom:0 !important;left:0 !important;right:0 !important;min-width:100vw !important;border:none !important;border-radius:0 !important;overflow:hidden !important}#app-chat-container .resize-handle,#app-chat-container .chat-toggle-button,#app-chat-container .chat-maximize-button,#app-chat-container .chat-help-button,#app-chat-container #send-button{display:none !important}#app-chat-container .chat-theme-button{right:0 !important}.ownbanner-back,.feedback,#reformal_tab,#footer,.threecol233 .col1{display:none !important}.profile-iframe-container{width:calc(100vw - 1em) !important;min-width:360px !important;top:0 !important;transform:translate(-50%, 1em) !important}}.profile-iframe-container{opacity:0;border:none;display:flex;position:fixed;z-index:1010 !important;width:75vw;min-width:1000px;height:80vh;top:48.5vh;left:50vw;transform:translate(-50%, -50%);box-shadow:0 4px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.08) !important;border-radius:.6em !important}',""]);const s=i},601:e=>{e.exports=function(e){return e[1]}},631:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.ignored-users-panel{opacity:0;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);height:fit-content;max-height:70vh;max-width:360px;min-height:50px;min-width:220px;width:fit-content;background-color:var(--main-background-color);border:1px solid var(--border-color) !important;padding:1em;border-radius:.4em !important;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;font-family:"Gill Sans","Gill Sans MT",Calibri,"Trebuchet MS",sans-serif;overflow-y:auto;overflow-x:hidden;z-index:1100}.ignored-users-panel .ignored-users-input-container{display:flex;position:absolute;top:0;left:0;right:0}.ignored-users-panel .ignored-users-input-container .ignored-users-input{flex:1;padding:.6em;border:none !important;border-radius:.4em 0 0 0 !important;background-color:var(--secondary-background-color);color:var(--main-text-color);caret-color:var(--main-text-color);outline:none !important}.ignored-users-panel .ignored-users-input-container .ignored-users-add-btn{padding:.6em;background-color:var(--confirm-button-color) !important;color:var(--confirm-button-text-color) !important;border:none !important;outline:none !important;border-radius:0 .4em 0 0 !important;cursor:pointer;transition:background-color .3s ease}.ignored-users-panel .ignored-users-input-container .ignored-users-add-btn:hover{background-color:var(--confirm-button-hover-color) !important}.ignored-users-panel .ignored-users-list{margin-top:2em}.ignored-users-panel .ignored-user-entry{display:flex;align-items:center;justify-content:space-between;padding:.3em;border-bottom:1px dashed var(--border-color) !important}.ignored-users-panel .ignored-user-entry:last-child{border-bottom:none}.ignored-users-panel .ignored-user-entry .user-label{flex:1;color:var(--main-text-color) !important}.ignored-users-panel .ignored-user-entry .remove-btn{cursor:pointer;padding:.6em;background-color:#b34a2a !important;border:none;border-radius:.2em !important;filter:brightness(1);transition:filter .3s ease,background-color .3s ease}.ignored-users-panel .ignored-user-entry .remove-btn svg{stroke:#eebc90 !important}.ignored-users-panel .ignored-user-entry .remove-btn:hover{filter:brightness(1.2)}.input-error{background-color:#b34a2a !important;color:#eebc90 !important;caret-color:#eebc90 !important;transition:background-color .5s ease}',""]);const s=i},659:e=>{var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},802:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,".shake-effect{animation:shake 500ms cubic-bezier(0.36, 0.07, 0.19, 0.97) both}@keyframes shake{0%{transform:translateX(0)}10%{transform:translateX(-4px)}20%{transform:translateX(6px)}30%{transform:translateX(-8px)}40%{transform:translateX(8px)}50%{transform:translateX(-6px)}60%{transform:translateX(5px)}70%{transform:translateX(-3px)}80%{transform:translateX(2px)}90%{transform:translateX(-1px)}100%{transform:translateX(0)}}",""]);const s=i},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,r&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},860:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.help-panel{opacity:0;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);height:fit-content;max-height:70vh !important;min-width:350px !important;width:fit-content;overflow-y:auto;scrollbar-width:none;background-color:var(--main-background-color) !important;border:1px solid var(--border-color) !important;padding:1em;border-radius:.4em !important;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;color:var(--main-text-color) !important;font-family:"Gill Sans","Gill Sans MT",Calibri,"Trebuchet MS",sans-serif;z-index:1100}.help-panel .help-header{margin-top:0;font-size:1.5em;text-align:center;color:var(--secondary-accent-color) !important}.help-panel .help-section-header{margin-top:0 !important;margin-bottom:1.5em !important;font-size:1.5em !important;text-align:center;color:var(--secondary-accent-color) !important}.help-panel .help-section-subheader{margin:.8em 0 1.2em 1em;font-size:.9em;color:var(--third-accent-color) !important;font-weight:normal;text-align:left}.help-panel .help-list{list-style-type:none;padding-left:0}.help-panel .help-list .help-list-item{display:flex;align-items:center;flex-direction:row;padding:.3em;border-bottom:1px dashed var(--border-color) !important}.help-panel .help-list .help-list-item:last-child{border-bottom:none}.help-panel .help-list .help-list-item .help-hotkey{white-space:nowrap !important;width:fit-content;display:flex;color:var(--hotkey-label-text-color) !important;font-family:monospace;background-color:var(--hotkey-label-background-color) !important;border:1px solid var(--hotkey-label-border-color) !important;border-left:3px solid var(--hotkey-label-border-color) !important;border-radius:0 .2em .2em 0 !important;padding:2px 4px;margin-right:1em}@media(max-width: 768px){.help-panel{top:2em !important;transform:translate(-50%, 0) !important;max-height:80vh !important}.help-panel .help-section-header{margin-bottom:1em !important;font-size:1em !important}.help-panel .help-section-subheader{margin:.5em 0 1em 1em !important;font-size:.8em !important}.help-panel .help-hotkey{margin-right:0 !important;margin-bottom:.5em !important}.help-panel .help-list-item{font-size:.9em !important;flex-direction:column !important;align-items:flex-start !important}}',""]);const s=i},879:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.themes-panel{opacity:0;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);height:fit-content;max-height:70vh !important;max-width:360px !important;width:fit-content;scrollbar-width:none;background:var(--main-background-color);border:1px solid var(--border-color) !important;padding:1em;border-radius:.4em !important;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;font-family:"Gill Sans","Gill Sans MT",Calibri,"Trebuchet MS",sans-serif;overflow-y:auto;overflow-x:hidden;z-index:1100}.themes-panel h2{font-size:1.2em !important;margin:0 !important;text-align:center !important;color:var(--main-accent-color) !important;border-bottom:1px dashed var(--border-color) !important;padding-bottom:.6em !important}.themes-panel .themes-list{display:flex;flex-direction:column;gap:10px}.themes-panel .themes-list .theme-button{border:none !important;padding:.6em;border-radius:.4em !important;background-color:var(--secondary-background-color) !important;color:var(--main-text-color) !important;cursor:pointer;transition:background-color .3s ease,color .3s ease}.themes-panel .themes-list .theme-button:hover{background-color:var(--main-accent-color) !important;color:var(--secondary-background-color) !important}.themes-panel .themes-list .theme-button.active-theme{background-color:var(--main-accent-color) !important;color:var(--secondary-background-color) !important}',""]);const s=i},957:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.emoji-panel{opacity:0;transition:opacity .3s ease;position:absolute !important;top:50%;left:50%;transform:translate(-50%, -50%);background:var(--main-background-color) !important;border:1px solid var(--border-color) !important;border-radius:.4em !important;width:380px;height:580px;display:flex;flex-direction:column;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;z-index:1010}.emoji-panel .emoji-search-container{padding:1em !important;border:none !important}.emoji-panel .emoji-search-container .emoji-search{width:100%;padding:8px;border-radius:4px;background:var(--secondary-background-color) !important;border:none !important;border-radius:.2em !important;color:var(--main-text-color) !important;caret-color:var(--main-text-color) !important;font-size:.9em !important}.emoji-panel .emoji-search-container .emoji-search:focus{outline:none}.emoji-panel .emoji-categories{position:sticky !important;top:0 !important;display:grid !important;grid-template-columns:repeat(auto-fill, minmax(32px, 1fr)) !important;padding:8px !important;border-bottom:1px solid var(--border-color) !important;gap:8px !important;justify-content:center !important;align-items:center !important;overflow-x:auto !important;scrollbar-width:thin !important}.emoji-panel .emoji-categories .emoji-category-btn{font-family:"Noto Color Emoji" !important;position:relative !important;background:none !important;border:none !important;padding:4px !important;cursor:pointer !important;font-size:1.5em !important;transition:background-color .2s;width:100% !important;height:100% !important;display:flex !important;align-items:center !important;justify-content:center !important;aspect-ratio:1 !important;border-bottom:3px solid rgba(0,0,0,0) !important}.emoji-panel .emoji-categories .emoji-category-btn.active{opacity:1;border-bottom:3px solid var(--secondary-accent-color) !important}.emoji-panel .emoji-categories .emoji-category-btn:hover{background-color:#333}.emoji-panel .emoji-categories::-webkit-scrollbar{width:6px;height:6px}.emoji-panel .emoji-categories::-webkit-scrollbar-track{background:#1e1e1e}.emoji-panel .emoji-categories::-webkit-scrollbar-thumb{background:#444;border-radius:3px}.emoji-panel .emoji-categories::-webkit-scrollbar-thumb:hover{background:#555}.emoji-panel .emoji-container{flex:1;overflow-y:auto;overflow-x:hidden !important;display:grid !important;gap:8px !important;width:100% !important;max-width:100% !important;scrollbar-width:none !important}.emoji-panel .emoji-container .emoji-category-section{margin-bottom:10px}.emoji-panel .emoji-container .emoji-category-section .emoji-category-header{padding:8px !important;color:var(--main-text-color) !important;font-size:.9em !important;position:sticky !important;top:0px !important;background-color:var(--main-background-color) !important;z-index:1 !important;border-bottom:1px solid var(--border-color) !important;width:100% !important;box-sizing:border-box !important;margin:0 !important}.emoji-panel .emoji-container .emoji-category-section .emoji-list{display:grid;grid-template-columns:repeat(auto-fill, minmax(32px, 1fr)) !important;padding:8px !important;gap:8px;align-content:start}.emoji-panel .emoji-container .emoji-category-section .emoji-list .emoji-btn{font-family:"Noto Color Emoji" !important;background:none;border:none;border-radius:.2em !important;padding:4px !important;cursor:pointer;font-size:1.5em !important;transition:background-color .2s;width:100% !important;height:100% !important;display:flex !important;align-items:center !important;justify-content:center !important;aspect-ratio:1 !important}.emoji-panel .emoji-container .emoji-category-section .emoji-list .emoji-btn:hover{background-color:var(--secondary-background-color) !important}.emoji-panel .emoji-container::-webkit-scrollbar{width:6px;height:6px}.emoji-panel .emoji-container::-webkit-scrollbar-track{background:#1e1e1e}.emoji-panel .emoji-container::-webkit-scrollbar-thumb{background:#444;border-radius:3px}.emoji-panel .emoji-container::-webkit-scrollbar-thumb:hover{background:#555}.emoji-panel .emoji-footer{border-top:1px solid var(--border-color) !important;display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:5px}.emoji-panel .emoji-footer .emoji-info-panel{height:40px !important;padding:8px !important;display:flex !important;align-items:center !important;gap:8px !important;color:var(--main-text-color) !important;font-size:.9em !important;background-color:var(--main-background-color) !important}.emoji-panel .emoji-footer .emoji-info-panel .emoji-info-icon{font-family:"Noto Color Emoji" !important;font-size:1.5em !important}.emoji-panel .emoji-footer .emoji-info-panel .emoji-info-keywords{color:#888 !important;font-style:italic !important}.emoji-panel .emoji-footer .emoji-language-select{border-radius:.4em !important;padding:5px 10px;font-size:14px;background-color:var(--secondary-background-color) !important;color:var(--main-text-color) !important;cursor:pointer;transition:border-color .3s ease}.emoji-panel .emoji-footer .emoji-language-select:hover{border-color:var(--border-color) !important}.emoji-panel .emoji-footer .emoji-language-select option{font-size:14px;background-color:var(--secondary-background-color) !important;color:var(--main-text-color) !important}',""]);const s=i},999:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(601),r=n.n(o),a=n(314),i=n.n(a)()(r());i.push([e.id,'.chat-username-color-picker{opacity:0;position:fixed;left:50%;top:50%;transform:translate(-50%, -50%);height:fit-content;max-height:70vh !important;max-width:360px !important;width:fit-content;scrollbar-width:none;background-color:var(--main-background-color);border:1px solid var(--border-color);padding:1em;border-radius:.4em !important;box-shadow:0 2px 8px rgba(0,0,0,.15) !important;font-family:"Gill Sans","Gill Sans MT",Calibri,"Trebuchet MS",sans-serif;overflow-y:auto;overflow-x:hidden;z-index:1100}.chat-username-color-picker h2{font-size:1.2em !important;margin:0 !important;text-align:center !important;color:var(--secondary-accent-color) !important;border-bottom:1px dashed var(--border-color) !important;padding-bottom:.6em !important}.chat-username-color-picker .saved-username-colors,.chat-username-color-picker .generated-username-colors{margin-top:1em}.chat-username-color-picker .saved-username-colors h3,.chat-username-color-picker .generated-username-colors h3{font-size:1em !important;margin:.5em 0 !important;text-align:center !important;color:var(--third-accent-color) !important;border-bottom:1px dashed var(--border-color) !important;padding-bottom:.3em !important}.chat-username-color-picker .saved-username-colors h3 .counter,.chat-username-color-picker .generated-username-colors h3 .counter{font-size:.8em !important;color:var(--secondary-accent-color) !important;margin-left:.5em !important}.chat-username-color-picker .generated-username-colors .username-entry.disabled-entry{pointer-events:none;opacity:.2}.chat-username-color-picker .username-entry{display:flex;align-items:center;justify-content:space-between;padding:.3em;background-color:var(--input-background-color);border-bottom:1px dashed var(--border-color)}.chat-username-color-picker .username-entry:last-child{border-bottom:none}.chat-username-color-picker .username-entry .user-label{flex:1}.chat-username-color-picker .username-entry .color-box{cursor:pointer !important;border-radius:.2em !important;margin-left:1em;padding:.6em;font-size:.8em;font-family:monospace}.chat-username-color-picker .username-entry input[type=color]{display:none !important}.chat-username-color-picker .remove-btn{cursor:pointer;display:flex;align-items:center;justify-content:center;width:25px;height:25px;border-radius:.2em !important;margin-left:8px}.chat-username-color-picker .custom-color-input{display:flex;align-items:center;background-color:var(--main-background-color) !important;position:absolute;left:0 !important;top:0 !important;right:0 !important}.chat-username-color-picker .custom-color-input .hex-input{padding:.6em !important;border-radius:.4em 0 0 0 !important;background-color:var(--secondary-background-color) !important;color:var(--main-text-color) !important;caret-color:var(--main-text-color) !important;width:100% !important;border:none !important;outline:none !important}.chat-username-color-picker .custom-color-input .confirm-btn{transition:background-color .3s ease !important;padding:.6em !important;background-color:var(--confirm-button-color) !important;color:var(--confirm-button-text-color) !important;border:1px solid var(--border-color);outline:none !important;border-radius:0 .4em 0 0 !important;cursor:pointer}.chat-username-color-picker .custom-color-input .confirm-btn:hover{background-color:var(--confirm-button-hover-color) !important}',""]);const s=i}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,exports:{}};return e[o](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var o=n(72),r=n.n(o),a=n(825),i=n.n(a),s=n(659),c=n.n(s),l=n(56),d=n.n(l),m=n(540),u=n.n(m),p=n(113),h=n.n(p),g=n(550),f={};f.styleTagTransform=h(),f.setAttributes=d(),f.insert=c().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=u();r()(g.A,f);g.A&&g.A.locals&&g.A.locals;var b=n(957),y={};y.styleTagTransform=h(),y.setAttributes=d(),y.insert=c().bind(null,"head"),y.domAPI=i(),y.insertStyleElement=u();r()(b.A,y);b.A&&b.A.locals&&b.A.locals;var v=n(860),w={};w.styleTagTransform=h(),w.setAttributes=d(),w.insert=c().bind(null,"head"),w.domAPI=i(),w.insertStyleElement=u();r()(v.A,w);v.A&&v.A.locals&&v.A.locals;var k=n(416),x={};x.styleTagTransform=h(),x.setAttributes=d(),x.insert=c().bind(null,"head"),x.domAPI=i(),x.insertStyleElement=u();r()(k.A,x);k.A&&k.A.locals&&k.A.locals;var E=n(999),S={};S.styleTagTransform=h(),S.setAttributes=d(),S.insert=c().bind(null,"head"),S.domAPI=i(),S.insertStyleElement=u();r()(E.A,S);E.A&&E.A.locals&&E.A.locals;var C=n(631),L={};L.styleTagTransform=h(),L.setAttributes=d(),L.insert=c().bind(null,"head"),L.domAPI=i(),L.insertStyleElement=u();r()(C.A,L);C.A&&C.A.locals&&C.A.locals;var j=n(802),I={};I.styleTagTransform=h(),I.setAttributes=d(),I.insert=c().bind(null,"head"),I.domAPI=i(),I.insertStyleElement=u();r()(j.A,I);j.A&&j.A.locals&&j.A.locals;var M=n(879),A={};A.styleTagTransform=h(),A.setAttributes=d(),A.insert=c().bind(null,"head"),A.domAPI=i(),A.insertStyleElement=u();r()(M.A,A);M.A&&M.A.locals&&M.A.locals;const T="https://klavogonki.ru",$=`${T}/xmpp-httpbind/`,N=3e3,P={chat:{online:"Chat connection established. ✓",offline:"Chat connection lost. Reconnecting..."},network:{online:"Network connection restored. ✓",offline:"Network connection lost."}},z=["😀","😁","😂","🤣","😃","😄","😅","😆","😉","😊","😋","😎","😏","😐","😑","😒","😓","😔","😕","😖","😗","😘","😙","😚","😜","😝","😛","🤑","🤗","🤔","🤐","🤨","😣","😥","😮","🤯","😳","😱","😨","😰","😢","🤪","😵","😲","🤤","😷","🤒","🤕","🤢","🤧","😇","🥳","🥺","😬","😴","😌","🤥","🥴","🥵","🥶","🤧","🤭","🤫","😠","😡","😳","😞","😟","😕","🐱","😺","😸","😹","😻","😼","😽","🙀","😿","😾","🐶","🐭","🐹","🐰","🦊","🐻","🐼","🐨","🐯","🦁","🐮","🐷","🐸","🐵","🙈","🙉","🙊","🐔","🦄"],B=["klavogonki.ru","youtube.com","youtu.be","imgur.com","pikabu.ru","userapi.com","ibb.co","yaplakal.com","freepik.com"],q="#1e1e1e";let H={};function D(){Object.entries(H).forEach((([e,t])=>{document.removeEventListener(e,t)}))}const R=["jpg","jpeg","png","gif","webp"],_="📷",U="🖥️",O="💀️️",J=.2,F=10,K=.1;let X=0,Y=!1,W=[],V=null;const G=e=>{const t=(e=>{try{return e.match(/\.([^?#.]+)(?:[?#]|$)/i)?.[1]?.toLowerCase()||""}catch(e){return console.error("Error extracting extension:",e.message),""}})(e);return{allowed:R.includes(t),extension:t}},Q=(e,t)=>{const n=document.createElement("img");n.src=e,n.classList.add("scaled-thumbnail"),document.body.appendChild(n),X=t;let o=1,r=!1,a=0,i=0,s=0,c=0;let l=document.querySelector(".dimming-element");if(l||(l=document.createElement("div"),l.classList.add("dimming-element"),document.body.appendChild(l)),et()){let e=0,t=0,r=0,a=0;const i=e=>{e.preventDefault()},l=i=>{i.preventDefault();const l=i.touches.length;if(2===l){const r=i.touches[0],a=i.touches[1],l=Math.hypot(r.clientX-a.clientX,r.clientY-a.clientY);if(2===e){o*=l/t,o=Math.max(J,Math.min(o,F)),n.style.transform=`translate(-50%, -50%) translate(${s}px, ${c}px) scale(${o})`}t=l}else if(1===l){const t=i.touches[0],l=t.clientX,d=t.clientY;if(1===e){s+=l-r,c+=d-a,n.style.transform=`translate(-50%, -50%) translate(${s}px, ${c}px) scale(${o})`}r=l,a=d}e=l},d=t=>{0===t.touches.length&&(e=0)};n.addEventListener("touchstart",i,{passive:!1}),n.addEventListener("touchmove",l,{passive:!1}),n.addEventListener("touchend",d)}const d=e=>{Ce(e,"hide","0"),!document.querySelector(".popup-panel")&&l&&Ce(l,"hide","0"),D()};return H.click=e=>{n.contains(e.target)||(n.remove(),D())},H.keydown=e=>{"Escape"===e.code||"Space"===e.code?(e.preventDefault(),d(n)):"ArrowLeft"===e.code?Z(-1):"ArrowRight"===e.code&&Z(1)},H.wheel=e=>{const t=e.deltaY<0?1:-1;o+=t*K*o,o=Math.max(J,Math.min(o,F)),n.style.transform=`translate(-50%, -50%) translate(${s}px, ${c}px) scale(${o})`},H.mousemove=e=>{if(r){if(e.ctrlKey){const t=e.clientY-i,n=t<0?1:-1,r=Math.abs(t)*K*.05;o+=n*r*o,o=Math.max(J,Math.min(o,F))}else{const t=(e.clientX-a)/o*5,n=(e.clientY-i)/o*5;s+=t,c+=n}n.style.transform=`translate(-50%, -50%) translate(${s}px, ${c}px) scale(${o})`,a=e.clientX,i=e.clientY}},H.mousedown=e=>{const{button:t,clientX:o,clientY:s,target:c,ctrlKey:l}=e;(0!==t&&2!==t||c===n)&&(0===t?Z(-1):2===t?(e.preventDefault(),l?(navigator.clipboard.writeText(c.src).catch(console.error),d(n)):Z(1)):1===t&&(r=!0,a=o,i=s,e.preventDefault()))},H.mouseup=e=>{1===e.button&&(r=!1)},H.contextmenu=e=>e.preventDefault(),Object.entries(H).forEach((([e,t])=>{document.addEventListener(e,t)})),Ce(l,"show","1"),l.addEventListener("click",(()=>{d(n)})),n},Z=e=>{const t=X+e;t>=0&&t<W.length&&!Y&&(Y=!0,V&&(V.src=W[t].imgSrc),setTimeout((()=>Y=!1),50),X=t)};function ee(){const e=document.getElementById("messages-panel");if(!e)return;const t=()=>{W=[],e.querySelectorAll(".clickable-thumbnail").forEach(((e,t)=>{const n=e.querySelector("img");n&&e.dataset.sourceLink&&W.push({link:e.dataset.sourceLink,imgSrc:n.src,index:t})}))},n=e.querySelectorAll("a:not(.skipped):not(.processed-image)");function o(e,n){let o=e.parentElement;o.classList.contains("image-container")||(o=document.createElement("div"),o.classList.add("image-container"),e.parentNode.insertBefore(o,e),o.appendChild(e));const r=document.createElement("div");r.classList.add("clickable-thumbnail"),r.dataset.sourceLink=e.href;const a=document.createElement("img");a.src=e.href,a.onload=()=>{r.appendChild(a),o.appendChild(r),$e(600)},a.onerror=()=>{console.error("Failed to load image:",e.href),e.classList.add("skipped")},n?e.querySelector(".clickable-thumbnail")||e.addEventListener("click",(()=>{e.querySelector(".clickable-thumbnail")||(r.appendChild(a),o.appendChild(r))})):(r.appendChild(a),o.appendChild(r)),r.addEventListener("click",(n=>{n.stopPropagation(),t();const o=W.findIndex((t=>t.link===e.href||t.imgSrc===a.src));V=Q(a.src,o>=0?o:0),Ce(V,"show","1");const r=document.querySelector(".dimming-element");r&&Ce(r,"show","1")}))}n.length&&n.forEach((e=>{if(!e.href||!e.href.startsWith("http"))return;const{allowed:t,extension:n}=G(e.href);if(!t)return;e.classList.add("media");const{isTrusted:r,domain:a}=Le(e.href);e.title=je(e.href)?Ie(e.href):e.href,r?function(e,t,n){e.textContent=`${_} ${t.toUpperCase()} ${U} ${n}`,e.classList.add("processed-image"),o(e,!1)}(e,n,a):function(e,t,n){e.classList.add("skipped"),e.textContent=`${_} ${t.toUpperCase()} ${U} ${n} ${O} Untrusted`,e.addEventListener("click",(t=>{e.classList.contains("processed-image")||(t.preventDefault(),e.classList.remove("skipped"),e.classList.add("processed-image"),o(e,!0))}))}(e,n,a)}))}const te="📺",ne="📹",oe="🎬️",re="🖥️",ae="💀️️",ie=["mp4","webm","ogg","mov","avi"];let se=null,ce=null;async function le(e,t,n,o){e.hidden=!0,t.hidden=!0;const r=await async function(e){const t=`https://www.youtube.com/oembed?url=https://www.youtube.com/watch?v=${e}&format=json`;try{const e=await fetch(t),n=await e.json();return{title:n.title||"Title not found",channel:n.author_name||"Channel not found"}}catch(e){return console.error("Error fetching YouTube metadata:",e),{title:"Error",channel:"Error"}}}(n),a=document.createElement("span");a.classList.add("channel-name"),a.textContent=`${te} ${r.channel}`;const i=document.createElement("span");i.classList.add("video-title"),i.textContent=`${ne} ${r.title}`;const s=new Image;s.src=`https://img.youtube.com/vi/${n}/hqdefault.jpg`,s.alt=o,s.classList.add("youtube-thumb"),s.addEventListener("load",(()=>{e.replaceChildren(a,i),t.replaceChildren(s),e.hidden=!1,t.hidden=!1,$e(600)})),s.addEventListener("error",(()=>{console.error("Error loading YouTube thumbnail for videoId:",n)}))}function de(){const e=document.getElementById("messages-panel");if(!e)return;const t=e.querySelectorAll("a:not(.skipped):not(.processed-video)");async function n(e,t,n,o){const{youtubeMatch:r,videoType:a,videoId:i}=o,s=(e=>{const t=e.match(/\.([^?#.]+)(?:[?#]|$)/i)?.[1]?.toLowerCase()||"";return{allowed:ie.includes(t),extension:t}})(t);if(!r&&!s.allowed)return;e.classList.add("processed-video");const c=document.createElement("div");if(c.classList.add("video-wrapper"),e.textContent=`${oe} ${a} ${re} ${n}`,e.title=je(t)?Ie(t):t,e.style.display="inline-flex",r){const t=document.createElement("div");t.classList.add("youtube-info");const n=document.createElement("div");n.classList.add("youtube-placeholder"),n.dataset.videoId=i,n.dataset.videoType=a,e.parentNode.insertBefore(c,e),c.append(e,t,n),await le(t,n,i,a),n.addEventListener("click",(()=>{if(ce&&ce!==n){const e=ce.dataset.videoId,t=ce.dataset.videoType;le(ce.previousElementSibling,ce,e,t)}ce=n;const e=(se||(se=document.createElement("iframe"),se.classList.add("video-container"),se.allowFullscreen=!0),se);e.hidden=!0,e.src=`https://www.youtube.com/embed/${i}?autoplay=1`,n.replaceChildren(e),e.addEventListener("load",(()=>{e.hidden=!1}))}))}else{const n=document.createElement("video");n.classList.add("video-container"),n.src=t,n.controls=!0,n.hidden=!0,n.addEventListener("loadeddata",(()=>{n.hidden=!1,$e(600)})),n.addEventListener("error",(()=>{console.error("Error loading video source:",t),c.replaceChildren(e)})),e.parentNode.insertBefore(c,e),c.append(e,n)}}t.length&&t.forEach((e=>{const t=e.href;if(!t)return;const o=function(e){const t=e.match(/(?:shorts\/|live\/|watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/i);if(t)return{youtubeMatch:!0,videoId:t[1],videoType:e.includes("shorts/")?"Shorts":e.includes("live/")?"Live":e.includes("watch?v=")?"Watch":e.includes("youtu.be/")?"Share":"YouTube"};const n=e.split(".").pop().toLowerCase();return!!ie.includes(n)&&{youtubeMatch:!1,videoType:`Video (${n.toUpperCase()})`}}(t);if(!o)return;e.classList.add("media");const{isTrusted:r,domain:a}=Le(t);if(!r)return e.classList.add("skipped"),e.textContent=`${oe} ${o.videoType} ${re} ${a} ${ae} Untrusted`,void e.addEventListener("click",(r=>{e.classList.contains("processed-video")||(r.preventDefault(),e.classList.remove("skipped"),n(e,t,a,o))}));n(e,t,a,o)}))}function me(e){e.classList.add("shake-effect"),setTimeout((()=>{e.classList.remove("shake-effect")}),500)}const ue={smileys:["😀","😃","😄","😆","😁","😅","😂","🤣","🥲","☺️","😊","😇","🙂","🙃","😉","😌","😍","🥰","😙","😚","😗","😘","😋","🥸","😵‍💫","😛","😝","😜","🤪","😎","🤓","🧐","🤨","🤩","🥳","😏","😒","😞","😔","😟","😕","🙁","☹️","😣","😖","😫","😩","🥺","😢","😭","😤","😠","😡","🤬","🤯","😳","🥵","🥶","😱","😨","😰","😥","😓","🤗","🤔","🤭","🤫","🤥","😶","😐","😑","😬","🙄","😯","😦","😧","😮","😲","🥱","😴","🤤","😪","😵","🤐","🥴","🤢","🤮","🤧","😷","🤒","🤕","🤑","🤠","😈","👿","👹","👺","🤡","💩","👻","💀","☠️","👽","👾","🤖","🎃","😺","😸","😹","😻","😼","😽","🙀","😿","😾","👋","🤚","🖐️","✋","🖖","👌","🤌","🤏","✌️","🤞","🤟","🤘","🤙","👈","👉","👆","🖕","👇","☝️","👍","👎","✊","👊","🤛","🤜","👏","🙌","👐","🤲","🤝","🙏","✍️","💅","🤳","💪","🦾","🦿","🦵","🦶","👂","🦻","👃","🧠","🫀","🫁","🦷","🦴","👀","👁️","👅","👄","👶","🧒","👦","👧","🧑","👱","👨","🧔","👩","🧓","👴","👵","🙍","🙎","🙅","🙆","💁","🙋","🧏","🙇","🤦","🤷","👮","🕵️","💂","🥷","👷","🤴","👸","👳","👲","🧕","🤵","👰","🤰","🤱","👼","🎅","🤶","🦸","🦹","🧙","🧚","🧛","🧜"],nature:["🐵","🐒","🦍","🦧","🐶","🐕","🦮","🐕‍🦺","🐩","🐺","🦊","🦝","🐱","🐈","🐈‍⬛","🦁","🐯","🐅","🐆","🐴","🐎","🦄","🦓","🦌","🦬","🐮","🐂","🐃","🐄","🐷","🐖","🐗","🐽","🐏","🐑","🐐","🐪","🐫","🦙","🦒","🐘","🦏","🦛","🐭","🐁","🐀","🐹","🐰","🐇","🦫","🦘","🦡","🐿️","🦔","🦦","🦥","🐼","🦨","🦘","🦡","🦃","🐔","🐓","🐣","🐤","🐥","🐦","🐧","🕊️","🦅","🦆","🦢","🦉","🦤","🪶","🦩","🦚","🦜","🐸","🐊","🐢","🦎","🐍","🐲","🐉","🦕","🦖","🐳","🐋","🐬","🦭","🐟","🐠","🐡","🦈","🐙","🐚","🪸","🐌","🦋","🐛","🐜","🐝","🪲","🐞","🦗","🪳","🕷️","🕸️","🦂","🦟","🪰","🪱","🌸","💮","🏵️","🌹","🥀","🌺","🌻","🌼","🌷","🌱","🪴","🌲","🌳","🌴","🌵","🌾","🌿","☘️","🍀","🍁","🍂","🍃"],food:["🍎","🍐","🍊","🍋","🍌","🍉","🍇","🍓","🫐","🍈","🍒","🍑","🥭","🍍","🥥","🥝","🍅","🍆","🥑","🥦","🥬","🥒","🌶️","🫑","🥕","🧄","🧅","🥔","🍠","🥐","🥯","🍞","🥖","🥨","🧀","🥚","🍳","🥓","🥩","🍗","🍖","🦴","🌭","🍔","🍟","🍕","🫓","🥪","🥙","🧆","🌮","🌯","🫔","🥗","🥘","🫕","🥫","🍝","🍜","🍲","🍛","🍣","🍱","🥟","🦪","🍤","🍙","🍚","🍘","🍥","🥠","🥮","🍢","🍡","🍧","🍨","🍦","🥧","🧁","🍰","🎂","🍮","🍭","🍬","🍫","🍿","🍩","🍪","🫖","☕","🍵","🧃","🥤","🧋","🍶","🍺","🍻","🥂","🍷","🥃","🍸","🍹","🧉","🍾"],activities:["⚽","🏀","🏈","⚾","🥎","🎾","🏐","🏉","🥏","🎱","🪀","🏓","🏸","🏒","🏑","🥍","🏏","⛳","🪁","🎣","🤿","🎽","🛹","🛼","🛷","⛸️","🥌","⛷️","🏂","🪂","🏋️","🤼","🤸","⛹️","🤾","🏌️","🏇","🧘","🏄","🏊","🤽","🚣","🧗","🚴","🚵","🎪","🎭","🎨","🎬","🎤","🎧","🎼","🎹","🥁","🎷","🎺","🎸","🎻","🎲","🎯","🎳","🎮","🎰","🧩","🎪","🎫","🎟️"],travel:["🚗","🚕","🚙","🚌","🚎","🏎️","🚓","🚑","🚒","🚐","🛻","🚚","🚛","🚜","🛵","🏍️","🛺","🚲","🛴","✈️","🛩️","🛫","🛬","🚁","🚀","🛸","🛶","⛵","🚤","🛥️","🛳️","⛴️","🚢","🏰","🏯","🏟️","🏖️","🏝️","🏜️","🌋","⛰️","🏔️","🗻","🏕️","🏭","🏢","🏬","🏣","🏤","🏥","🏦","🏨","🏪","🏫","🏩","💒","⛪","🕌","🕍","🛕","⛩️","🏛️"],objects:["📱","💻","⌨️","🖥️","🖨️","🖱️","🖲️","🕹️","🗜️","💽","💾","💿","📀","📼","📷","📸","📹","🎥","📞","☎️","📟","📠","📺","📻","🎙️","🎚️","🎛️","📡","🔋","🔌","💡","🔦","🕯️","🧯","🛢️","💸","💵","💴","💶","💷","🪙","💰","💳","💎","⚖️","🪜","🧰","🔧","🔨","⚒️","🛠️","⛏️","✏️","🖊️","🖋️","✒️","🖌️","🖍️","📝","📚","📖","🔖","📑","🗒️","📄","📰","🗞️","📁","📂","🗂️","🕐","🕑","🕒","🕓","🕔","🕕","🕖","🕗","🕘","🕙","🕚","🕛","🕰️","⏰","⏱️","⏲️","⌚"],symbols:["❤️","🧡","💛","💚","💙","💜","🤎","🖤","🤍","💔","❣️","💕","💞","💓","💗","💖","💘","💝","💟","☮️","✝️","☪️","🕉️","☸️","✡️","🔯","🕎","☯️","☦️","🛐","⛎","⚠️","🚸","⛔","🚫","☢️","☣️","➕","➖","➗","✖️","♾️","💲","💱","⬆️","↗️","➡️","↘️","⬇️","↙️","⬅️","↖️","↕️","↔️","↩️","↪️","⤴️","⤵️","🔃","🔄","🔆","📶","🎦","🔅","♻️","✅","❌","❎","➰","➿","〽️","✳️","✴️","❇️","©️","®️","™️"],flags:["🏁","🚩","🎌","🏴","🏳️","🏳️‍🌈","🏳️‍⚧️","🏴‍☠️","🇺🇸","🇬🇧","🇯🇵","🇰🇷","🇩🇪","🇨🇳","🇧🇷","🇮🇳","🇫🇷","🇪🇸","🇮🇹","🇷🇺","🇨🇦","🇦🇺","🇳🇿","🇲🇽","🇦🇷","🇵🇰","🇪🇬","🇸🇪","🇳🇴","🇳🇱","🇨🇭","🇹🇷","🇮🇩","🇸🇬","🇮🇱","🇵🇹","🇵🇱","🇹🇭"]},pe={"😀":{en:["grinning","face","smile","happy","joy"],ru:["улыбающийся","лицо","улыбка","счастливый","радость"]},"😃":{en:["smiley","face","happy","joy","laugh"],ru:["улыбчивый","лицо","счастливый","радость","смех"]},"😄":{en:["laughing","face","happy","joy","grin"],ru:["смеющийся","лицо","счастливый","радость","ухмылка"]},"😆":{en:["grinning face","laugh"],ru:["улыбка","смех"]},"😁":{en:["beaming","face","grin","smile","happy"],ru:["сияющий","лицо","улыбка","счастье","радость"]},"😅":{en:["sweat","nervous","face","laugh","relief"],ru:["пот","нервный","лицо","смех","облегчение"]},"😂":{en:["tears","joy","face","laugh","happy"],ru:["слёзы","радость","лицо","смех","счастье"]},"🤣":{en:["rolling","floor","laugh","funny","amused"],ru:["катающийся","пол","смех","смешной","развлечённый"]},"🥲":{en:["smiling","tear","bittersweet","nostalgic","happy"],ru:["улыбающийся","слеза","горько-сладкий","ностальгический","счастливый"]},"☺️":{en:["smile","blush","content","peaceful"],ru:["улыбка","румянец","довольный","спокойный"]},"😊":{en:["smiling","happy","blushing","content"],ru:["улыбающийся","счастливый","румянец","довольный"]},"😇":{en:["angel","halo","innocent","saint","pure"],ru:["ангел","ореол","невинный","святой","чистый"]},"🙂":{en:["slight","smile","face","mild"],ru:["слегка","улыбка","лицо","умеренный"]},"🙃":{en:["upside-down","silly","quirky","funny"],ru:["перевернутый","глупый","странный","смешной"]},"😉":{en:["wink","flirt","playful","smile"],ru:["подмигивание","флирт","игривый","улыбка"]},"😌":{en:["relieved","calm","content","satisfied"],ru:["облегчённый","спокойный","довольный","удовлетворённый"]},"😍":{en:["heart","love","smiling","eyes","adore"],ru:["сердце","любовь","улыбающийся","глаза","обожать"]},"🥰":{en:["love","hearts","affection","adoration","cuddle"],ru:["любовь","сердца","нежность","обожание","обниматься"]},"😙":{en:["kiss","love","affection","flirt"],ru:["поцелуй","любовь","нежность","флирт"]},"😗":{en:["kiss","face","smile","affection"],ru:["поцелуй","лицо","улыбка","нежность"]},"😚":{en:["kiss","closed eyes","affection","love"],ru:["поцелуй","закрытые глаза","нежность","любовь"]},"😘":{en:["kiss","love","affection","flirt"],ru:["поцелуй","любовь","нежность","флирт"]},"😋":{en:["yum","delicious","tasty","savor","lick"],ru:["ням","вкусно","аппетитно","наслаждаться","лизать"]},"🥸":{en:["disguise","glasses","funny","sneaky","face"],ru:["маскировка","очки","смешной","хитрый","лицо"]},"😵‍💫":{en:["dizzy","spiral eyes","confused","hypnotized","disoriented"],ru:["головокружение","спиральные глаза","запутанный","загипнотизированный","дезориентированный"]},"😛":{en:["tongue","playful","cheeky","silly"],ru:["язык","игривый","нахальный","глупый"]},"😝":{en:["tongue","silly","wacky","fun"],ru:["язык","глупый","безумный","весёлый"]},"😜":{en:["tongue","wink","playful","fun"],ru:["язык","подмигивание","игривый","весёлый"]},"🤪":{en:["crazy","wacky","zany","quirky"],ru:["сумасшедший","безумный","чудаковатый","странный"]},"😎":{en:["cool","sunglasses","confident","chill"],ru:["крутой","очки","уверенный","расслабленный"]},"🤓":{en:["nerd","geek","glasses","studious"],ru:["ботан","задрот","очки","учёный"]},"🧐":{en:["monocle","investigative","curious","thoughtful"],ru:["одноглазый","расследовательский","любопытный","задумчивый"]},"🤨":{en:["skeptical","doubtful","uncertain","raised eyebrow"],ru:["скептический","сомневающийся","неуверенный","поднятая бровь"]},"🤩":{en:["starstruck","amazed","excited","admire"],ru:["восхищённый","поражённый","взволнованный","обожать"]},"🥳":{en:["party","celebrate","birthday","festive"],ru:["вечеринка","праздновать","день рождения","праздничный"]},"😏":{en:["smirk","sly","mischievous","confident"],ru:["ухмылка","хитрый","озорной","уверенный"]},"😒":{en:["unamused","displeased","bored","sigh"],ru:["неудовлетворённый","недовольный","скучный","вздох"]},"😞":{en:["disappointed","sad","down","somber"],ru:["разочарованный","грустный","унылый","мрачный"]},"😔":{en:["pensive","sad","reflective","mournful"],ru:["задумчивый","грустный","рефлексивный","скорбный"]},"😟":{en:["worried","concerned","anxious","upset"],ru:["обеспокоенный","тревожный","беспокойный","расстроенный"]},"😕":{en:["confused","perplexed","uncertain","baffled"],ru:["смущённый","озадаченный","неуверенный","в замешательстве"]},"🙁":{en:["frowning","sad","disappointed","downcast"],ru:["хмурый","грустный","разочарованный","угнетённый"]},"☹️":{en:["frowning","sad","unhappy","mournful"],ru:["хмурый","грустный","несчастный","скорбный"]},"😣":{en:["strained","persevering","tired","discomfort"],ru:["напряжённый","терпеливый","уставший","дискомфорт"]},"😖":{en:["confounded","annoyed","distressed","exasperated"],ru:["озадаченный","раздражённый","огорчённый","изнурённый"]},"😫":{en:["tired","exhausted","weary","worn out"],ru:["усталый","измученный","изнурённый","измотанный"]},"😩":{en:["weary","tired","exhausted","overwhelmed"],ru:["изнурённый","уставший","измученный","перегруженный"]},"🥺":{en:["pleading","begging","cute","vulnerable"],ru:["умоляющий","просьба","милый","уязвимый"]},"😢":{en:["cry","sad","tear","sorrow"],ru:["плакать","грустный","слеза","печаль"]},"😭":{en:["crying","tearful","sad","heartbroken"],ru:["плачущий","со слезами","грустный","с разбитым сердцем"]},"😤":{en:["triumphant","exasperated","proud","angry"],ru:["триумфальный","раздражённый","гордый","сердитый"]},"😠":{en:["angry","mad","annoyed","irate"],ru:["сердитый","злой","раздражённый","яростный"]},"😡":{en:["pouting","mad","furious","irate"],ru:["надувшийся","злой","яростный","взбешённый"]},"🤬":{en:["cursing","swearing","angry","foul language"],ru:["ругательства","мат","сердитый","неприличный"]},"🤯":{en:["mind blown","shocked","amazed","stunned"],ru:["взрыв мозга","шокированный","поражённый","ошеломлённый"]},"😳":{en:["flushed","embarrassed","shocked","awkward"],ru:["покрасневший","смущённый","шокированный","неловкий"]},"🥵":{en:["hot","overheated","sweaty","exhausted"],ru:["горячий","перегретый","потный","изнурённый"]},"🥶":{en:["cold","freezing","chilly","frozen"],ru:["холодный","замерзающий","прохладный","замороженный"]},"😱":{en:["screaming","horror","shock","fear"],ru:["кричащий","ужас","шок","страх"]},"😨":{en:["fearful","scared","anxious","nervous"],ru:["боязливый","испуганный","тревожный","нервный"]},"😰":{en:["anxious","nervous","sweating","scared"],ru:["тревожный","нервный","потеющий","испуганный"]},"😥":{en:["disappointed","sad","pensive","teary"],ru:["разочарованный","грустный","задумчивый","со слезами"]},"😓":{en:["cold sweat","nervous","anxious","tired"],ru:["холодный пот","нервный","тревожный","усталый"]},"🤗":{en:["hug","embrace","caring","love"],ru:["объятие","принимать","заботливый","любовь"]},"🤔":{en:["thinking","pondering","curious","confused"],ru:["думающий","размышляющий","любопытный","смущённый"]},"🤭":{en:["guilty","shy","embarrassed","oops"],ru:["виноватый","застенчивый","смущённый","упс"]},"🤫":{en:["quiet","secret","hush","shh"],ru:["тихий","секрет","тишина","ш-ш"]},"🤥":{en:["lying","fib","deceitful","dishonest"],ru:["врущий","ложь","обманчивый","нечестный"]},"😶":{en:["speechless","mute","quiet","blank"],ru:["безмолвный","немой","тихий","пустой"]},"😐":{en:["neutral","expressionless","indifferent","flat"],ru:["нейтральный","без выражения","безразличный","плоский"]},"😑":{en:["deadpan","expressionless","blank","unemotional"],ru:["без эмоций","без выражения","пустой","неэмоциональный"]},"😬":{en:["grimace","awkward","nervous","tense"],ru:["гримаса","неловко","нервный","напряжённый"]},"🙄":{en:["eye roll","sarcastic","disdain","bored"],ru:["закатывание глаз","саркастичный","пренебрежительный","скучный"]},"😯":{en:["hushed","surprised","shocked","amazed"],ru:["тихий","удивлённый","шокированный","поражённый"]},"😦":{en:["frowning","dismayed","shocked","surprised"],ru:["хмурый","огорчённый","шокированный","удивлённый"]},"😧":{en:["astonished","stunned","surprised","speechless"],ru:["изумлённый","ошеломлённый","удивлённый","безмолвный"]},"😮":{en:["open mouth","surprised","shocked","amazed"],ru:["открытый рот","удивлённый","шокированный","поражённый"]},"😲":{en:["astonished","stunned","shocked","in awe"],ru:["изумлённый","ошеломлённый","шокированный","в благоговении"]},"🥱":{en:["yawning","sleepy","tired","bored"],ru:["зевота","сонный","усталый","скучный"]},"😴":{en:["sleeping","tired","napping","dozing"],ru:["спящий","усталый","дремлющий","засыпающий"]},"🤤":{en:["drooling","desire","craving","hungry"],ru:["слюнявый","желание","тяга","голодный"]},"😪":{en:["sleepy","drowsy","tired","nodding"],ru:["сонный","вялый","усталый","кивающий"]},"😵":{en:["dizzy","knocked out","stunned","confused"],ru:["головокружительный","вырубленный","ошеломлённый","сбитый с толку"]},"🤐":{en:["zipper-mouth","secretive","quiet","mute"],ru:["закрытый рот","секретный","тихий","немой"]},"🥴":{en:["woozy","tipsy","dizzy","unsteady"],ru:["ошеломлённый","подошедший","головокружительный","неустойчивый"]},"🤢":{en:["nauseated","sick","disgusted","vomit"],ru:["тошнотворный","больной","отвратительный","рвота"]},"🤮":{en:["vomiting","nauseous","sick","disgust"],ru:["рвота","тошнотворный","больной","отвратительный"]},"🤧":{en:["sneezing","ill","sick","allergy"],ru:["чихание","болен","больной","аллергия"]},"😷":{en:["mask","sick","ill","health"],ru:["маска","больной","нездоровый","здоровье"]},"🤒":{en:["fever","sick","ill","unwell"],ru:["лихорадка","больной","нездоровый","неважно"]},"🤕":{en:["injured","hurt","bandaged","pain"],ru:["раненый","повреждённый","забинтованный","боль"]},"🤑":{en:["money","rich","greedy","cash"],ru:["деньги","богатый","жадный","наличные"]},"🤠":{en:["cowboy","hat","western","fun"],ru:["ковбой","шляпа","вестерн","веселье"]},"😈":{en:["devil","mischievous","naughty","sinister"],ru:["дьявол","озорной","непослушный","зловещий"]},"👿":{en:["angry","devil","evil","fiendish"],ru:["сердитый","дьявол","злой","зловещий"]},"👹":{en:["ogre","demon","monster","scary"],ru:["огр","демон","монстр","страшный"]},"👺":{en:["goblin","troll","spooky","creepy"],ru:["гоблин","тролль","жуткий","страшный"]},"🤡":{en:["clown","silly","funny","circus"],ru:["клоун","глупый","смешной","цирк"]},"💩":{en:["poop","crap","feces","funny"],ru:["какашка","дерьмо","фекалии","смешной"]},"👻":{en:["ghost","spirit","haunted","scary"],ru:["призрак","дух","обитающий","страшный"]},"💀":{en:["skull","death","creepy","spooky"],ru:["череп","смерть","жуткий","страшный"]},"☠️":{en:["skull","danger","death","poison"],ru:["череп","опасность","смерть","яд"]},"👽":{en:["alien","extraterrestrial","space","ufo"],ru:["инопланетянин","внеземной","космос","НЛО"]},"👾":{en:["alien","monster","video game","retro"],ru:["инопланетянин","монстр","видеоигра","ретро"]},"🤖":{en:["robot","machine","tech","android"],ru:["робот","машина","технология","андроид"]},"🎃":{en:["pumpkin","halloween","spooky","festive"],ru:["тыква","Хэллоуин","жуткий","праздничный"]},"😺":{en:["smiling","cat","happy","playful"],ru:["улыбающийся","кот","счастливый","игривый"]},"😸":{en:["grinning","cat","joyful","cheerful"],ru:["широко улыбающийся","кот","радостный","весёлый"]},"😹":{en:["tearful","joy","cat","laughing"],ru:["со слезами","радость","кот","смеющийся"]},"😻":{en:["heart","cat","love","adorable"],ru:["сердце","кот","любовь","милый"]},"😼":{en:["smirking","cat","mischievous","sly"],ru:["ухмыляющийся","кот","озорной","хитрый"]},"😽":{en:["kissing","cat","affection","cute"],ru:["целующий","кот","нежность","милый"]},"🙀":{en:["surprised","cat","scared","shocked"],ru:["испуганный","кот","испуганный","шокированный"]},"😿":{en:["crying","cat","sad","tearful"],ru:["плачущий","кот","грустный","со слезами"]},"😾":{en:["angry","cat","annoyed","displeased"],ru:["сердитый","кот","раздражённый","недовольный"]},"👋":{en:["wave","hello","goodbye","greeting"],ru:["махание","привет","прощание","приветствие"]},"🤚":{en:["raised hand","stop","palm"],ru:["поднятая рука","стой","ладонь"]},"🖐️":{en:["hand","high five","greeting"],ru:["рука","дай пять","приветствие"]},"✋":{en:["stop","palm","high five"],ru:["стой","ладонь","дай пять"]},"🖖":{en:["vulcan salute","live long","sci-fi"],ru:["салют Вулканцев","живи долго","научная фантастика"]},"👌":{en:["okay","perfect","good"],ru:["ок","идеально","хорошо"]},"🤌":{en:["pinched","precise","delicious"],ru:["сжатый","точный","вкусный"]},"🤏":{en:["small","tiny","minuscule"],ru:["маленький","крошечный","микроскопический"]},"✌️":{en:["peace","victory","v sign"],ru:["мир","победа","знак победы"]},"🤞":{en:["fingers crossed","hope","luck"],ru:["скрещенные пальцы","надежда","удача"]},"🤟":{en:["I love you","rock on","sign language"],ru:["я тебя люблю","рок он","язык жестов"]},"🤘":{en:["rock","metal","horns"],ru:["рок","металл","рога"]},"🤙":{en:["call me","hang loose","shaka"],ru:["позвони мне","расслабься","шак"]},"👈":{en:["point left","direction","arrow"],ru:["указание влево","направление","стрелка"]},"👉":{en:["point right","direction","arrow"],ru:["указание вправо","направление","стрелка"]},"👆":{en:["point up","direction","up"],ru:["указание вверх","направление","вверх"]},"🖕":{en:["middle finger","offensive","rude"],ru:["средний палец","оскорбительный","грубый"]},"👇":{en:["point down","direction","down"],ru:["указание вниз","направление","вниз"]},"☝️":{en:["point up","number one","important"],ru:["указание вверх","номер один","важный"]},"👍":{en:["thumbs up","good","approve"],ru:["палец вверх","хорошо","одобрить"]},"👎":{en:["thumbs down","bad","disapprove"],ru:["палец вниз","плохо","не одобрять"]},"✊":{en:["fist","power","solidarity"],ru:["кулак","сила","солидарность"]},"👊":{en:["punch","fist bump","hit"],ru:["удар","кулачок","ударить"]},"🤛":{en:["left fist","punch","strike"],ru:["левая рука","удар","нанести удар"]},"🤜":{en:["right fist","punch","strike"],ru:["правая рука","удар","нанести удар"]},"👏":{en:["clap","applause","bravo"],ru:["хлопки","аплодисменты","браво"]},"🙌":{en:["celebrate","praise","hooray"],ru:["торжествовать","хвалить","ура"]},"👐":{en:["open hands","embrace","welcome"],ru:["раскрытые руки","объятие","добро пожаловать"]},"🤲":{en:["palms","offering","receive"],ru:["ладони","предложение","получать"]},"🤝":{en:["handshake","agreement","cooperation"],ru:["рукопожатие","соглашение","сотрудничество"]},"🙏":{en:["pray","thanks","please"],ru:["молиться","спасибо","пожалуйста"]},"✍️":{en:["writing","pen","signature"],ru:["письмо","ручка","подпись"]},"💅":{en:["nail polish","beauty","manicure"],ru:["лак для ногтей","красота","маникюр"]},"🤳":{en:["selfie","photo","camera"],ru:["селфи","фото","камера"]},"💪":{en:["flex","strong","muscle"],ru:["сгибать","сильный","мышцы"]},"🦾":{en:["mechanical arm","robotic","cyborg"],ru:["механическая рука","роботизированный","киборг"]},"🦿":{en:["mechanical leg","prosthetic","robotic"],ru:["механическая нога","протез","роботизированный"]},"🦵":{en:["leg","limb","lower body"],ru:["нога","конечность","нижняя часть тела"]},"🦶":{en:["foot","toes","step"],ru:["нога","пальцы ноги","шаг"]},"👂":{en:["ear","listening","sound"],ru:["ухо","слушание","звук"]},"🦻":{en:["hearing aid","listening","assistive"],ru:["слуховой аппарат","слушание","помощь"]},"👃":{en:["nose","smell","scent"],ru:["нос","запах","аромат"]},"🧠":{en:["brain","intelligence","mind"],ru:["мозг","интеллект","ум"]},"🫀":{en:["heart (organ)","anatomy","biology"],ru:["сердце (орган)","анатомия","биология"]},"🫁":{en:["lungs","breath","organ"],ru:["легкие","дыхание","орган"]},"🦷":{en:["tooth","dental","smile"],ru:["зуб","стоматология","улыбка"]},"🦴":{en:["bone","skeleton","hard"],ru:["кость","скелет","твердый"]},"👀":{en:["eyes","look","see"],ru:["глаза","смотреть","видеть"]},"👁️":{en:["eye","vision","watch"],ru:["глаз","зрение","наблюдать"]},"👅":{en:["tongue","taste","lick"],ru:["язык","вкус","лизать"]},"👄":{en:["lips","kiss","mouth"],ru:["губы","поцелуй","рот"]},"👶":{en:["baby","infant","cute"],ru:["младенец","ребенок","милый"]},"🧒":{en:["child","kid","youth"],ru:["ребенок","малыш","юный"]},"👦":{en:["boy","child","kid"],ru:["мальчик","ребенок","малыш"]},"👧":{en:["girl","child","kid"],ru:["девочка","ребенок","малышка"]},"🧑":{en:["person","human","individual"],ru:["человек","личность","индивид"]},"👱":{en:["blonde","person","light hair"],ru:["блондин","человек","светлые волосы"]},"👨":{en:["man","male","guy"],ru:["мужчина","мужской","парень"]},"🧔":{en:["bearded","man","facial hair"],ru:["бородатый","мужчина","борода"]},"👩":{en:["woman","female","lady"],ru:["женщина","женский","дама"]},"🧓":{en:["elderly","senior","aged"],ru:["пожилой","старший","в преклонном возрасте"]},"👴":{en:["old man","elderly","senior"],ru:["старик","пожилой","старший"]},"👵":{en:["old woman","elderly","senior"],ru:["старуха","пожилая","старшая"]},"🙍":{en:["frowning","sad","displeased"],ru:["хмурый","грустный","недовольный"]},"🙎":{en:["pouting","angry","displeased"],ru:["надувшийся","сердитый","недовольный"]},"🙅":{en:["no","prohibited","refusal"],ru:["нет","запрещено","отказ"]},"🙆":{en:["ok","acceptable","okay"],ru:["ок","приемлемо","хорошо"]},"💁":{en:["information","help","assistance"],ru:["информация","помощь","поддержка"]},"🙋":{en:["raising hand","question","volunteer"],ru:["поднимающая руку","вопрос","доброволец"]},"🧏":{en:["deaf","listening","silent"],ru:["глухой","слушающий","безмолвный"]},"🙇":{en:["bowing","apologetic","respect"],ru:["наклон","извиняющийся","уважение"]},"🤦":{en:["facepalm","disbelief","oops"],ru:["лицо ладонь","недоверие","упс"]},"🤷":{en:["shrug","uncertain","indifferent"],ru:["пожимание плечами","неуверенный","безразличный"]},"👮":{en:["police","officer","law"],ru:["полицейский","офицер","закон"]},"🕵️":{en:["detective","spy","investigate"],ru:["детектив","шпион","расследование"]},"💂":{en:["guard","soldier","military"],ru:["страж","солдат","военный"]},"🥷":{en:["ninja","stealth","assassin"],ru:["ниндзя","скрытность","ассассин"]},"👷":{en:["construction","worker","helmet"],ru:["строитель","рабочий","шлем"]},"🤴":{en:["prince","royalty","king"],ru:["принц","королевская семья","король"]},"👸":{en:["princess","royalty","queen"],ru:["принцесса","королевская семья","королева"]},"👳":{en:["turban","cultural","tradition"],ru:["тюрбан","культура","традиция"]},"👲":{en:["man with cap","cultural","traditional"],ru:["мужчина в кепке","культура","традиционный"]},"🧕":{en:["woman with headscarf","cultural","modest"],ru:["женщина в платке","культурная","скромная"]},"🤵":{en:["tuxedo","groom","formal"],ru:["смокинг","жених","официальный"]},"👰":{en:["bride","wedding","formal"],ru:["невеста","свадьба","официальный"]},"🤰":{en:["pregnant","expecting","mother"],ru:["беременная","ожидающая","мать"]},"🤱":{en:["nursing","mother","baby"],ru:["кормящая","мать","ребенок"]},"👼":{en:["angel","cherub","divine"],ru:["ангел","херувим","божественный"]},"🎅":{en:["santa","christmas","jolly"],ru:["Санта","Рождество","радостный"]},"🤶":{en:["mrs claus","christmas","holiday"],ru:["миссис Клаус","Рождество","праздник"]},"🦸":{en:["superhero","power","hero"],ru:["супергерой","сила","герой"]},"🦹":{en:["villain","bad","criminal"],ru:["злодей","плохой","преступник"]},"🧙":{en:["wizard","magic","sorcery"],ru:["волшебник","магия","колдовство"]},"🧚":{en:["fairy","magic","mystical"],ru:["фея","магия","мистический"]},"🧛":{en:["vampire","dracula","undead"],ru:["вампир","Дракула","нежить"]},"🧜":{en:["mermaid","mythical","ocean"],ru:["русалка","мифическая","океан"]},"🐵":{en:["monkey","ape","funny","mammal"],ru:["обезьяна","примат","смешной","млекопитающее"]},"🐒":{en:["monkey","primate","curious"],ru:["обезьяна","примат","любопытный"]},"🦍":{en:["gorilla","ape","strong","wild"],ru:["горилла","обезьяна","сильный","дикий"]},"🦧":{en:["orangutan","ape","wild","mammal"],ru:["орангутан","обезьяна","дикий","млекопитающее"]},"🐶":{en:["dog","puppy","pet","mammal"],ru:["собака","щенок","домашний питомец","млекопитающее"]},"🐕":{en:["dog","canine","pet"],ru:["собака","псовой","домашний питомец"]},"🦮":{en:["guide dog","service","assistance"],ru:["собака-поводырь","служебная","помощь"]},"🐕‍🦺":{en:["service dog","working","assistance"],ru:["служебная собака","рабочая","помощь"]},"🐩":{en:["poodle","dog","pet","fancy"],ru:["пудель","собака","домашний питомец","элегантный"]},"🐺":{en:["wolf","wild","howl"],ru:["волк","дикий","воет"]},"🦊":{en:["fox","cunning","wild"],ru:["лиса","хитрая","дикая"]},"🦝":{en:["raccoon","mischievous","wild"],ru:["енот","озорной","дикий"]},"🐱":{en:["cat","pet","feline"],ru:["кот","домашний питомец","кошачий"]},"🐈":{en:["cat","feline","pet"],ru:["кот","кошачий","домашний питомец"]},"🐈‍⬛":{en:["black cat","mysterious","feline"],ru:["чёрный кот","загадочный","кошачий"]},"🦁":{en:["lion","king","wild","courage"],ru:["лев","король","дикий","отвага"]},"🐯":{en:["tiger","wild","stripes","fierce"],ru:["тигр","дикий","полосатый","свирепый"]},"🐅":{en:["tiger","stripes","wild"],ru:["тигр","полосатый","дикий"]},"🐆":{en:["leopard","spots","wild","fast"],ru:["леопард","пятна","дикий","быстрый"]},"🐴":{en:["horse","ride","equine"],ru:["лошадь","езда","конный"]},"🐎":{en:["horse","racing","equine"],ru:["лошадь","гонки","конный"]},"🦄":{en:["unicorn","magical","fantasy"],ru:["единорог","волшебный","фэнтези"]},"🦓":{en:["zebra","stripes","wild"],ru:["зебра","полосатая","дикая"]},"🦌":{en:["deer","antlers","forest"],ru:["олень","рога","лес"]},"🦬":{en:["bison","buffalo","wild"],ru:["бизон","буйвол","дикий"]},"🐮":{en:["cow","farm","bovine"],ru:["корова","ферма","коровий"]},"🐂":{en:["ox","bull","bovine"],ru:["вол","бык","коровий"]},"🐃":{en:["water buffalo","bovine","farm"],ru:["водный буйвол","коровий","ферма"]},"🐄":{en:["cow","bovine","farm"],ru:["корова","коровий","ферма"]},"🐷":{en:["pig","farm","oink"],ru:["свинья","ферма","хрюк"]},"🐖":{en:["pig","swine","farm"],ru:["свинья","свинное животное","ферма"]},"🐗":{en:["boar","wild","pig"],ru:["кабан","дикий","свинья"]},"🐽":{en:["pig nose","snout"],ru:["свинной нос","хоботок"]},"🐏":{en:["ram","sheep","male"],ru:["баран","овца","самец"]},"🐑":{en:["sheep","wool","farm"],ru:["овца","шерсть","ферма"]},"🐐":{en:["goat","farm","bleat"],ru:["коза","ферма","блеет"]},"🐪":{en:["camel","desert","hump"],ru:["верблюд","пустыня","горб"]},"🐫":{en:["camel","two-hump","desert"],ru:["двугорбый верблюд","двугорбый","пустыня"]},"🦙":{en:["llama","alpaca","cute"],ru:["лама","альпака","милый"]},"🦒":{en:["giraffe","tall","spots"],ru:["жираф","высокий","пятна"]},"🐘":{en:["elephant","trunk","large"],ru:["слон","хобот","большой"]},"🦏":{en:["rhinoceros","horn","tough"],ru:["носорог","рог","жесткий"]},"🦛":{en:["hippopotamus","water","large"],ru:["бегемот","вода","большой"]},"🦃":{en:["turkey","bird","thanksgiving"],ru:["индейка","птица","День благодарения"]},"🐔":{en:["chicken","rooster","hen"],ru:["курица","петух","курица (самка)"]},"🐓":{en:["rooster","chicken","bird"],ru:["петух","курица","птица"]},"🐣":{en:["hatching chick","baby","bird"],ru:["вылупляющийся цыплёнок","малыш","птица"]},"🐤":{en:["chick","small","bird"],ru:["цыплёнок","маленький","птица"]},"🐥":{en:["baby chicken","cute","bird"],ru:["цыплёнок","милый","птица"]},"🐦":{en:["bird","tweet","wing"],ru:["птица","чирик","крыло"]},"🐧":{en:["penguin","cold","bird"],ru:["пингвин","холодный","птица"]},"🕊️":{en:["dove","peace","bird"],ru:["голубь","мир","птица"]},"🦅":{en:["eagle","wild","bird"],ru:["орёл","дикий","птица"]},"🦆":{en:["duck","water","bird"],ru:["утка","вода","птица"]},"🦢":{en:["swan","graceful","bird"],ru:["лебедь","грациозный","птица"]},"🦉":{en:["owl","wise","night","bird"],ru:["сова","мудрая","ночная","птица"]},"🦤":{en:["dodo","extinct","bird"],ru:["додо","вымершая","птица"]},"🪶":{en:["feather","light","bird"],ru:["перо","лёгкое","птица"]},"🦩":{en:["flamingo","pink","bird"],ru:["фламинго","розовый","птица"]},"🦚":{en:["peacock","colorful","bird"],ru:["павлин","яркий","птица"]},"🦜":{en:["parrot","talkative","colorful"],ru:["попугай","болтливый","яркий"]},"🐸":{en:["frog","amphibian","green"],ru:["лягушка","амфибия","зелёная"]},"🐊":{en:["crocodile","reptile","danger"],ru:["крокодил","рептилия","опасность"]},"🐢":{en:["turtle","slow","reptile"],ru:["черепаха","медленная","рептилия"]},"🦎":{en:["lizard","reptile","scaly"],ru:["ящерица","рептилия","чешуйчатая"]},"🐍":{en:["snake","reptile","slither"],ru:["змея","рептилия","ползать"]},"🐲":{en:["dragon face","mythical","dragon"],ru:["лицо дракона","мифический","дракон"]},"🐉":{en:["dragon","mythical","fire"],ru:["дракон","мифический","огонь"]},"🦕":{en:["dinosaur","sauropod","prehistoric"],ru:["динозавр","зауропод","доисторический"]},"🦖":{en:["dinosaur","T-Rex","prehistoric"],ru:["динозавр","Ти-Рекс","доисторический"]},"🐳":{en:["whale","ocean","large"],ru:["кит","океан","большой"]},"🐋":{en:["whale","ocean","big"],ru:["кит","океан","огромный"]},"🐬":{en:["dolphin","ocean","friendly"],ru:["дельфин","океан","дружелюбный"]},"🦭":{en:["seal","marine","cute"],ru:["тюлень","морской","милый"]},"🐟":{en:["fish","ocean","swim"],ru:["рыба","океан","плавать"]},"🐠":{en:["tropical fish","ocean","colorful"],ru:["тропическая рыба","океан","яркая"]},"🐡":{en:["blowfish","puffer","ocean"],ru:["рыба-иглобрюх","фугу","океан"]},"🦈":{en:["shark","ocean","dangerous"],ru:["акула","океан","опасная"]},"🐙":{en:["octopus","marine","tentacles"],ru:["осьминог","морской","щупальца"]},"🐚":{en:["shell","beach","ocean"],ru:["ракушка","пляж","океан"]},"🪸":{en:["coral","reef","ocean"],ru:["коралл","риф","океан"]},"🐌":{en:["snail","slow","mollusk"],ru:["улитка","медленная","моллюск"]},"🦋":{en:["butterfly","insect","colorful"],ru:["бабочка","насекомое","яркая"]},"🐛":{en:["caterpillar","insect","larva"],ru:["гусеница","насекомое","личинка"]},"🐜":{en:["ant","small","insect"],ru:["муравей","маленький","насекомое"]},"🐝":{en:["bee","insect","honey"],ru:["пчела","насекомое","мёд"]},"🪲":{en:["beetle","insect","bug"],ru:["жук","насекомое","баг"]},"🐞":{en:["ladybug","insect","lucky"],ru:["божья коровка","насекомое","счастливая"]},"🦗":{en:["cricket","insect","chirp"],ru:["сверчок","насекомое","щебет"]},"🪳":{en:["cockroach","insect","pest"],ru:["таракан","насекомое","вредитель"]},"🕷️":{en:["spider","arachnid","insect"],ru:["паук","паукообразное","насекомое"]},"🕸️":{en:["web","spider","trap"],ru:["паутина","паук","ловушка"]},"🦂":{en:["scorpion","insect","venom"],ru:["скорпион","насекомое","яд"]},"🦟":{en:["mosquito","insect","bite"],ru:["комар","насекомое","укус"]},"🪰":{en:["fly","insect","buzz"],ru:["муха","насекомое","жужжание"]},"🪱":{en:["worm","earth","invertebrate"],ru:["червь","земля","беспозвоночное"]},"🌸":{en:["cherry blossom","flower","spring"],ru:["сакура","цветок","весна"]},"💮":{en:["white flower","flower","symbol"],ru:["белый цветок","цветок","символ"]},"🏵️":{en:["rosette","flower","decorative"],ru:["розетка","цветок","декоративный"]},"🌹":{en:["rose","flower","love","romance"],ru:["роза","цветок","любовь","романтика"]},"🥀":{en:["wilted flower","sad","decay"],ru:["увядший цветок","грусть","разложение"]},"🌺":{en:["hibiscus","flower","tropical"],ru:["гибискус","цветок","тропический"]},"🌻":{en:["sunflower","flower","summer"],ru:["подсолнух","цветок","лето"]},"🌼":{en:["blossom","flower","spring"],ru:["цветение","цветок","весна"]},"🌷":{en:["tulip","flower","spring"],ru:["тюльпан","цветок","весна"]},"🌱":{en:["seedling","plant","growth"],ru:["сеянец","растение","рост"]},"🪴":{en:["potted plant","indoor","green"],ru:["растение в горшке","в помещении","зелёное"]},"🌲":{en:["evergreen","tree","forest"],ru:["вечнозелёное","дерево","лес"]},"🌳":{en:["tree","nature","shade"],ru:["дерево","природа","тень"]},"🌴":{en:["palm tree","tropical","beach"],ru:["пальма","тропический","пляж"]},"🌵":{en:["cactus","desert","succulent"],ru:["кактус","пустыня","суккулент"]},"🌾":{en:["sheaf","grain","farm"],ru:["сноп","зерно","ферма"]},"🌿":{en:["herb","plant","leaf"],ru:["трава","растение","лист"]},"☘️":{en:["shamrock","luck","clover"],ru:["клевер","удача","трилистник"]},"🍀":{en:["four-leaf clover","luck","green"],ru:["клевер с четырьмя листьями","удача","зелёный"]},"🍁":{en:["maple leaf","autumn","fall"],ru:["кленовый лист","осень","осенний"]},"🍂":{en:["fallen leaf","autumn","nature"],ru:["опавший лист","осень","природа"]},"🍃":{en:["leaf","wind","nature"],ru:["лист","ветер","природа"]},"🍎":{en:["apple","red","fruit","healthy"],ru:["яблоко","красное","фрукт","полезное"]},"🍐":{en:["pear","fruit","green","juicy"],ru:["груша","фрукт","зелёная","сочная"]},"🍊":{en:["orange","fruit","citrus","vitamin C"],ru:["апельсин","фрукт","цитрус","витамин C"]},"🍋":{en:["lemon","citrus","sour","yellow"],ru:["лимон","цитрус","кислый","жёлтый"]},"🍌":{en:["banana","fruit","yellow","tropical"],ru:["банан","фрукт","жёлтый","тропический"]},"🍉":{en:["watermelon","fruit","summer","refreshing"],ru:["арбуз","фрукт","лето","освежающий"]},"🍇":{en:["grapes","fruit","purple","vine"],ru:["виноград","фрукт","фиолетовый","виноградная лоза"]},"🍓":{en:["strawberry","fruit","red","sweet"],ru:["клубника","фрукт","красная","сладкая"]},"🫐":{en:["blueberry","fruit","blue","healthy"],ru:["черника","фрукт","синяя","полезная"]},"🍈":{en:["melon","fruit","sweet","green"],ru:["дыня","фрукт","сладкая","зелёная"]},"🍒":{en:["cherry","fruit","red","sweet"],ru:["вишня","фрукт","красная","сладкая"]},"🍑":{en:["peach","fruit","fuzzy","sweet"],ru:["персик","фрукт","шероховатый","сладкий"]},"🥭":{en:["mango","fruit","tropical","yellow"],ru:["манго","фрукт","тропический","жёлтый"]},"🍍":{en:["pineapple","fruit","tropical","spiky"],ru:["ананас","фрукт","тропический","колючий"]},"🥥":{en:["coconut","tropical","fruit","white"],ru:["кокос","тропический","фрукт","белый"]},"🥝":{en:["kiwi","fruit","green","tart"],ru:["киви","фрукт","зелёный","кисловатый"]},"🍅":{en:["tomato","vegetable","red","juicy"],ru:["помидор","овощ","красный","сочный"]},"🍆":{en:["eggplant","vegetable","purple","aubergine"],ru:["баклажан","овощ","фиолетовый","баклажан"]},"🥑":{en:["avocado","vegetable","green","healthy"],ru:["авокадо","овощ","зелёный","полезный"]},"🥦":{en:["broccoli","vegetable","green","healthy"],ru:["брокколи","овощ","зелёный","полезный"]},"🥬":{en:["leafy greens","vegetable","lettuce","healthy"],ru:["листья салата","овощ","салат","полезный"]},"🥒":{en:["cucumber","vegetable","green","fresh"],ru:["огурец","овощ","зелёный","свежий"]},"🌶️":{en:["chili pepper","spicy","red","hot"],ru:["чили","острый","красный","горячий"]},"🫑":{en:["bell pepper","vegetable","colorful","sweet"],ru:["болгарский перец","овощ","разноцветный","сладкий"]},"🥕":{en:["carrot","vegetable","orange","crunchy"],ru:["морковь","овощ","оранжевая","хрустящая"]},"🧄":{en:["garlic","vegetable","aromatic","flavorful"],ru:["чеснок","овощ","ароматный","вкусный"]},"🧅":{en:["onion","vegetable","strong","flavor"],ru:["лук","овощ","сильный","вкус"]},"🥔":{en:["potato","vegetable","starchy","brown"],ru:["картофель","овощ","крахмалистый","коричневый"]},"🍠":{en:["sweet potato","vegetable","orange","starchy"],ru:["батат","овощ","оранжевый","крахмалистый"]},"🥐":{en:["croissant","bread","pastry","flaky"],ru:["круассан","хлеб","выпечка","слоёный"]},"🥯":{en:["bagel","bread","round","chewy"],ru:["бейгл","хлеб","круглый","жевательный"]},"🍞":{en:["bread","baked","loaf","toast"],ru:["хлеб","выпеченный","буханка","тост"]},"🥖":{en:["baguette","bread","French","long"],ru:["багет","хлеб","французский","длинный"]},"🥨":{en:["pretzel","snack","salted","twisted"],ru:["претцель","закуска","солёный","скрученный"]},"🧀":{en:["cheese","dairy","yellow","savory"],ru:["сыр","молочный продукт","жёлтый","пикантный"]},"🥚":{en:["egg","protein","breakfast"],ru:["яйцо","белок","завтрак"]},"🍳":{en:["fried egg","breakfast","cooked"],ru:["жареное яйцо","завтрак","приготовленное"]},"🥓":{en:["bacon","meat","crispy","breakfast"],ru:["бекон","мясо","хрустящий","завтрак"]},"🥩":{en:["steak","meat","protein","beef"],ru:["стейк","мясо","белок","говядина"]},"🍗":{en:["chicken leg","meat","drumstick","grilled"],ru:["куриная ножка","мясо","барабанная палочка","гриль"]},"🍖":{en:["meat on bone","barbecue","protein"],ru:["мясо на кости","барбекю","белок"]},"🦴":{en:["bone","meat","dog","skeleton"],ru:["кость","мясо","собака","скелет"]},"🌭":{en:["hot dog","fast food","sausage"],ru:["хот-дог","фастфуд","колбаска"]},"🍔":{en:["burger","fast food","beef","cheese"],ru:["бургер","фастфуд","говядина","сыр"]},"🍟":{en:["french fries","fast food","crispy","potato"],ru:["картофель фри","фастфуд","хрустящий","картофель"]},"🍕":{en:["pizza","cheese","fast food","Italian"],ru:["пицца","сыр","фастфуд","итальянская"]},"🫓":{en:["flatbread","bread","soft"],ru:["лепёшка","хлеб","мягкая"]},"🥪":{en:["sandwich","bread","meal"],ru:["бутерброд","хлеб","приём пищи"]},"🥙":{en:["pita","bread","stuffed","Greek"],ru:["пита","хлеб","фаршированная","греческая"]},"🧆":{en:["falafel","vegetarian","fried"],ru:["фалафель","вегетарианский","жареный"]},"🌮":{en:["taco","Mexican","spicy"],ru:["тако","мексиканская","острая"]},"🌯":{en:["burrito","Mexican","stuffed"],ru:["буррито","мексиканская","фаршированная"]},"🫔":{en:["tamale","Mexican","corn"],ru:["тамале","мексиканская","кукурузная"]},"🥗":{en:["salad","healthy","vegetable"],ru:["салат","здоровый","овощной"]},"🥘":{en:["paella","stew","seafood"],ru:["паэлья","тушёное блюдо","морепродукты"]},"🫕":{en:["fondue","melted","cheese"],ru:["фондю","расплавленный","сыр"]},"🥫":{en:["canned food","storage","preserved"],ru:["консервы","хранение","сохранённое"]},"🍝":{en:["spaghetti","pasta","Italian"],ru:["спагетти","паста","итальянская"]},"🍜":{en:["ramen","noodles","Asian"],ru:["рамен","лапша","азиатская"]},"🍲":{en:["hotpot","stew","broth"],ru:["хотпот","тушёное блюдо","бульон"]},"🍛":{en:["curry","spicy","rice"],ru:["карри","острая","рис"]},"🍣":{en:["sushi","Japanese","fish"],ru:["суши","японская","рыба"]},"🍱":{en:["bento box","Japanese","meal"],ru:["бенто","японская","еда"]},"🥟":{en:["dumpling","Asian","stuffed"],ru:["пельмени","азиатские","фаршированные"]},"🦪":{en:["oyster","seafood","shellfish"],ru:["устрица","морепродукт","раковина"]},"🍤":{en:["shrimp tempura","fried","seafood"],ru:["креветка темпура","жареная","морепродукт"]},"🍙":{en:["rice ball","Japanese","onigiri"],ru:["рисовый шар","японская","онигири"]},"🍚":{en:["cooked rice","staple","Asian"],ru:["варёный рис","основа","азиатская"]},"🍘":{en:["rice cracker","snack","Japanese"],ru:["рисовый крекер","закуска","японская"]},"🍥":{en:["fish cake","Japanese","swirl"],ru:["рыбный пирожок","японская","спираль"]},"🥠":{en:["fortune cookie","Chinese","paper"],ru:["печенье с предсказанием","китайское","бумажное"]},"🥮":{en:["mooncake","Chinese","festival"],ru:["лунное печенье","китайское","фестиваль"]},"🍢":{en:["skewered snack","street food"],ru:["шампур","уличная еда"]},"🍡":{en:["dango","Japanese","mochi"],ru:["данго","японское","мочи"]},"🍧":{en:["shaved ice","dessert","cold"],ru:["измельчённый лёд","десерт","холодный"]},"🍨":{en:["ice cream","cold","sweet"],ru:["мороженое","холодное","сладкое"]},"🍦":{en:["soft serve","dessert","cold"],ru:["мягкое мороженое","десерт","холодное"]},"🥧":{en:["pie","dessert","baked"],ru:["пирог","десерт","выпеченный"]},"🧁":{en:["cupcake","sweet","frosting"],ru:["капкейк","сладкий","с глазурью"]},"🍰":{en:["cake","dessert","slice"],ru:["торт","десерт","кусок"]},"🎂":{en:["birthday cake","celebration","sweet"],ru:["торт ко дню рождения","празднование","сладкий"]},"🍮":{en:["flan","custard","dessert"],ru:["флан","кастард","десерт"]},"🍭":{en:["lollipop","candy","sweet"],ru:["леденец","конфета","сладкий"]},"🍬":{en:["candy","sweet","sugar"],ru:["конфета","сладость","сахар"]},"🍫":{en:["chocolate","sweet","cocoa"],ru:["шоколад","сладкий","какао"]},"🍿":{en:["popcorn","snack","buttery"],ru:["попкорн","закуска","масляный"]},"🍩":{en:["doughnut","sweet","fried"],ru:["пончик","сладкий","жареный"]},"🍪":{en:["cookie","sweet","baked"],ru:["печенье","сладкое","выпеченное"]},"🫖":{en:["teapot","tea","hot"],ru:["чайник","чай","горячий"]},"☕":{en:["coffee","hot drink","caffeine"],ru:["кофе","горячий напиток","кофеин"]},"🍵":{en:["green tea","hot","Japanese"],ru:["зелёный чай","горячий","японский"]},"🧃":{en:["juice","drink","fruit"],ru:["сок","напиток","фруктовый"]},"🥤":{en:["soft drink","straw","fast food"],ru:["безалкогольный напиток","с трубочкой","фастфуд"]},"🧋":{en:["bubble tea","milk tea","boba"],ru:["бабл-ти","молочный чай","боба"]},"🍶":{en:["sake","Japanese","rice wine"],ru:["саке","японский","рисовое вино"]},"🍺":{en:["beer","drink","alcohol"],ru:["пиво","напиток","алкоголь"]},"🍻":{en:["cheers","beer","drinking"],ru:["ура","пиво","выпивка"]},"🥂":{en:["champagne","celebration","toast"],ru:["шампанское","празднование","тост"]},"🍷":{en:["wine","drink","red"],ru:["вино","напиток","красное"]},"🥃":{en:["whiskey","liquor","alcohol"],ru:["виски","ликёр","алкоголь"]},"🍸":{en:["cocktail","martini","drink"],ru:["коктейль","мартини","напиток"]},"🍹":{en:["tropical drink","cocktail","summer"],ru:["тропический напиток","коктейль","лето"]},"🧉":{en:["mate","South American","tea"],ru:["мате","южноамериканский","чай"]},"🍾":{en:["champagne bottle","celebration","party"],ru:["бутылка шампанского","празднование","вечеринка"]},"⚽":{en:["soccer","football","sports","ball"],ru:["футбол","футбол","спорт","мяч"]},"🏀":{en:["basketball","sports","hoop","dunk"],ru:["баскетбол","спорт","кольцо","данк"]},"🏈":{en:["American football","sports","rugby"],ru:["американский футбол","спорт","регби"]},"⚾":{en:["baseball","sports","bat"],ru:["бейсбол","спорт","бита"]},"🥎":{en:["softball","sports","ball"],ru:["софтбол","спорт","мяч"]},"🎾":{en:["tennis","sports","racket"],ru:["теннис","спорт","ракетка"]},"🏐":{en:["volleyball","sports","beach"],ru:["волейбол","спорт","пляж"]},"🏉":{en:["rugby","sports","oval ball"],ru:["регби","спорт","овальный мяч"]},"🥏":{en:["frisbee","throw","flying disc"],ru:["фрисби","бросок","летающий диск"]},"🎱":{en:["billiards","8 ball","pool"],ru:["бильярд","восьмёрка","пул"]},"🪀":{en:["yo-yo","toy","string"],ru:["йо-йо","игрушка","верёвка"]},"🏓":{en:["ping pong","table tennis","sports"],ru:["пинг-понг","настольный теннис","спорт"]},"🏸":{en:["badminton","racket","sports"],ru:["бадминтон","ракетка","спорт"]},"🏒":{en:["hockey","ice hockey","sports"],ru:["хоккей","хоккей на льду","спорт"]},"🏑":{en:["field hockey","sports","stick"],ru:["хоккей на траве","спорт","клюшка"]},"🥍":{en:["lacrosse","sports","net"],ru:["лакросс","спорт","сеть"]},"🏏":{en:["cricket","bat","sports"],ru:["крикет","бита","спорт"]},"⛳":{en:["golf","sports","hole in one"],ru:["гольф","спорт","луночка"]},"🪁":{en:["kite","flying","wind"],ru:["змей","летать","ветер"]},"🎣":{en:["fishing","hook","water"],ru:["рыбалка","крючок","вода"]},"🤿":{en:["diving","underwater","snorkel"],ru:["дайвинг","под водой","снорклинг"]},"🎽":{en:["running","jersey","athlete"],ru:["бег","майка","спортсмен"]},"🛹":{en:["skateboard","sports","extreme"],ru:["скейтборд","спорт","экстрим"]},"🛼":{en:["roller skate","sports","wheels"],ru:["роликовые коньки","спорт","колёса"]},"🛷":{en:["sled","winter","snow"],ru:["санки","зима","снег"]},"⛸️":{en:["ice skate","winter","sports"],ru:["коньки","зима","спорт"]},"🥌":{en:["curling","winter","stone"],ru:["керлинг","зима","камень"]},"⛷️":{en:["skiing","winter","snow"],ru:["лыжи","зима","снег"]},"🏂":{en:["snowboarding","sports","snow"],ru:["сноуборд","спорт","снег"]},"🪂":{en:["parachute","skydiving","air"],ru:["парашют","скайдайвинг","воздух"]},"🏋️":{en:["weightlifting","gym","strong"],ru:["тяжёлая атлетика","спортзал","сильный"]},"🤼":{en:["wrestling","fight","grapple"],ru:["борьба","драка","схватка"]},"🤸":{en:["gymnastics","acrobatics","flip"],ru:["гимнастика","акробатика","сальто"]},"⛹️":{en:["basketball","dribbling","sports"],ru:["баскетбол","дриблинг","спорт"]},"🤾":{en:["handball","sports","throw"],ru:["гандбол","спорт","бросок"]},"🏌️":{en:["golf","swing","sports"],ru:["гольф","мах","спорт"]},"🏇":{en:["horse racing","sports","jockey"],ru:["конные скачки","спорт","жокей"]},"🧘":{en:["meditation","yoga","zen"],ru:["медитация","йога","дзен"]},"🏄":{en:["surfing","wave","water"],ru:["серфинг","волна","вода"]},"🏊":{en:["swimming","water","pool"],ru:["плавание","вода","бассейн"]},"🤽":{en:["water polo","sports","swimming"],ru:["водное поло","спорт","плавание"]},"🚣":{en:["rowing","boat","water"],ru:["гребля","лодка","вода"]},"🧗":{en:["rock climbing","sports","mountain"],ru:["скалолазание","спорт","гора"]},"🚴":{en:["cycling","bike","sports"],ru:["велоспорт","велосипед","спорт"]},"🚵":{en:["mountain biking","sports","outdoor"],ru:["маунтинбайк","спорт","на свежем воздухе"]},"🎪":{en:["circus","tent","performance"],ru:["цирк","палатка","выступление"]},"🎭":{en:["theater","drama","acting"],ru:["театр","драма","актерство"]},"🎨":{en:["painting","art","colors"],ru:["живопись","искусство","цвета"]},"🎬":{en:["film","clapperboard","movie"],ru:["фильм","хлопушка","кино"]},"🎤":{en:["microphone","singing","music"],ru:["микрофон","пение","музыка"]},"🎧":{en:["headphones","music","listening"],ru:["наушники","музыка","прослушивание"]},"🎼":{en:["music","sheet","notes"],ru:["музыка","ноты","сценарий"]},"🎹":{en:["piano","keyboard","music"],ru:["пианино","клавиатура","музыка"]},"🥁":{en:["drums","music","percussion"],ru:["барабаны","музыка","ударные"]},"🎷":{en:["saxophone","jazz","music"],ru:["саксофон","джаз","музыка"]},"🎺":{en:["trumpet","brass","music"],ru:["труба","латунь","музыка"]},"🎸":{en:["guitar","music","rock"],ru:["гитара","музыка","рок"]},"🎻":{en:["violin","music","strings"],ru:["скрипка","музыка","струны"]},"🎲":{en:["dice","game","board game"],ru:["кубики","игра","настольная игра"]},"🎯":{en:["dart","target","game"],ru:["дротик","цель","игра"]},"🎳":{en:["bowling","sports","pins"],ru:["боулинг","спорт","кегли"]},"🎮":{en:["video game","console","gaming"],ru:["видеоигра","консоль","игры"]},"🎰":{en:["slot machine","casino","gambling"],ru:["игровой автомат","казино","азартные игры"]},"🧩":{en:["puzzle","pieces","brain teaser"],ru:["головоломка","кусочки","разминка для мозга"]},"🎫":{en:["ticket","event","entry"],ru:["билет","событие","вход"]},"🎟️":{en:["admission","ticket","event"],ru:["входной билет","билет","событие"]},"🚗":{en:["car","automobile","vehicle","transport"],ru:["автомобиль","машина","транспортное средство","транспорт"]},"🚕":{en:["taxi","cab","transport","vehicle"],ru:["такси","маршрутка","транспорт","транспортное средство"]},"🚙":{en:["suv","vehicle","transport"],ru:["внедорожник","транспортное средство","транспорт"]},"🚌":{en:["bus","public transport","commute"],ru:["автобус","общественный транспорт","коммьют"]},"🚎":{en:["trolleybus","public transport","electric"],ru:["троллейбус","общественный транспорт","электрический"]},"🏎️":{en:["race car","sports car","fast","speed"],ru:["гоночный автомобиль","спортивный автомобиль","быстрый","скорость"]},"🚓":{en:["police car","law enforcement","vehicle"],ru:["полицейская машина","правоохранительные органы","транспортное средство"]},"🚑":{en:["ambulance","emergency","hospital"],ru:["скорая помощь","чрезвычайная ситуация","больница"]},"🚒":{en:["fire truck","firefighter","emergency"],ru:["пожарная машина","пожарный","чрезвычайная ситуация"]},"🚐":{en:["van","minibus","transport"],ru:["фургон","маршрутка","транспорт"]},"🛻":{en:["pickup truck","off-road","vehicle"],ru:["пикап","для бездорожья","транспортное средство"]},"🚚":{en:["delivery truck","freight","cargo"],ru:["грузовик","доставка","груз"]},"🚛":{en:["truck","semi-trailer","transport"],ru:["грузовик","самосвал","транспорт"]},"🚜":{en:["tractor","farming","agriculture"],ru:["трактор","сельское хозяйство","агрономия"]},"🛵":{en:["scooter","motorbike","moped"],ru:["скутер","мотоцикл","мопед"]},"🏍️":{en:["motorcycle","bike","racing"],ru:["мотоцикл","байк","гоночный"]},"🛺":{en:["rickshaw","auto rickshaw","transport"],ru:["рикша","авто-рикша","транспорт"]},"🚲":{en:["bicycle","bike","pedal","cycling"],ru:["велосипед","байк","педаль","велоспорт"]},"🛴":{en:["kick scooter","scooter","ride"],ru:["самокат","скутер","поездка"]},"✈️":{en:["airplane","flight","travel","sky"],ru:["самолёт","рейс","путешествие","небо"]},"🛩️":{en:["small airplane","aviation","sky"],ru:["малый самолёт","авиация","небо"]},"🛫":{en:["departure","takeoff","airport"],ru:["вылет","взлёт","аэропорт"]},"🛬":{en:["landing","arrival","airport"],ru:["посадка","прибытие","аэропорт"]},"🚁":{en:["helicopter","aviation","air"],ru:["вертолёт","авиация","воздух"]},"🚀":{en:["rocket","space","launch","NASA"],ru:["ракета","космос","запуск","НАСА"]},"🛸":{en:["UFO","alien","spaceship","extraterrestrial"],ru:["НЛО","инопланетянин","космический корабль","внеземной"]},"🛶":{en:["canoe","boat","paddle","water"],ru:["каноэ","лодка","весло","вода"]},"⛵":{en:["sailboat","yacht","sea"],ru:["парусник","яхта","море"]},"🚤":{en:["motorboat","speedboat","ocean"],ru:["моторная лодка","скоростной катер","океан"]},"🛥️":{en:["yacht","luxury","boat"],ru:["яхта","роскошь","лодка"]},"🛳️":{en:["cruise ship","ocean","voyage"],ru:["круизный лайнер","океан","путешествие"]},"⛴️":{en:["ferry","boat","transport"],ru:["паром","лодка","транспорт"]},"🚢":{en:["ship","ocean","voyage"],ru:["корабль","океан","путешествие"]},"🏰":{en:["castle","fortress","history"],ru:["замок","крепость","история"]},"🏯":{en:["Japanese castle","Asia","samurai"],ru:["японский замок","Азия","самурай"]},"🏟️":{en:["stadium","sports","arena"],ru:["стадион","спорт","арена"]},"🏖️":{en:["beach","sun","vacation"],ru:["пляж","солнце","отпуск"]},"🏝️":{en:["island","tropical","vacation"],ru:["остров","тропический","отпуск"]},"🏜️":{en:["desert","sand","dry"],ru:["пустыня","песок","сухой"]},"🌋":{en:["volcano","eruption","lava"],ru:["вулкан","извержение","лава"]},"⛰️":{en:["mountain","hiking","nature"],ru:["гора","поход","природа"]},"🏔️":{en:["snowy mountain","climbing","cold"],ru:["снежная гора","скалолазание","холод"]},"🗻":{en:["Mount Fuji","Japan","scenic"],ru:["гора Фудзи","Япония","живописный"]},"🏕️":{en:["camping","tent","outdoors"],ru:["кемпинг","палатка","на природе"]},"🏭":{en:["factory","industry","building"],ru:["фабрика","индустрия","здание"]},"🏢":{en:["office building","corporate","city"],ru:["офисное здание","корпоративный","город"]},"🏬":{en:["shopping mall","retail","stores"],ru:["торговый центр","розничная торговля","магазины"]},"🏣":{en:["post office","mail","building"],ru:["почтовое отделение","почта","здание"]},"🏤":{en:["post office","mail","postal service"],ru:["почтовое отделение","почта","почтовая служба"]},"🏥":{en:["hospital","healthcare","emergency"],ru:["больница","здравоохранение","чрезвычайная ситуация"]},"🏦":{en:["bank","money","finance"],ru:["банк","деньги","финансы"]},"🏨":{en:["hotel","accommodation","stay"],ru:["отель","размещение","проживание"]},"🏪":{en:["convenience store","shopping","24/7"],ru:["магазин","шоппинг","круглосуточно"]},"🏫":{en:["school","education","learning"],ru:["школа","образование","обучение"]},"🏩":{en:["love hotel","romantic","Japan"],ru:["любовный отель","романтический","Япония"]},"💒":{en:["wedding","church","marriage"],ru:["свадьба","церковь","брак"]},"⛪":{en:["church","Christianity","religion"],ru:["церковь","христианство","религия"]},"🕌":{en:["mosque","Islam","prayer"],ru:["мечеть","ислам","молитва"]},"🕍":{en:["synagogue","Judaism","religion"],ru:["синагога","иудаизм","религия"]},"🛕":{en:["hindu temple","spiritual","India"],ru:["индуистский храм","духовный","Индия"]},"⛩️":{en:["shrine","torii","Japan"],ru:["святилище","тории","Япония"]},"🏛️":{en:["government building","politics","history"],ru:["правительственное здание","политика","история"]},"📱":{en:["smartphone","mobile","phone"],ru:["смартфон","мобильный","телефон"]},"💻":{en:["laptop","computer","technology"],ru:["ноутбук","компьютер","технология"]},"⌨️":{en:["keyboard","typing","computer"],ru:["клавиатура","набор текста","компьютер"]},"🖥️":{en:["desktop","monitor","screen"],ru:["настольный компьютер","монитор","экран"]},"🖨️":{en:["printer","print","office"],ru:["принтер","печать","офис"]},"🖱️":{en:["mouse","computer","click"],ru:["мышь","компьютер","клик"]},"🖲️":{en:["trackball","navigation","input"],ru:["трекбол","навигация","ввод"]},"🕹️":{en:["joystick","gaming","console"],ru:["джойстик","игры","консоль"]},"🗜️":{en:["clamp","tool","hardware"],ru:["зажим","инструмент","аппаратное обеспечение"]},"💽":{en:["mini disc","storage","media"],ru:["мини-диск","хранение","медиа"]},"💾":{en:["floppy disk","save","data"],ru:["флоппи-диск","сохранить","данные"]},"💿":{en:["CD","compact disc","music"],ru:["CD","компакт-диск","музыка"]},"📀":{en:["DVD","video","disc"],ru:["DVD","видео","диск"]},"📼":{en:["VHS","video cassette","retro"],ru:["VHS","видеокассета","ретро"]},"📷":{en:["camera","photo","photography"],ru:["камера","фото","фотография"]},"📸":{en:["camera flash","photography","snapshot"],ru:["вспышка камеры","фотография","снимок"]},"📹":{en:["video camera","recording","film"],ru:["видеокамера","запись","фильм"]},"🎥":{en:["movie camera","film","cinema"],ru:["кино-камера","фильм","кино"]},"📞":{en:["telephone","call","communication"],ru:["телефон","звонок","коммуникация"]},"☎️":{en:["phone","landline","call"],ru:["телефон","стационарный","звонок"]},"📟":{en:["pager","message","communication"],ru:["пейджер","сообщение","коммуникация"]},"📠":{en:["fax machine","office","document"],ru:["факс","офис","документ"]},"📺":{en:["TV","television","screen"],ru:["телевизор","теле","экран"]},"📻":{en:["radio","broadcast","audio"],ru:["радио","трансляция","аудио"]},"🎙️":{en:["microphone","recording","podcast"],ru:["микрофон","запись","подкаст"]},"🎚️":{en:["control knob","audio","volume"],ru:["ручка управления","аудио","громкость"]},"🎛️":{en:["sliders","equalizer","settings"],ru:["ползунки","эквалайзер","настройки"]},"📡":{en:["satellite dish","broadcast","signal"],ru:["спутниковая антенна","трансляция","сигнал"]},"🔋":{en:["battery","power","energy"],ru:["батарея","мощность","энергия"]},"🔌":{en:["plug","electricity","charging"],ru:["штекер","электричество","зарядка"]},"💡":{en:["light bulb","idea","illumination"],ru:["лампочка","идея","освещение"]},"🔦":{en:["flashlight","torch","light"],ru:["фонарик","фонарь","свет"]},"🕯️":{en:["candle","light","fire"],ru:["свеча","свет","огонь"]},"🧯":{en:["fire extinguisher","safety","fire"],ru:["огнетушитель","безопасность","огонь"]},"🛢️":{en:["barrel","oil","fuel"],ru:["бочка","масло","топливо"]},"💸":{en:["money with wings","cash","spending"],ru:["деньги с крыльями","наличные","расходы"]},"💵":{en:["dollar bills","money","USD"],ru:["долларовые банкноты","деньги","USD"]},"💴":{en:["yen","money","Japan"],ru:["иена","деньги","Япония"]},"💶":{en:["euro","money","currency"],ru:["евро","деньги","валюта"]},"💷":{en:["pound","money","UK"],ru:["фунт","деньги","Великобритания"]},"🪙":{en:["coin","currency","money"],ru:["монета","валюта","деньги"]},"💰":{en:["money bag","wealth","rich"],ru:["мешок с деньгами","богатство","богатый"]},"💳":{en:["credit card","banking","payment"],ru:["кредитная карта","банковское дело","оплата"]},"💎":{en:["gem","diamond","valuable"],ru:["драгоценный камень","бриллиант","ценный"]},"⚖️":{en:["balance scale","justice","law"],ru:["весы","справедливость","закон"]},"🪜":{en:["ladder","climb","height"],ru:["лестница","лазить","высота"]},"🧰":{en:["toolbox","tools","repair"],ru:["ящик с инструментами","инструменты","ремонт"]},"🔧":{en:["wrench","repair","tools"],ru:["гаечный ключ","ремонт","инструменты"]},"🔨":{en:["hammer","build","fix"],ru:["молоток","строить","чинить"]},"⚒️":{en:["hammer and pick","construction","work"],ru:["молот и кирка","строительство","работа"]},"🛠️":{en:["tools","fix","maintenance"],ru:["инструменты","чинить","обслуживание"]},"⛏️":{en:["pickaxe","mining","digging"],ru:["кирка","горное дело","копать"]},"✏️":{en:["pencil","writing","notes"],ru:["карандаш","написание","заметки"]},"🖊️":{en:["pen","writing","signature"],ru:["ручка","написание","подпись"]},"🖋️":{en:["fountain pen","calligraphy","writing"],ru:["перьевая ручка","каллиграфия","написание"]},"✒️":{en:["nib","ink","writing"],ru:["остриё","чернила","написание"]},"🖌️":{en:["paintbrush","art","painting"],ru:["кисть","искусство","живопись"]},"🖍️":{en:["crayon","drawing","color"],ru:["мелки","рисование","цвет"]},"📝":{en:["memo","notes","document"],ru:["заметка","записи","документ"]},"📚":{en:["books","reading","library"],ru:["книги","чтение","библиотека"]},"📖":{en:["open book","reading","story"],ru:["открытая книга","чтение","история"]},"🔖":{en:["bookmark","reading","save"],ru:["закладка","чтение","сохранить"]},"📑":{en:["bookmark tabs","pages","notes"],ru:["закладки","страницы","заметки"]},"🗒️":{en:["spiral notepad","notes","journal"],ru:["спиральный блокнот","записи","журнал"]},"📄":{en:["document","paper","page"],ru:["документ","бумага","страница"]},"📰":{en:["newspaper","news","journalism"],ru:["газета","новости","журналистика"]},"🗞️":{en:["rolled newspaper","press","print"],ru:["свернутая газета","пресса","печатное издание"]},"📁":{en:["file folder","documents","storage"],ru:["папка","документы","хранение"]},"📂":{en:["open folder","organization","files"],ru:["открытая папка","организация","файлы"]},"🗂️":{en:["card index","catalog","records"],ru:["карточный индекс","каталог","записи"]},"🕐":{en:["1 o'clock","clock face","time"],ru:["час","циферблат","время"]},"🕑":{en:["2 o'clock","clock face","time"],ru:["два часа","циферблат","время"]},"🕒":{en:["3 o'clock","clock face","time"],ru:["три часа","циферблат","время"]},"🕓":{en:["4 o'clock","clock face","time"],ru:["четыре часа","циферблат","время"]},"🕔":{en:["5 o'clock","clock face","time"],ru:["пять часов","циферблат","время"]},"🕕":{en:["6 o'clock","clock face","time"],ru:["шесть часов","циферблат","время"]},"🕖":{en:["7 o'clock","clock face","time"],ru:["семь часов","циферблат","время"]},"🕗":{en:["8 o'clock","clock face","time"],ru:["восемь часов","циферблат","время"]},"🕘":{en:["9 o'clock","clock face","time"],ru:["девять часов","циферблат","время"]},"🕙":{en:["10 o'clock","clock face","time"],ru:["десять часов","циферблат","время"]},"🕚":{en:["11 o'clock","clock face","time"],ru:["одиннадцать часов","циферблат","время"]},"🕛":{en:["12 o'clock","clock face","time"],ru:["двенадцать часов","циферблат","время"]},"🕰️":{en:["mantel clock","clock","time"],ru:["настенные часы","часы","время"]},"⏰":{en:["alarm clock","wake up","time"],ru:["будильник","пробуждение","время"]},"⏱️":{en:["stopwatch","timer","time"],ru:["секундомер","таймер","время"]},"⏲️":{en:["kitchen timer","timer","time"],ru:["кухонный таймер","таймер","время"]},"⌚":{en:["watch","smartwatch","time"],ru:["часы","умные часы","время"]},"❤️":{en:["heart","love","affection"],ru:["сердце","любовь","нежность"]},"🧡":{en:["orange heart","warmth","care"],ru:["оранжевое сердце","теплота","забота"]},"💛":{en:["yellow heart","friendship","happiness"],ru:["жёлтое сердце","дружба","счастье"]},"💚":{en:["green heart","envy","nature","eco"],ru:["зелёное сердце","зависть","природа","эко"]},"💙":{en:["blue heart","loyalty","trust"],ru:["синее сердце","верность","доверие"]},"💜":{en:["purple heart","compassion","admiration"],ru:["фиолетовое сердце","сострадание","восхищение"]},"🤎":{en:["brown heart","earth","stability"],ru:["коричневое сердце","земля","устойчивость"]},"🖤":{en:["black heart","mourning","dark"],ru:["чёрное сердце","скорбь","тёмный"]},"🤍":{en:["white heart","pure","peace"],ru:["белое сердце","чистый","мир"]},"💔":{en:["broken heart","sad","heartbreak"],ru:["разбитое сердце","грусть","сердечная боль"]},"❣️":{en:["heart exclamation","love","emotion"],ru:["сердечный восклицательный знак","любовь","эмоция"]},"💕":{en:["two hearts","romance","affection"],ru:["два сердца","романтика","нежность"]},"💞":{en:["revolving hearts","love","relationship"],ru:["вращающиеся сердца","любовь","отношения"]},"💓":{en:["beating heart","emotion","passion"],ru:["бьющееся сердце","эмоция","страсть"]},"💗":{en:["growing heart","love","expanding"],ru:["растущее сердце","любовь","расширяющееся"]},"💖":{en:["sparkling heart","admiration","shine"],ru:["блестящее сердце","восхищение","сияние"]},"💘":{en:["heart with arrow","love","romance"],ru:["сердце со стрелой","любовь","романтика"]},"💝":{en:["heart with ribbon","gift","affection"],ru:["сердце с лентой","подарок","нежность"]},"💟":{en:["heart decoration","symbol","love"],ru:["украшение сердца","символ","любовь"]},"☮️":{en:["peace","pacifism","symbol"],ru:["мир","пацифизм","символ"]},"✝️":{en:["cross","christianity","religion"],ru:["крест","христианство","религия"]},"☪️":{en:["star and crescent","islam","faith"],ru:["звезда и полумесяц","ислам","вера"]},"🕉️":{en:["om","hinduism","spiritual"],ru:["ом","индуизм","духовный"]},"☸️":{en:["dharma wheel","buddhism","karma"],ru:["колесо дхармы","буддизм","карма"]},"✡️":{en:["star of david","judaism","faith"],ru:["звезда Давида","иудаизм","вера"]},"🔯":{en:["hexagram","mystic","spiritual"],ru:["шестиконечная звезда","мистический","духовный"]},"🕎":{en:["menorah","hanukkah","jewish"],ru:["менора","Ханука","еврейский"]},"☯️":{en:["yin yang","balance","harmony"],ru:["инь-ян","баланс","гармония"]},"☦️":{en:["orthodox cross","christianity","faith"],ru:["православный крест","христианство","вера"]},"🛐":{en:["place of worship","religion","faith"],ru:["место поклонения","религия","вера"]},"⛎":{en:["ophiuchus","zodiac","astrology"],ru:["змееносец","зодиак","астрология"]},"⚠️":{en:["warning","caution","alert"],ru:["предупреждение","осторожность","тревога"]},"🚸":{en:["children crossing","school","pedestrian"],ru:["дети на переходе","школа","пешеход"]},"⛔":{en:["no entry","prohibited","restricted"],ru:["вход запрещён","запрещено","ограничено"]},"🚫":{en:["prohibited","no","forbidden"],ru:["запрещено","нет","запрещено"]},"☢️":{en:["radioactive","hazard","danger"],ru:["радиоактивный","опасность","угроза"]},"☣️":{en:["biohazard","toxic","warning"],ru:["биологическая опасность","ядовитый","предупреждение"]},"➕":{en:["plus","addition","math"],ru:["плюс","сложение","математика"]},"➖":{en:["minus","subtraction","math"],ru:["минус","вычитание","математика"]},"➗":{en:["division","divide","math"],ru:["деление","делить","математика"]},"✖️":{en:["multiplication","times","math"],ru:["умножение","раз","математика"]},"♾️":{en:["infinity","limitless","math"],ru:["бесконечность","безграничный","математика"]},"💲":{en:["dollar","money","currency"],ru:["доллар","деньги","валюта"]},"💱":{en:["currency exchange","finance","money"],ru:["обмен валюты","финансы","деньги"]},"⬆️":{en:["up arrow","increase","direction"],ru:["стрелка вверх","увеличение","направление"]},"↗️":{en:["up-right arrow","growth","move"],ru:["стрелка вверх-вправо","рост","движение"]},"➡️":{en:["right arrow","next","forward"],ru:["стрелка вправо","далее","вперёд"]},"↘️":{en:["down-right arrow","decrease","move"],ru:["стрелка вниз-вправо","уменьшение","движение"]},"⬇️":{en:["down arrow","lower","decline"],ru:["стрелка вниз","понижение","снижение"]},"↙️":{en:["down-left arrow","falling","move"],ru:["стрелка вниз-влево","падение","движение"]},"⬅️":{en:["left arrow","back","previous"],ru:["стрелка влево","назад","предыдущий"]},"↖️":{en:["up-left arrow","direction","move"],ru:["стрелка вверх-влево","направление","движение"]},"↕️":{en:["vertical arrows","up down","change"],ru:["вертикальные стрелки","вверх вниз","изменение"]},"↔️":{en:["horizontal arrows","left right","switch"],ru:["горизонтальные стрелки","влево вправо","переключение"]},"↩️":{en:["back arrow","undo","return"],ru:["стрелка назад","отмена","возврат"]},"↪️":{en:["right curved arrow","redirect","turn"],ru:["изогнутая стрелка вправо","перенаправление","поворот"]},"⤴️":{en:["up-right arrow","diagonal","move"],ru:["диагональная стрелка вверх-вправо","диагональ","движение"]},"⤵️":{en:["down-right arrow","diagonal","move"],ru:["диагональная стрелка вниз-вправо","диагональ","движение"]},"🔃":{en:["repeat","cycle","refresh"],ru:["повтор","цикл","обновление"]},"🔄":{en:["counterclockwise arrows","reload","sync"],ru:["стрелки против часовой стрелки","перезагрузка","синхронизация"]},"🔆":{en:["bright","high brightness","sun"],ru:["яркий","высокая яркость","солнце"]},"📶":{en:["signal","network","connection"],ru:["сигнал","сеть","соединение"]},"🎦":{en:["cinema","movies","entertainment"],ru:["кино","фильмы","развлечения"]},"🔅":{en:["dim","low brightness","light"],ru:["тусклый","низкая яркость","свет"]},"♻️":{en:["recycle","eco","sustainability"],ru:["переработка","эко","устойчивость"]},"✅":{en:["check mark","yes","approved"],ru:["галочка","да","одобрено"]},"❌":{en:["cross mark","no","wrong"],ru:["крестик","нет","неправильно"]},"❎":{en:["negative cross","decline","cancel"],ru:["отрицательный крест","отказ","отмена"]},"➰":{en:["curly loop","infinity","twist"],ru:["извилистая петля","бесконечность","скрутка"]},"➿":{en:["double curly loop","loop","repeat"],ru:["двойная извилистая петля","петля","повтор"]},"〽️":{en:["part alternation","music","symbol"],ru:["знак чередования","музыка","символ"]},"✳️":{en:["eight-spoked asterisk","star","highlight"],ru:["восьмиконечная астериска","звезда","акцент"]},"✴️":{en:["eight-pointed star","shine","special"],ru:["восьмиконечная звезда","сияние","особый"]},"❇️":{en:["sparkle","highlight","shine"],ru:["сверкание","акцент","сияние"]},"©️":{en:["copyright","legal","rights"],ru:["авторское право","юридический","права"]},"®️":{en:["registered","trademark","brand"],ru:["зарегистрировано","торговая марка","бренд"]},"™️":{en:["trademark","brand","symbol"],ru:["торговая марка","бренд","символ"]},"🏁":{en:["checkered flag","finish line","racing"],ru:["шашечный флаг","финишная черта","гонки"]},"🚩":{en:["triangular flag","mark","warning"],ru:["треугольный флаг","метка","предупреждение"]},"🎌":{en:["crossed flags","celebration","Japan"],ru:["перекрещённые флаги","празднование","Япония"]},"🏴":{en:["black flag","protest","symbol"],ru:["чёрный флаг","протест","символ"]},"🏳️":{en:["white flag","surrender","peace"],ru:["белый флаг","капитуляция","мир"]},"🏳️‍🌈":{en:["rainbow flag","LGBTQ+","pride"],ru:["радужный флаг","ЛГБТК+","гордость"]},"🏳️‍⚧️":{en:["transgender flag","trans","pride"],ru:["трансгендерный флаг","транс","гордость"]},"🏴‍☠️":{en:["pirate flag","skull","danger"],ru:["пиратский флаг","череп","опасность"]},"🇺🇸":{en:["United States","USA","America"],ru:["Соединённые Штаты","США","Америка"]},"🇬🇧":{en:["United Kingdom","UK","Britain"],ru:["Соединённое Королевство","Великобритания","Британия"]},"🇯🇵":{en:["Japan","Japanese","Asia"],ru:["Япония","японский","Азия"]},"🇰🇷":{en:["South Korea","Korea","Asian"],ru:["Южная Корея","Корея","азиатский"]},"🇩🇪":{en:["Germany","Deutschland","Europe"],ru:["Германия","Германия","Европа"]},"🇨🇳":{en:["China","Chinese","Asia"],ru:["Китай","китайский","Азия"]},"🇧🇷":{en:["Brazil","Brasil","South America"],ru:["Бразилия","Бразилия","Южная Америка"]},"🇮🇳":{en:["India","Indian","Asia"],ru:["Индия","индийский","Азия"]},"🇫🇷":{en:["France","French","Europe"],ru:["Франция","французский","Европа"]},"🇪🇸":{en:["Spain","Spanish","Europe"],ru:["Испания","испанский","Европа"]},"🇮🇹":{en:["Italy","Italian","Europe"],ru:["Италия","итальянский","Европа"]},"🇷🇺":{en:["Russia","Russian","Europe"],ru:["Россия","русский","Европа"]},"🇨🇦":{en:["Canada","Canadian","North America"],ru:["Канада","канадский","Северная Америка"]},"🇦🇺":{en:["Australia","Aussie","Oceania"],ru:["Австралия","австралиец","Океания"]},"🇳🇿":{en:["New Zealand","Kiwi","Oceania"],ru:["Новая Зеландия","киви","Океания"]},"🇲🇽":{en:["Mexico","Mexican","Latin America"],ru:["Мексика","мексиканский","Латинская Америка"]},"🇦🇷":{en:["Argentina","Argentinian","South America"],ru:["Аргентина","аргентинский","Южная Америка"]},"🇵🇰":{en:["Pakistan","Pakistani","Asia"],ru:["Пакистан","пакистанский","Азия"]},"🇪🇬":{en:["Egypt","Egyptian","Africa"],ru:["Египет","египетский","Африка"]},"🇸🇪":{en:["Sweden","Swedish","Europe"],ru:["Швеция","шведский","Европа"]},"🇳🇴":{en:["Norway","Norwegian","Europe"],ru:["Норвегия","норвежский","Европа"]},"🇳🇱":{en:["Netherlands","Dutch","Europe"],ru:["Нидерланды","голландский","Европа"]},"🇨🇭":{en:["Switzerland","Swiss","Europe"],ru:["Швейцария","швейцарский","Европа"]},"🇹🇷":{en:["Turkey","Turkish","Eurasia"],ru:["Турция","турецкий","Евразия"]},"🇮🇩":{en:["Indonesia","Indonesian","Asia"],ru:["Индонезия","индонезийский","Азия"]},"🇸🇬":{en:["Singapore","Singaporean","Asia"],ru:["Сингапур","сингапурский","Азия"]},"🇮🇱":{en:["Israel","Israeli","Middle East"],ru:["Израиль","израильский","Ближний Восток"]},"🇵🇹":{en:["Portugal","Portuguese","Europe"],ru:["Португалия","португальский","Европа"]},"🇵🇱":{en:["Poland","Polish","Europe"],ru:["Польша","польский","Европа"]},"🇹🇭":{en:["Thailand","Thai","Asia"],ru:["Таиланд","тайский","Азия"]}},he={hslToHex(e,t,n){t/=100,n/=100;const o=(1-Math.abs(2*n-1))*t,r=o*(1-Math.abs(e/60%2-1)),a=n-o/2;let i,s,c;return e<60?(i=o,s=r,c=0):e<120?(i=r,s=o,c=0):e<180?(i=0,s=o,c=r):e<240?(i=0,s=r,c=o):e<300?(i=r,s=0,c=o):(i=o,s=0,c=r),i=Math.round(255*(i+a)),s=Math.round(255*(s+a)),c=Math.round(255*(c+a)),"#"+((1<<24)+(i<<16)+(s<<8)+c).toString(16).slice(1)},hexToHSL(e){3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map((e=>e+e)).join(""));const t=parseInt(e.substring(0,2),16)/255,n=parseInt(e.substring(2,4),16)/255,o=parseInt(e.substring(4,6),16)/255,r=Math.max(t,n,o),a=Math.min(t,n,o);let i=0,s=0;const c=(r+a)/2;if(r!==a){const e=r-a;s=c>.5?e/(2-r-a):e/(r+a),i=r===t?60*((n-o)/e+(n<o?6:0)):r===n?60*((o-t)/e+2):60*((t-n)/e+4)}return{h:Math.round(i),s:100*s,l:100*c}},hexToHue(e){return this.hexToHSL(e).h},getLuminance(e){e=e.replace("#","");const t=parseInt(e.slice(0,2),16)/255,n=parseInt(e.slice(2,4),16)/255,o=parseInt(e.slice(4,6),16)/255,r=e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4);return.2126*r(t)+.7152*r(n)+.0722*r(o)},contrastRatio(e,t){const n=this.getLuminance(e),o=this.getLuminance(t);return(Math.max(n,o)+.05)/(Math.min(n,o)+.05)}};function ge(e){const t=e.storageKey||"usernameColors";let n;try{const e=sessionStorage.getItem(t);n=e?JSON.parse(e):{}}catch(e){n={}}const o=e.hueRanges||[{min:0,max:360}],r=o.reduce(((e,t)=>e+(t.max-t.min)),0),a=Boolean(e.saturation),i=Boolean(e.lightness),s=e.minSaturation||40,c=e.maxSaturation||90,l=e.minLightness||55,d=e.maxLightness||80,m=c-s,u=new Set(Object.values(n)),p=new Set;function h(){let e=Math.floor(Math.random()*r);for(let t of o){const n=t.max-t.min;if(e<n)return t.min+e;e-=n}return o[0].min}return Object.values(n).forEach((e=>{try{p.add(he.hexToHue(e))}catch(e){}})),{getColor(o){if(!o){const t=a?parseInt(e.saturation,10):50;let n=i?parseInt(e.lightness,10):50;return he.hslToHex(0,t,n)}const c=o.trim().toLowerCase();let g={};try{const e=localStorage.getItem(t);g=e?JSON.parse(e):{}}catch(e){}if(g[c])return g[c];if(n[c])return n[c];let f=null,b=0;for(;!f&&b<10;){let t;if(p.size>=r)t=h();else do{t=h()}while(p.has(t)&&p.size<r);const n=a?parseInt(e.saturation,10):Math.floor(Math.random()*m)+s;let o;if(i)o=parseInt(e.lightness,10),t>=210&&t<280&&o<65&&(o=65);else{let e=l;t>=210&&t<280&&(e=Math.max(l,65));const n=d-e;o=Math.floor(Math.random()*n)+e}const c=he.hslToHex(t,n,o);if(!u.has(c)){f=c,p.add(t);break}b++}if(!f){const t=h(),n=a?parseInt(e.saturation,10):Math.floor(Math.random()*m)+s;let o;if(i)o=parseInt(e.lightness,10),t>=210&&t<280&&o<65&&(o=65);else{let e=l;t>=210&&t<280&&(e=Math.max(l,65));const n=d-e;o=Math.floor(Math.random()*n)+e}f=he.hslToHex(t,n,o)}return n[c]=f,u.add(f),this.saveColors(),f},saveTimeout:null,saveColors(){this.saveTimeout&&clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout((()=>{try{sessionStorage.setItem(t,JSON.stringify(n))}catch(e){}}),500)}}}const fe=ge({storageKey:"usernameColors",minSaturation:40,maxSaturation:90,minLightness:55,maxLightness:80}),be=ge({storageKey:"mentionColors",saturation:"80",lightness:"60"});let ye=null;function ve(){let e;do{e=z[Math.floor(Math.random()*z.length)]}while(e===ye);return ye=e,e}function we(){const e=document.querySelector("#app-chat-container .chat-wrapper");if(!e)return;const t=document.querySelector("#app-chat-container"),n=e.offsetWidth<=780,o=e.offsetWidth<=380,r=document.querySelector("#app-chat-container .user-list-container"),a=document.querySelectorAll("#app-chat-container .message.system");let i=!1;const s=et();if(r)if(n||s){r.style.position="absolute",r.style.height="100%",r.style.top="0",r.style.right="0",r.style.transition="transform 0.3s ease",r.style.zIndex="1001",r.style.transform="translateX(100%)",a&&a.length>0&&a.forEach((e=>{e.style.setProperty("align-items","start","important")}));let c=document.querySelector("#app-chat-container .reveal-userlist-btn");if(!c){function l(e){r.contains(e.target)||e.target===c||(r.style.transform="translateX(100%)",c.classList.remove("shown-userlist"),c.classList.add("hidden-userlist"),i=!1,document.removeEventListener("click",l,!0))}c=document.createElement("button"),c.className="reveal-userlist-btn hidden-userlist",c.textContent="📋",t.appendChild(c),c.addEventListener("click",(e=>{e.stopPropagation(),i||(r.style.transform="translateX(0)",c.classList.remove("hidden-userlist"),c.classList.add("shown-userlist"),i=!0,setTimeout((()=>{document.addEventListener("click",l,!0)}),10))}))}}else{r.style.position="",r.style.height="",r.style.top="",r.style.right="",r.style.transform="",r.style.zIndex="",a&&a.length>0&&a.forEach((e=>{e.style.removeProperty("align-items")}));const d=document.querySelector("#app-chat-container .reveal-userlist-btn");d&&d.remove()}document.querySelectorAll("#app-chat-container .message").forEach((e=>{const t=e.querySelector(".message-text");e.style.flexDirection=n?"column":"row",e.style.marginBottom=n?"0.8em":"0",t.style.marginTop=n?"0.2em":"0"}));document.querySelectorAll("#app-chat-container .video-container, #app-chat-container .youtube-thumb").forEach((e=>e.style.maxWidth=o?"100%":""))}function ke(e,t,n){return Math.min(Math.max(e,t),n)}function xe(e){return"string"!=typeof e?e:e.replace(/^\d+#/,"")}function Ee(e){if(!e)return null;const t=e.split("/");if(t.length<2)return null;return t[1].split("#")[0]}function Se(e){return e?e.includes("#")?e.split("#")[1]:e.replace(/^\d+#/,""):"Unknown"}function Ce(e,t,n){e&&(e.offsetHeight,e.style.transition="opacity 0.3s ease",e.style.opacity="show"===t?n:"0","hide"===t&&e.addEventListener("transitionend",(()=>{"0"===e.style.opacity&&e.parentNode&&e.parentNode.removeChild(e)}),{once:!0}))}const Le=e=>{try{const{hostname:t}=new URL(e),n=t.toLowerCase().split(".").slice(-2).join(".");return{isTrusted:B.includes(n),domain:n}}catch(t){return console.error("Error in isTrustedDomain:",t.message),{isTrusted:!1,domain:e}}};function je(e){return/^https?:\/\//.test(e)&&/%[0-9A-Fa-f]{2}/.test(e)}function Ie(e){const[t]=e.split("#");return decodeURIComponent(t).replace(/ /g,"_")}const Me="https://github.com/VimiummuimiV/KG_Chat_Application/raw/refs/heads/main/src/sounds/notification-pluck-on.mp3";function Ae(e){const t=new Audio(e);t.volume=1,t.play()}function Te(){const e=document.getElementById("messages-panel");if(!e)return;const t=localStorage.getItem("klavoauth");let n="";try{if(t){const e=JSON.parse(t);e&&e.username&&(n=Se(e.username))}}catch(e){console.error("Error parsing auth data:",e)}if(!n)return;const o=[n],r=new WeakSet;e.querySelectorAll(".message-text:not(.processed-for-mention)").forEach((e=>{const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>{if(r.has(e))return NodeFilter.FILTER_SKIP;return e.parentElement.closest(".mention, .time, .username")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}}),n=[];let a;for(;a=t.nextNode();)n.push(a);n.length>0&&(n.forEach((e=>{r.has(e)||(!function(e,t){const n=/(@?[\wа-яА-ЯёЁ'-]+)|[\s]+|[^@\s\wа-яА-ЯёЁ'-]+/gu,o=e.textContent.match(n)||[],r=document.createDocumentFragment();o.forEach((e=>{if(t.some((t=>0===t.localeCompare(e,void 0,{sensitivity:"accent"})))){const t=document.createElement("span");t.className="mention",e.split("").forEach((e=>{const n=document.createElement("span");n.style.color=be.getColor(e),n.textContent=e,t.appendChild(n)})),r.appendChild(t)}else r.appendChild(document.createTextNode(e))})),e.parentNode.replaceChild(r,e)}(e,o),r.add(e))})),e.classList.add("processed-for-mention"))}))}function $e(e){const t=document.getElementById("messages-panel");if(!t)return;t.scrollHeight-t.scrollTop-t.clientHeight<=e&&(t.scrollTop=t.scrollHeight)}function Ne(e,t={}){const n=document.querySelector(".chat-drag-area");if(!n)return;const o=n.querySelector(".chat-dynamic-alert");o&&o.parentNode===n&&n.removeChild(o);const r={type:"info",duration:3e3,...t},a={info:"#2196F3",warning:"#FF9800",error:"#F44336",success:"#4CAF50"},i=document.createElement("div");i.className="chat-dynamic-alert",i.innerHTML=e,i.style.cssText=`\n    position: absolute;\n    white-space: nowrap;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    color: ${a[r.type]||a.info};\n    padding: 5px 10px;\n    border-radius: 3px;\n    z-index: 1000;\n    font-family: "Montserrat", sans-serif;\n    font-size: 10px;\n    font-weight: 500;\n    opacity: 0;\n  `,n.appendChild(i),requestAnimationFrame((()=>{i.style.transition="all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55)",i.style.opacity="1",i.style.transform="translate(-50%, -50%)",setTimeout((()=>{i.style.transition="transform 0.05s ease-in-out",[{x:5,delay:0},{x:-7,delay:50},{x:9,delay:100},{x:-6,delay:150},{x:4,delay:200},{x:-3,delay:250},{x:0,delay:300}].forEach((e=>{setTimeout((()=>{i.style.transform=`translate(calc(-50% + ${e.x}px), -50%)`}),e.delay)}))}),300),setTimeout((()=>{i.style.transition="opacity 0.3s ease-in-out",i.style.opacity="0",setTimeout((()=>{i&&i.parentNode===n&&n.removeChild(i)}),300)}),r.duration)}))}function Pe(){const e=document.getElementById("app-chat-container"),t=document.getElementById("message-input");return!(!t||!e||"none"===e.style.display)&&(t.focus(),!0)}async function ze(e){const t=`https://klavogonki.ru/api/profile/search-users?query=${encodeURIComponent(e)}`;try{const n=await async function(e){const t=await fetch(e);if(!t.ok)throw new Error(`Failed to fetch ${e}`);return t.json()}(t);if(!n.all?.length)throw new Error(`User ${e} not found.`);const o=n.all.find((t=>t.login===e));if(!o)throw new Error(`Exact match for user ${e} not found.`);return o.id}catch(t){return Ne(`Could not find user "${e}"`,{type:"error",duration:5e3}),null}}const Be={isPrivateMode:!1,targetUsername:null,targetId:null,fullJid:null,async setPrivateTarget(e){if(!e)return this.exitPrivateMode(),!1;try{const t=await ze(e);return!!t&&(this.isPrivateMode=!0,this.targetUsername=e,this.targetId=t,this.fullJid=`${t}#${e}@jabber.klavogonki.ru/web`,!0)}catch(e){return console.error("Error setting private target:",e),!1}},exitPrivateMode(){this.isPrivateMode=!1,this.targetUsername=null,this.targetId=null,this.fullJid=null}};let qe=null;function He(e){"Escape"===e.key&&Be.isPrivateMode&&Re()}async function De(e){if(!e)return;const t=e.value,n=/^\/pm\s+([\wа-яА-ЯёЁ\-\.\_\+]+)\s/,o=t.match(n);if(o){const r=o[1];await Be.setPrivateTarget(r)?(!function(e){const t=document.getElementById("message-input");Be.isPrivateMode&&Be.targetUsername!==e&&Re();if(t.classList.contains("private-mode")&&Be.targetUsername===e)Be.targetUsername===e&&(t.placeholder=`️PM to ➡ ${e}`,Ne(`Private chat with ${e} activated`,{type:"warning",duration:3e3}));else{t.classList.add("private-mode"),t.placeholder=`PM to ➡ ${e}`;let n=document.querySelector(".private-mode-exit");if(!n){n=document.createElement("span"),n.className="button private-mode-exit",n.addEventListener("click",(()=>{Re(),t.focus()}));t.parentElement.insertBefore(n,t.nextSibling)}n.innerHTML="🔒",n.title="Exit private mode",n.addEventListener("mouseenter",(()=>{n.innerHTML="🔓"})),n.addEventListener("mouseleave",(()=>{n.innerHTML="🔒"})),Ne(`Private chat with ${e} activated`,{type:"warning",duration:3e3}),Be.isPrivateMode=!0,Be.targetUsername=e,qe||(qe=He,document.addEventListener("keydown",qe))}}(r),e.value=t.replace(n,"")):(Ne(`Could not find user "${r}"`,{type:"error",duration:3e3}),Re())}else/^\/exit\s*$/.test(t)&&(Re(),e.value="")}function Re(){const e=document.getElementById("message-input");if(e.classList.contains("private-mode")){e.classList.remove("private-mode"),e.placeholder="";const t=document.querySelector(".private-mode-exit");t&&t.remove(),Be.exitPrivateMode(),Ne("Exited private chat mode",{type:"success",duration:3e3}),qe&&(document.removeEventListener("keydown",qe),qe=null)}}function _e(e){return new Promise((t=>setTimeout(t,e)))}let Ue=null,Oe=null,Je=null;const Fe=document.createElement("canvas").getContext("2d");let Ke,Xe=!1,Ye=0;function We(e){let t=e>Ye?`${e} ➡`:e<Ye?`⬅ ${e}`:`${e}`;Je.textContent=t,function(e){if(!Je)return void console.error("lengthPopup is not defined");let t,n=100,o=50;0===e?(t=200,n=20,o=50):t=e<=90?120:e<=100?120-(e-90)/10*60:e<=190?60:e<=200?60-(e-190)/10*20:e<=250?40:e<=300?40-(e-250)/50*40:0;const r=`hsl(${t}, ${n}%, ${o}%)`,a=`hsl(${t}, ${n}%, ${Math.max(o-(e>250?35:30),8)}%)`,i=`hsla(${t}, ${n}%, ${o}%, 0.1)`;Je.style.setProperty("color",r,"important"),Je.style.setProperty("background-color",a,"important"),Je.style.setProperty("border",`1px solid ${i}`,"important"),Je.style.setProperty("border-radius","0.4em","important")}(e),Ye=e}function Ve(e){Xe!==e&&(Je.classList.toggle("bounce-in",e),Je.classList.toggle("bounce-out",!e),Xe=e,e||setTimeout((()=>Je.classList.remove("bounce-out")),500))}function Ge(){clearTimeout(Ke),We(Ue.value.length),function(e){if(!Ue)return void console.error("chatField is not set.");const t=getComputedStyle(Ue);Fe.font=`${t.fontWeight} ${t.fontSize} ${t.fontFamily}`;const n=Fe.measureText(e).width,o=Ue.offsetLeft+n+5,r=Ue.offsetLeft+Ue.offsetWidth-Je.offsetWidth;Je.style.left=`${Math.min(o,r)}px`}(Ue.value),Ve(!0),Ke=setTimeout((()=>Ve(!1)),1e3)}function Qe(e){"Enter"===e.key&&(We(0),Object.assign(Je.style,{left:"0px",color:"hsl(200, 20%, 50%)"}),Ve(!0),Ke=setTimeout((()=>Ve(!1)),1e3))}function Ze(e){return e.replace(/\n/g,"").replace(/\s+/g," ").replace(/>\s+</g,"><").trim()}function et(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||"ontouchstart"in window}function tt(e){const t=e.querySelector(".new-messages-separator");t&&t.remove()}const nt=(e,t)=>{let n;return function(...o){clearTimeout(n),n=setTimeout((()=>e.apply(this,o)),t)}};function ot(){return window.getSelection().toString().length>0}class rt{constructor({username:e,password:t,bindUrl:n,delay:o=100}){this.username=e,this.password=t,this.bindUrl=n,this.delay=o,this.sid=null,this.rid=Math.floor(Date.now()/1e3)}nextRid(){return++this.rid}async sendRequest(e){const t=await fetch(this.bindUrl,{method:"POST",headers:{"Content-Type":"text/xml; charset=UTF-8","User-Agent":"Mozilla/5.0"},body:e});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.text()}async sendRequestWithRetry(e,t=5){let n,o=this.delay;for(let r=1;r<=t;r++)try{return await this.sendRequest(e)}catch(e){if(n=e,!e.message.includes("429"))throw e;{const e=o*Math.pow(2,r);console.log(`⏱️ Rate limited (attempt ${r}/${t}). Waiting ${e}ms...`),await _e(e)}}throw new Error(`Max retries reached. Last error: ${n.message}`)}async connect(){console.log("🌐 Step 1: Connecting to XMPP server...");const e=`<body xmlns='http://jabber.org/protocol/httpbind'\n               rid='${this.nextRid()}'\n               to='jabber.klavogonki.ru'\n               xml:lang='en'\n               wait='60'\n               hold='1'\n               ver='1.6'\n               xmpp:version='1.0'\n               xmlns:xmpp='urn:xmpp:xbosh'/>`,t=await this.sendRequestWithRetry(e);this.sid=t.match(/sid=['"]([^'"]+)['"]/)[1],console.log(`🔑 Step 2: Session ID received: ${this.sid}`),await _e(this.delay),console.log("🔐 Step 3: Authenticating...");const n=function(e){const t=(new TextEncoder).encode(e);return btoa(String.fromCharCode(...t))}("\0"+this.username+"\0"+this.password),o=`<body rid='${this.nextRid()}' sid='${this.sid}'\n               xmlns='http://jabber.org/protocol/httpbind'>\n          <auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>${n}</auth>\n        </body>`;if(!(await this.sendRequestWithRetry(o)).includes("<success"))throw new Error("❌ Authentication failed");console.log("✅ Step 4: Authentication successful!"),await _e(this.delay),console.log("🔄 Step 5: Restarting stream...");const r=`<body rid='${this.nextRid()}' sid='${this.sid}'\n               xmlns='http://jabber.org/protocol/httpbind'\n               to='jabber.klavogonki.ru'\n               xmpp:restart='true'\n               xmlns:xmpp='urn:xmpp:xbosh'/>`;await this.sendRequestWithRetry(r),await _e(this.delay),console.log("📦 Step 6: Binding resource...");const a=`<body rid='${this.nextRid()}' sid='${this.sid}'\n               xmlns='http://jabber.org/protocol/httpbind'>\n          <iq type='set' id='bind_1' xmlns='jabber:client'>\n            <bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'>\n              <resource>web</resource>\n            </bind>\n          </iq>\n        </body>`;await this.sendRequestWithRetry(a),await _e(this.delay),console.log("🔌 Step 7: Establishing session...");const i=`<body rid='${this.nextRid()}' sid='${this.sid}'\n               xmlns='http://jabber.org/protocol/httpbind'>\n          <iq type='set' id='session_1' xmlns='jabber:client'>\n            <session xmlns='urn:ietf:params:xml:ns:xmpp-session'/>\n          </iq>\n        </body>`;return await this.sendRequestWithRetry(i),await _e(this.delay),{sid:this.sid,rid:this.rid}}}const at=()=>{try{const e=localStorage.getItem("ignored");return e?JSON.parse(e):[]}catch(e){return console.error("Error parsing ignored users data:",e),[]}},it=e=>{try{return localStorage.setItem("ignored",JSON.stringify(e)),!0}catch(e){return console.error("Error saving ignored users data:",e),!1}},st=(e,t,n={})=>{const o=document.createElement(e);return t&&(o.className=t),Object.entries(n).forEach((([e,t])=>{"text"===e?o.textContent=t:o.setAttribute(e,t)})),o},ct=()=>{const e=document.querySelector(".ignored-users-panel");if(e)return e;const t=at(),n=st("div","ignored-users-panel",{html:"<h2>Ignored Users</h2>"}),o=st("div","ignored-users-list");n.appendChild(o);const r=st("div","ignored-users-input-container"),a=st("input","ignored-users-input",{type:"search",placeholder:"Enter username to ignore"}),i=st("button","ignored-users-add-btn",{text:"Add"}),s=async()=>{const e=a.value.trim();if(e&&!t.includes(e)){if(!await ze(e))return Ne(`Could not find user "${e}"`,{type:"error",duration:2e3}),a.classList.add("input-error"),void setTimeout((()=>a.classList.remove("input-error")),500);if(t.push(e),it(t),Ne(`Added "${e}" to the ignore list`,{type:"success",duration:2e3}),!o.querySelector(`.user-label[text="${e}"]`)){const t=c(e);o.appendChild(t)}a.value="",(e=>{if(!e||"string"!=typeof e)return void console.warn("Invalid username provided to purgeUserFromChat");const t=document.querySelector(".messages-panel"),n=document.getElementById("user-list");t&&t.querySelectorAll(".message").forEach((t=>{const n=t.querySelector(".username")?.textContent;n===e&&t.remove()}));n&&n.querySelectorAll(".user-item").forEach((t=>{const n=t.querySelector(".username")?.textContent;n===e&&t.remove()}))})(e)}};i.addEventListener("click",s),a.addEventListener("keypress",(e=>{"Enter"===e.key&&s()})),r.append(a,i),n.insertBefore(r,o);const c=e=>{const n=st("div","ignored-user-entry"),o=st("div","user-label",{text:e}),r=st("button","remove-btn"),a=document.createElementNS("http://www.w3.org/2000/svg","svg");return a.setAttribute("viewBox","0 0 24 24"),a.setAttribute("width","12"),a.setAttribute("height","12"),a.setAttribute("fill","none"),a.setAttribute("stroke","currentColor"),a.setAttribute("stroke-width","2"),a.setAttribute("stroke-linecap","round"),a.setAttribute("stroke-linejoin","round"),a.classList.add("remove-icon"),["M18 6L6 18","M6 6L18 18"].forEach((e=>{const t=document.createElementNS("http://www.w3.org/2000/svg","path");t.setAttribute("d",e),a.appendChild(t)})),r.appendChild(a),r.addEventListener("click",(()=>{const o=t.filter((t=>t!==e));it(o),t.splice(t.indexOf(e),1),n.remove()})),n.append(o,r),n};t.forEach((e=>{const t=c(e);o.appendChild(t)})),document.body.appendChild(n),Ce(n,"show",1);const l=e=>{"Escape"===e.key&&(Ce(n,"hide",0),document.removeEventListener("keydown",l))};a.focus(),document.addEventListener("keydown",l);const d=e=>{n.contains(e.target)||(Ce(n,"hide",0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",l))};return document.addEventListener("click",d,!0),n};let lt=null;const dt=e=>{let t=document.querySelector(".profile-iframe-container");t||(t=document.createElement("iframe"),t.classList.add("profile-iframe-container"),document.body.appendChild(t)),t.src=e,Ce(t,"show",1);const n=()=>{Ce(t,"hide",0),document.removeEventListener("keydown",o),document.removeEventListener("mousedown",o)},o=e=>{if("keydown"===e.type&&"Space"===e.code){if(lt)return void e.stopPropagation();e.preventDefault(),n()}if("mousedown"===e.type){const o=e.target.classList.contains("username");t.contains(e.target)||o||n()}};document.addEventListener("keydown",o),document.addEventListener("mousedown",o),t.onload=()=>{try{const e=t.contentWindow,r=e.document;r.addEventListener("focusin",(e=>{"TEXTAREA"===e.target.tagName&&(lt=e.target)})),r.addEventListener("focusout",(()=>{setTimeout((()=>{r.activeElement&&"TEXTAREA"===r.activeElement.tagName||(lt=null)}),0)})),e.addEventListener("keydown",o),e.addEventListener("dblclick",n),new MutationObserver(((e,t)=>{e.some((e=>[...e.removedNodes].some((e=>1===e.nodeType&&(e.classList.contains("dimming-background")||e.classList.contains("cached-users-panel"))))))&&(n(),t.disconnect())})).observe(document.body,{childList:!0,subtree:!0})}catch(e){console.warn("Unable to access iframe contents:",e)}}},mt=()=>`rand=${Date.now()}`;class ut{constructor(e="user-list"){this.container=document.getElementById(e),this.activeUsers=new Map,this.isFirstLoad=!0,this.avatarCache=this.loadAvatarCache(),this.cacheDate=(new Date).toDateString(),this.changes=!1,this.pendingUserJIDs=new Set,this.updatedUserJIDs=new Set,this.updateUITimeout=null,this.roleIcons={visitor:"🚫",participant:"",moderator:"⚔️️"},this.rolePriority={moderator:1,participant:2,visitor:3},this.setupEventListeners()}loadAvatarCache(){try{const e=localStorage.getItem("userAvatarCache");if(e){const t=JSON.parse(e);return t.date===(new Date).toDateString()?(console.log("🗃️ Loaded avatar cache from localStorage"),t.avatars||{}):(console.log("🗃️ Avatar cache expired (new day), creating fresh cache"),{})}}catch(e){console.error("Error loading avatar cache:",e)}return{}}saveAvatarCache(){try{localStorage.setItem("userAvatarCache",JSON.stringify({date:this.cacheDate,avatars:this.avatarCache}))}catch(e){console.error("Error saving avatar cache:",e)}}updateAvatarCache(e,t,n,o){const r=this.avatarCache[e];if(!r||r.hasAvatar!==t){this.avatarCache[e]={hasAvatar:t,...t?{avatarUrl:n}:{emoji:n}};const r=t?"🖼️":"😊",a=t?"avatar":"emoji";return console.log(`${r} Set ${a} for [${o}] (${e}):`,n),this.saveAvatarCache(),!0}return!1}handlePrivateMode(e){const t=document.getElementById("message-input");t.value=`/pm ${e} `,De(t),t.focus()}setupLongPressEvent(e,t){let n,o=!1;const r=(e,r)=>{if(e.target.classList.contains("username")){o=!1;const a=()=>{clearTimeout(n)};n=setTimeout((()=>{o=!0,t(e.target)}),300);("mouse"===r?["mouseup","mouseleave"]:["touchend","touchmove"]).forEach((t=>{e.target.addEventListener(t,a,{once:!0})}))}};return e.addEventListener("mousedown",(e=>r(e,"mouse"))),e.addEventListener("touchstart",(e=>r(e,"touch"))),()=>o}setupEventListeners(){const e=this.setupLongPressEvent(this.container,(e=>{const t=e.textContent.trim();this.handlePrivateMode(t)}));this.container.addEventListener("click",(t=>{if(t.target.classList.contains("username")){const n=t.target.getAttribute("data-user-id");if(n){const o=t.target.textContent.trim();if(t.ctrlKey)this.handlePrivateMode(o);else if(!e()){const e=n.split("/")[1].split("#")[0];dt(`https://klavogonki.ru/u/#/${e}/`)}}}if(t.target.closest(".game-indicator")){const e=t.target.closest(".game-indicator").getAttribute("data-game-id");e&&(t.stopPropagation(),window.location.href=`https://klavogonki.ru/g/?gmid=${e}`)}}))}async updatePresence(e){const t=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("presence");if(e.includes('<presence id="initialChatLoad"'))return console.log("🔄 Initial room join detected, requesting full roster"),void this.requestFullRoster();this.changes=!1,this.updatedUserJIDs.clear();for(let e=0;e<t.length;e++){const n=t[e],o=n.getAttribute("from"),r=n.getAttribute("type");if(!o||!o.includes("general@conference.jabber.klavogonki.ru/"))continue;const a=o.split("/").pop();if(!a)continue;if("клавобот"===a.toLowerCase()||o.toLowerCase().includes("#клавобот"))continue;if("unavailable"===r){if(this.activeUsers.has(o)){const e=this.activeUsers.get(o);Ee(o),Se(e.login);this.isFirstLoad,this.activeUsers.delete(o),this.changes=!0}continue}const i=this.activeUsers.get(o)||{},s=Ee(o),c=this.avatarCache[s];let l={jid:o,login:a,color:q,usernameColor:fe.getColor(Se(a)),role:"participant",gameId:null,avatar:null};const d=n.getElementsByTagName("x");let m=!1;Array.from(d).forEach((e=>{const t=e.getAttribute("xmlns");if("klavogonki:userdata"===t){const t=e.getElementsByTagName("user")[0];if(t){const e=t.getElementsByTagName("login")[0];e&&e.textContent&&(l.login=e.textContent,l.usernameColor=fe.getColor(Se(l.login)));const n=t.getElementsByTagName("avatar")[0];n&&n.textContent&&(l.avatar=n.textContent,m=!0);const o=t.getElementsByTagName("moderator")[0];o&&"1"===o.textContent&&(l.role="moderator")}const n=e.getElementsByTagName("game_id")[0];n&&n.textContent&&(l.gameId=n.textContent)}if("http://jabber.org/protocol/muc#user"===t){const t=e.getElementsByTagName("item")[0];if(t){const e=t.getAttribute("role");e&&"moderator"!==l.role&&(l.role=e)}}})),!m&&i&&i.avatar&&(l.avatar=i.avatar),!l.avatar&&c&&c.hasAvatar&&(l.avatar=c.avatarUrl);Se(l.login);this.activeUsers.has(o)?JSON.stringify(i)!==JSON.stringify(l)&&(this.activeUsers.set(o,l),this.changes=!0,this.updatedUserJIDs.add(o)):(this.isFirstLoad,this.activeUsers.set(o,l),this.changes=!0,this.pendingUserJIDs.add(o))}this.changes&&(this.isFirstLoad?(this.updateUI(),this.pendingUserJIDs.clear()):(this.updateUITimeout&&clearTimeout(this.updateUITimeout),this.updateUITimeout=setTimeout((()=>{this.updateUI(),this.updateUITimeout=null,this.pendingUserJIDs.clear()}),300)))}updateUI(){const e=at(),t=new Map;this.container.querySelectorAll(".user-item").forEach((e=>{t.set(e.getAttribute("data-jid"),e)}));const n=Array.from(this.activeUsers.values()).filter((t=>{const n=Se(t.login);return!e.includes(n)})).sort(((e,t)=>{const n=this.rolePriority[e.role]-this.rolePriority[t.role];return 0!==n?n:Se(e.login).localeCompare(Se(t.login))})),o=document.createDocumentFragment();n.forEach((e=>{let n=t.get(e.jid);const r=Ee(e.jid),a=Se(e.login);if(n){if(!n.querySelector(".avatar-container")){const t=document.createElement("span");t.className="avatar-container",this.setUserAvatar(t,e,r,a),n.insertBefore(t,n.firstChild)}t.delete(e.jid);const o=n.querySelector(".role"),i=this.roleIcons[e.role];o&&o.textContent!==i&&(o.textContent=i,o.classList.contains(e.role)||(o.className=`role ${e.role}`));const s=n.querySelector(".username");s&&s.style.color!==e.usernameColor&&(s.style.color=e.usernameColor)}else{n=document.createElement("div"),n.classList.add("user-item"),n.setAttribute("data-jid",e.jid);const t=this.roleIcons[e.role],o=document.createElement("span");o.className="avatar-container",this.setUserAvatar(o,e,r,a);const i=document.createElement("div");i.className="user-info",i.innerHTML=`\n          <span class="username" style="color: ${e.usernameColor}" data-user-id="${e.jid}">${a}</span>\n          <span class="role ${e.role}">${t}</span>\n        `,n.appendChild(o),n.appendChild(i)}this.updateGameIndicator(n,e),o.appendChild(n)})),this.container.innerHTML="",this.container.appendChild(o),t.forEach((e=>{e&&e.parentNode&&e.remove()})),this.isFirstLoad||this.pendingUserJIDs.forEach((e=>{const t=this.container.querySelector(`.user-item[data-jid="${e}"]`);t&&t.parentNode&&me(t)})),this.isFirstLoad&&(this.isFirstLoad=!1)}setUserAvatar(e,t,n,o){const r=this.avatarCache[n];if(t.avatar){const t=r?.avatarUrl||`${T}/storage/avatars/${n}_big.png?${mt()}`,a=document.createElement("img");a.className="user-avatar image-avatar",a.src=t,a.alt=`${o}'s avatar`,a.addEventListener("error",(()=>{const t=r?.emoji||ve();e.innerHTML="";const a=document.createElement("span");a.className="user-avatar svg-avatar",a.textContent=t,e.appendChild(a),this.updateAvatarCache(n,!1,t,o)})),a.addEventListener("load",(()=>{this.updateAvatarCache(n,!0,t,o)})),e.appendChild(a)}else if(r)if(r.hasAvatar){const t=document.createElement("img");t.className="user-avatar image-avatar",t.src=r.avatarUrl,t.alt=`${o}'s avatar`,t.addEventListener("error",(()=>{const t=ve();e.innerHTML="";const r=document.createElement("span");r.className="user-avatar svg-avatar",r.textContent=t,e.appendChild(r),this.updateAvatarCache(n,!1,t,o)})),e.appendChild(t)}else{const t=document.createElement("span");t.className="user-avatar svg-avatar",t.textContent=r.emoji,e.appendChild(t)}else{const t=`${T}/storage/avatars/${n}_big.png?${mt()}`,r=document.createElement("img");r.className="user-avatar image-avatar",r.src=t,r.alt=`${o}'s avatar`,r.addEventListener("error",(()=>{const t=ve();e.innerHTML="";const r=document.createElement("span");r.className="user-avatar svg-avatar",r.textContent=t,e.appendChild(r),this.updateAvatarCache(n,!1,t,o)})),r.addEventListener("load",(()=>{this.updateAvatarCache(n,!0,t,o)})),e.appendChild(r)}}updateGameIndicator(e,t){let n=e.querySelector(".game-indicator");if(t.gameId){if(!n||n.getAttribute("data-game-id")!==t.gameId){const o=`<span class="game-indicator" title="${t.gameId}" data-game-id="${t.gameId}">\n                                    <span class="traffic-icon">🚦</span>\n                                  </span>`;if(n)n.outerHTML=o;else{e.querySelector(".user-info").insertAdjacentHTML("beforeend",o)}}}else n&&n.parentNode&&n.remove()}async requestFullRoster(){console.log("📑 Would request full roster here (using existing data for now)"),this.updateUI()}}class pt{constructor(){this.selected=new Set,this.isDragging=!1,this.toggleBtn=null,this.longPressTimer=null,this.longPressDuration=500,this.touchStartX=0,this.touchStartY=0,this.isMobile=et(),this.init()}init(){this.attachEvents(),this.updateDeletedMessages(),this.renderToggle()}attachEvents(){document.addEventListener("mousedown",(e=>{const t=e.target.closest(".messages-panel .message");t&&2===e.button&&t&&this.handleSelection(e.target,t,e.ctrlKey)})),document.addEventListener("mouseup",(()=>this.isDragging=!1)),document.addEventListener("mousemove",(e=>{if(!this.isDragging)return;const t=e.target.closest(".messages-panel .message");t&&this.toggleSelect(t,!0,"message-mode")})),document.addEventListener("contextmenu",(e=>{const t=e.target.closest(".messages-panel .message");t&&(ot()||(e.preventDefault(),this.showDeleteButton(e,t)))})),this.isMobile&&(document.addEventListener("touchstart",(e=>{const t=e.target.closest(".messages-panel .message");t&&(this.touchStartX=e.touches[0].clientX,this.touchStartY=e.touches[0].clientY,this.longPressTimer=setTimeout((()=>{this.handleSelection(e.target,t,!1),this.showDeleteButton({clientX:this.touchStartX,clientY:this.touchStartY,preventDefault:()=>{}},t),navigator.vibrate&&navigator.vibrate(50)}),this.longPressDuration))})),document.addEventListener("touchmove",(e=>{this.isDragging&&e.preventDefault();const t=e.touches[0].clientX,n=e.touches[0].clientY,o=Math.abs(t-this.touchStartX),r=Math.abs(n-this.touchStartY);(o>10||r>10)&&this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)}),{passive:!1}),document.addEventListener("touchend",(()=>{this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=null)})))}handleSelection(e,t,n){if(ot())return;const o=e.closest(".time"),r=e.closest(".username");o?this.handleTimeSelection(t,n):r?this.handleUsernameSelection(r):(this.isDragging=!0,this.toggleSelect(t,!0,"message-mode"))}handleTimeSelection(e,t){const n=Array.from(document.querySelectorAll(".messages-panel .message")),o=n.indexOf(e);if(-1!==o)if(t)n.slice(o).forEach((e=>{this.toggleSelect(e,!0,"time-mode"),e.classList.add("time-mode")}));else{const t=e.querySelector(".username");if(!t)return;const r=t.textContent.trim();n.slice(o).forEach((e=>{const t=e.querySelector(".username");t&&t.textContent.trim()===r&&(this.toggleSelect(e,!0,"time-mode"),e.classList.add("time-mode"))}))}}handleUsernameSelection(e){const t=e.textContent.trim();document.querySelectorAll(".messages-panel .message").forEach((e=>{const n=e.querySelector(".username");n&&n.textContent.trim()===t&&(this.toggleSelect(e,!0,"username-mode"),e.classList.add("username-mode"))}))}toggleSelect(e,t,n="message-mode"){if(!e)return;e.classList.toggle("selected-message",t),t?"message-mode"===n&&e.classList.add("message-mode"):e.classList.remove("username-mode","time-mode","message-mode");const o=ht(e);t?this.selected.add(o):this.selected.delete(o)}showDeleteButton(e,t){if(ot())return;const n=document.querySelector(".delete-btn");n&&n.remove();const o=document.createElement("button");o.className="delete-btn",this.isMobile&&o.classList.add("mobile-delete-btn"),o.textContent="Delete",o.addEventListener("touchstart",(e=>{e.stopPropagation()})),document.body.append(o);const{offsetWidth:r,offsetHeight:a}=o;if(o.remove(),Object.assign(o.style,{position:"fixed",top:e.clientY-a/2+"px",left:e.clientX-r/2+"px"}),o.onclick=()=>this.deleteSelectedMessages(o),this.isMobile){const e=t=>{o.contains(t.target)||(this.clearSelection(),o.remove(),document.removeEventListener("touchstart",e))};document.addEventListener("touchstart",e),o.outsideTapHandler=e}let i;o.addEventListener("mouseenter",(()=>{i&&clearTimeout(i)})),o.addEventListener("mouseleave",(()=>{i=setTimeout((()=>{o.remove(),this.clearSelection()}),1e3)})),document.body.append(o)}deleteSelectedMessages(e){document.querySelectorAll(".selected-message").forEach((e=>{e&&(e.classList.remove("selected-message","username-mode","time-mode","message-mode"),0===e.classList.length&&e.removeAttribute("class"))})),this.storeDeleted([...this.selected]),e.remove(),this.isMobile&&e.outsideTapHandler&&document.removeEventListener("touchstart",e.outsideTapHandler),this.selected.clear(),this.updateDeletedMessages(),this.renderToggle()}clearSelection(){document.querySelectorAll(".selected-message").forEach((e=>{e&&(e.classList.remove("selected-message","username-mode","time-mode","message-mode"),0===e.classList.length&&e.removeAttribute("class"))})),this.selected.clear()}storeDeleted(e){const t=new Set(JSON.parse(localStorage.getItem("deletedChatMessagesContent")||"[]"));e.forEach((e=>t.add(e))),localStorage.setItem("deletedChatMessagesContent",JSON.stringify([...t]))}updateDeletedMessages(){const e=new Set(JSON.parse(localStorage.getItem("deletedChatMessagesContent")||"[]")),t=document.querySelectorAll(".messages-panel .message");0!==t.length&&(t.forEach((t=>{if(!t)return;const n=ht(t);t.classList.remove("shown-message"),t.classList.toggle("hidden-message",e.has(n))})),localStorage.setItem("deletedChatMessagesContent",JSON.stringify([...e])))}renderToggle(){if(!(JSON.parse(localStorage.getItem("deletedChatMessagesContent")||"[]").length>0))return void(this.toggleBtn&&(this.toggleBtn.remove(),this.toggleBtn=null));const e=document.querySelector(".messages-panel");if(e&&!this.toggleBtn){if(this.toggleBtn=document.createElement("button"),this.toggleBtn.className="toggle-button toggle-hidden",this.toggleBtn.textContent="Show",this.toggleBtn.onclick=e=>{if(e.ctrlKey)return void this.restoreAllMessages();const t="Show"===this.toggleBtn.textContent,n=JSON.parse(localStorage.getItem("deletedChatMessagesContent")||"[]");document.querySelectorAll(".messages-panel .message").forEach((e=>{if(!e)return;const o=ht(e);n.includes(o)&&(e.classList.toggle("hidden-message",!t),e.classList.toggle("shown-message",t))})),t?(this.toggleBtn.textContent="Hide",this.toggleBtn.classList.remove("toggle-hidden"),this.toggleBtn.classList.add("toggle-shown")):(this.toggleBtn.textContent="Show",this.toggleBtn.classList.remove("toggle-shown"),this.toggleBtn.classList.add("toggle-hidden"))},this.isMobile){let e,t=!1;this.toggleBtn.addEventListener("touchstart",(n=>{this.touchStartX=n.touches[0].clientX,this.touchStartY=n.touches[0].clientY,t=!1,e=setTimeout((()=>{t=!0,this.restoreAllMessages(),navigator.vibrate&&navigator.vibrate(50)}),this.longPressDuration)})),this.toggleBtn.addEventListener("touchmove",(t=>{const n=t.touches[0].clientX,o=t.touches[0].clientY,r=Math.abs(n-this.touchStartX),a=Math.abs(o-this.touchStartY);(r>10||a>10)&&clearTimeout(e)})),this.toggleBtn.addEventListener("touchend",(()=>{clearTimeout(e),t&&this.toggleBtn.addEventListener("click",(e=>{e.preventDefault(),e.stopPropagation()}),{once:!0})}))}e.append(this.toggleBtn)}}restoreAllMessages(){document.querySelectorAll(".messages-panel .message").forEach((e=>{e&&e.classList.remove("hidden-message","shown-message")})),localStorage.setItem("deletedChatMessagesContent",JSON.stringify([])),this.selected.clear(),this.updateDeletedMessages(),this.renderToggle()}}function ht(e){if(!e)return"";if(e.dataset.messageId)return e.dataset.messageId;let t=Array.from(e.childNodes).map((e=>e?e.nodeType===Node.TEXT_NODE||e.classList?.contains("username")?e.textContent.trim():"A"===e.tagName?e.href:"IMG"===e.tagName?e.title.trim():"IFRAME"===e.tagName?e.src.trim():"":"")).join("");return t||(t="msg-"+Math.random().toString(36).substring(2,7)),e.dataset.messageId=t,t}const gt=e=>e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/^######\s+(.*)$/gim,'<h6 class="md-heading md-h6">$1</h6>')).replace(/^#####\s+(.*)$/gim,'<h5 class="md-heading md-h5">$1</h5>')).replace(/^####\s+(.*)$/gim,'<h4 class="md-heading md-h4">$1</h4>')).replace(/^###\s+(.*)$/gim,'<h3 class="md-heading md-h3">$1</h3>')).replace(/^##\s+(.*)$/gim,'<h2 class="md-heading md-h2">$1</h2>')).replace(/^#\s+(.*)$/gim,'<h1 class="md-heading md-h1">$1</h1>')).replace(/`([^`]+)`/g,'<code class="md-code">$1</code>')).replace(/\*\*(.+?)\*\*/g,'<strong class="md-bold">$1</strong>')).replace(/__(.+?)__/g,'<em class="md-italic">$1</em>')).replace(/~~(.+?)~~/g,'<del class="md-strikethrough">$1</del>');class ft{constructor(e="messages-panel",t=""){this.panel=document.getElementById(e),this.messageMap=new Map,this.renderedMessageIds=new Set,this.currentUsername=t,this.maxMessages=30,this.defaultMessagesCount=20,this.initialLoadComplete=!1,this.chatRemover=new pt,this.messageInput=document.getElementById("message-input"),this.newSeparatorAdded=!1,this._delegatedClickAttached=!1,document.addEventListener("visibilitychange",(()=>{document.hidden&&(tt(this.panel),this.newSeparatorAdded=!1)})),this.messageInput&&this.messageInput.addEventListener("focus",(()=>{this.newSeparatorAdded&&(tt(this.panel),this.newSeparatorAdded=!1)}))}generateUniqueId(e,t,n,o){const r=t||(new Date).toLocaleTimeString("en-GB",{hour12:!1});return"private"===e?`private-${Math.random().toString(36).slice(2)}`:`${r}-${n}-${o}`}addMessage(e){return this.messageMap.set(e.id,e),this.trimMessages(),!0}trimMessages(){for(;this.messageMap.size>this.maxMessages;){const e=this.messageMap.keys().next().value;this.messageMap.delete(e),this.renderedMessageIds.delete(e)}}processMessages(e){if("string"!=typeof e||!e)return;const t=at(),n=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("message");let o=!1;Array.from(n).forEach((e=>{const n=e.getElementsByTagName("body")[0];if(!n||!n.textContent)return;const r=n.textContent.trim();if("This room is not anonymous"===r)return;const a=/^([^,\s]+),/.exec(r);if(a&&t.includes(a[1]))return;const i=e.getAttribute("from"),s=xe(i&&i.split("#")[1]?.split("@")[0]||"unknown");if(t.includes(s))return;const c=e.getAttribute("to"),l="chat"===e.getAttribute("type");let d=null;l&&c&&(d=xe(c.split("#")[1]?.split("@")[0]||c));let m=null;const u=e.getElementsByTagName("delay")[0];if(u&&u.getAttribute("stamp")){const e=u.getAttribute("stamp");try{m=new Date(e).toLocaleTimeString("en-GB",{hour12:!1})}catch(e){console.error("Error parsing timestamp:",e)}}if(m||(m=(new Date).toLocaleTimeString("en-GB",{hour12:!1})),s===this.currentUsername&&this.initialLoadComplete)return;if(!Array.from(this.messageMap.values()).some((e=>e.from===s&&e.text===r))){const e={id:this.generateUniqueId(l?"private":"public",m,s,r),from:s,text:r,isPrivate:l,recipient:d,pending:!1,timestamp:m};this.addMessage(e)&&(o=!0)}})),o&&this.updatePanel()}addSentMessage(e,t={}){const n=t.isPrivate||!1,o=(new Date).toLocaleTimeString("en-GB",{hour12:!1}),r=this.generateUniqueId(n?"private":"public",o,this.currentUsername,e),a={id:r,from:this.currentUsername,text:e,isPrivate:n,recipient:t.recipient||null,pending:t.pending||!1,timestamp:o};return this.addMessage(a)&&this.updatePanel(),r}updatePendingStatus(e,t){const n=this.messageMap.get(e);n&&(n.pending=t,this.updatePanel())}updatePanel(){if(!this.panel)return;const e=new Set(Array.from(this.panel.querySelectorAll(".message")).map((e=>e.getAttribute("data-message-id"))));this.renderedMessageIds=e;const t=document.createDocumentFragment();let n=!1;if(this.messageMap.forEach(((e,o)=>{if(!this.renderedMessageIds.has(o)){const r=e.timestamp||(new Date).toLocaleTimeString("en-GB",{hour12:!1}),a=xe(e.from),i=fe.getColor(a),s=document.createElement("div");s.className="message",s.setAttribute("data-message-id",o),"Клавобот"===e.from&&(s.classList.add("banned"),this.initialLoadComplete&&Ae("https://github.com/VimiummuimiV/KG_Chat_Application/raw/refs/heads/main/src/sounds/mario-game-over.mp3")),e.isPrivate&&e.from!==this.currentUsername&&document.hidden&&Ae(Me),e.isPrivate&&(s.classList.add("private-message"),s.classList.add(e.from===this.currentUsername?"sent":"received"),e.recipient&&s.setAttribute("data-recipient",e.recipient)),e.text.startsWith("/me ")&&(s.classList.add("system"),e.text=`${e.from} ${e.text.substring(e.text.indexOf(" ")+1)}`),e.isSystem&&s.classList.add("system");const c=document.createElement("div");c.className="message-info";let l=e.from;e.isPrivate&&(l=e.from===this.currentUsername&&e.recipient?`→ ${e.recipient}`:`${e.from} →`),c.innerHTML=`\n          <span class="time">${r}</span>\n          <span class="username" style="color: ${i}">${l}</span>\n        `;const d=document.createElement("div");if(d.className="message-text",d.innerHTML=(e=>{e=gt(e);let t=0,n=[];e=(e=e.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~|!:,.;()_]*[-A-Z0-9+&@#\/%=~|()_])/gi,(e=>(n.push(e),`___URL${t++}___`)))).replace(/:(\w+):/g,((e,t)=>`<img src="https://klavogonki.ru/img/smilies/${t}.gif" alt="${t}" />`)).replace(/(\p{Emoji_Presentation}|\p{Emoji}\uFE0F)/gu,'<span class="emoji-adjuster">$&</span>'),n.forEach(((t,n)=>{if(je(t)){const o=Ie(t);e=e.replace(`___URL${n}___`,`<a class="processed-link decoded-link" href="${t}" target="_blank">${o}</a>`)}else e=e.replace(`___URL${n}___`,`<a class="processed-link" href="${t}" target="_blank">${t}</a>`)}));const o=/<a [^>]+>.*?<\/a>/gi,r=e.split(o),a=e.match(o)||[];let i="";return r.forEach(((e,t)=>{e.trim()&&(i+=`<p class="message-piece break-content">${e}</p>`),t<a.length&&(i+=a[t])})),i})(e.text),s.appendChild(c),s.appendChild(d),e.pending){const e=document.createElement("span");e.className="pending-emoji",e.textContent="⏱️",s.appendChild(e)}t.appendChild(s),this.renderedMessageIds.add(o),this.currentUsername&&e.text.includes(this.currentUsername)&&(n=!0)}})),document.hidden&&this.initialLoadComplete&&t.childNodes.length>0&&!this.newSeparatorAdded){const e=function(){const e=document.createElement("div");e.className="new-messages-separator";const t=document.createElement("hr");t.className="separator-line";const n=document.createElement("div");return n.className="separator-icon",n.textContent="🔥",e.appendChild(t),e.appendChild(n),e}();t.insertBefore(e,t.firstChild),this.newSeparatorAdded=!0}this.panel.appendChild(t),this.addDelegatedClickListeners(),Te(this.currentUsername),this.initialLoadComplete&&n&&Ae(Me),requestAnimationFrame((()=>{!this.initialLoadComplete&&this.messageMap.size>=this.defaultMessagesCount&&(this.panel.scrollTop=this.panel.scrollHeight,this.initialLoadComplete=!0)})),this.chatRemover&&(this.chatRemover.updateDeletedMessages(),this.chatRemover.renderToggle())}addDelegatedClickListeners(){if(!this.panel._delegatedClickAttached){let e=0,t="";this.panel.addEventListener("click",(async n=>{const o=n.target.closest(".username");if(o&&this.panel.contains(o)){let r=o.textContent.trim();if(r.includes("→")&&(r=r.startsWith("→")?r.replace("→","").trim():r.split("→")[0].trim()),n.shiftKey){window.getSelection().removeAllRanges();let e={};const t=sessionStorage.getItem("usernameIds");if(t)try{e=JSON.parse(t)}catch(t){console.error("Error parsing stored username IDs:",t),e={}}let n=e[r];if(n||(n=await ze(r),n&&(e[r]=n,sessionStorage.setItem("usernameIds",JSON.stringify(e)))),n){dt(`https://klavogonki.ru/u/#/${n}/`)}return}if(n.ctrlKey)this.messageInput.value=`/pm ${r} `,De(this.messageInput);else{const n=Date.now();if(n-e<300&&t===r)this.messageInput.value=`${r}, `;else{const e=`${r}, `;this.messageInput.value.includes(e)||(this.messageInput.value+=e)}e=n,t=r}this.messageInput.focus()}const r=n.target.closest(".time");if(r&&this.panel.contains(r)){const e=function(e){const t=180- -(new Date).getTimezoneOffset(),[n,o,r]=e.split(":").map(Number);let a=60*n+o+t;a=(a%1440+1440)%1440;const i=a%60;return`${Math.floor(a/60).toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}(r.textContent.trim()),t=`https://klavogonki.ru/chatlogs/${new Intl.DateTimeFormat("en-CA").format(new Date)}.html#${e}`;window.open(t,"_blank")}})),this.panel._delegatedClickAttached=!0}}getChatHistory(){return Array.from(this.messageMap.values())}refreshMessages(e=!1,t="chat"){const n="connection-status",o=e?P[t].online:P[t].offline;this.messageMap.delete(n),this.renderedMessageIds.delete(n);const r={id:n,from:"System",text:o,isPrivate:!1,recipient:null,isSystem:!0,pending:!1,timestamp:(new Date).toLocaleTimeString("en-GB",{hour12:!1})};this.messageMap.set(n,r),this.updateConnectionStatusInUI(r)}updateConnectionStatusInUI(e){this.panel.querySelectorAll(".pending-emoji").forEach((e=>e.remove()));const t=this.panel.querySelector(`[data-message-id="${e.id}"]`);t&&t.remove(),this.updatePanel()}}const bt="http://www.w3.org/2000/svg",yt=`\n  <svg xmlns="${bt}" \n      width="24" \n      height="24" \n      viewBox="0 0 250 250">\n    <path fill="#096AD9" d="M22.32 98.04l-19.04 -87.15c-0.75,-3.46 0.48,-6.84 3.29,-9 2.81,-2.17 6.39,-2.49 9.55,-0.87l225.95 116.02c3.07,1.57 4.87,4.52 4.87,7.96 0,3.44 -1.8,6.39 -4.87,7.96l-225.95 116.02c-3.16,1.62 -6.74,1.3 -9.55,-0.87 -2.81,-2.16 -4.04,-5.54 -3.29,-9l19.04 -87.15c0.79,-3.62 3.53,-6.26 7.18,-6.91l102.6 -18.19c0.91,-0.16 1.56,-0.94 1.56,-1.86 0,-0.92 -0.65,-1.7 -1.56,-1.86l-102.6 -18.19c-3.65,-0.65 -6.39,-3.29 -7.18,-6.91z"/>\n  </svg>\n`,vt=`\n  <svg class="no" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250" \n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n      <path d="M46.62 0l156.76 0c25.64,0 46.62,20.98 46.62,46.62l0 156.75c0,25.65 -20.98,46.63 -46.62,46.63l-156.76 0c-25.64,0 -46.62,-20.98 -46.62,-46.63l0 -156.75c0,-25.64 20.98,-46.62 46.62,-46.62zm45.71 70.24l32.67 32.67 32.67 -32.67c2.73,-2.73 7.18,-2.73 9.91,0l12.18 12.18c2.73,2.73 2.73,7.18 0,9.91l-32.67 32.67 32.67 32.66c2.73,2.74 2.73,7.19 0,9.92l-12.18 12.18c-2.73,2.73 -7.18,2.73 -9.91,0l-32.67 -32.67 -32.67 32.67c-2.73,2.73 -7.18,2.73 -9.91,0l-12.18 -12.18c-2.73,-2.73 -2.73,-7.18 0,-9.92l32.67 -32.66 -32.67 -32.67c-2.73,-2.73 -2.73,-7.18 0,-9.91l12.18 -12.18c2.73,-2.73 7.18,-2.73 9.91,0z"/>\n  </svg>\n`,wt=`\n  <svg class="yes" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250" \n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n      <path d="M46.62 0l156.76 0c25.64,0 46.62,20.98 46.62,46.62l0 156.75c0,25.65 -20.98,46.63 -46.62,46.63l-156.76 0c-25.64,0 -46.62,-20.98 -46.62,-46.63l0 -156.75c0,-25.64 20.98,-46.62 46.62,-46.62zm15.5 135.79l57.92 -57.93c2.73,-2.73 7.19,-2.72 9.92,0.01l57.92 57.92c2.73,2.73 2.73,7.18 0,9.91l-12.18 12.18c-2.73,2.73 -7.18,2.73 -9.92,0l-35.82 -35.83c-2.73,-2.73 -7.19,-2.73 -9.92,0l-35.82 35.83c-2.74,2.73 -7.19,2.73 -9.92,0l-12.18 -12.18c-2.73,-2.73 -2.73,-7.18 0,-9.91z"/>\n  </svg>\n`,kt=`\n  <svg class="yes" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250"\n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n    <path d="M46.62 0l156.76 0c25.64,0 46.62,20.98 46.62,46.62l0 156.75c0,25.65 -20.98,46.63 -46.62,46.63l-156.76 0c-25.64,0 -46.62,-20.98 -46.62,-46.63l0 -156.75c0,-25.64 20.98,-46.62 46.62,-46.62zm109.99 181.69l-75.07 0c-7.3,0 -13.23,-5.92 -13.23,-13.22l0 -75.08c0,-2.35 1.92,-4.28 4.28,-4.28l17.9 0c2.35,0 4.27,1.93 4.27,4.28l0 32.81c0,1.77 1.01,3.28 2.64,3.96 1.63,0.67 3.42,0.33 4.66,-0.93l59.68 -59.68c1.67,-1.65 4.38,-1.65 6.05,0l12.66 12.66c1.66,1.67 1.66,4.38 0,6.05l-59.68 59.68c-1.26,1.24 -1.6,3.03 -0.93,4.66 0.68,1.63 2.19,2.64 3.96,2.64l32.81 0c2.35,0 4.28,1.92 4.28,4.28l0 17.9c0,2.36 -1.93,4.28 -4.28,4.28z"/>\n  </svg>\n`,xt=`\n  <svg class="no" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250"\n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n    <path d="M46.62 0l156.76 0c25.64,0 46.62,20.98 46.62,46.62l0 156.75c0,25.65 -20.98,46.63 -46.62,46.63l-156.76 0c-25.64,0 -46.62,-20.98 -46.62,-46.63l0 -156.75c0,-25.64 20.98,-46.62 46.62,-46.62zm46.77 68.31l75.07 0c7.3,0 13.23,5.92 13.23,13.22l0 75.08c0,2.35 -1.92,4.28 -4.28,4.28l-17.9 0c-2.35,0 -4.27,-1.93 -4.27,-4.28l0 -32.81c0,-1.77 -1.01,-3.28 -2.64,-3.96 -1.63,-0.67 -3.42,-0.33 -4.66,0.93l-59.68 59.68c-1.67,1.65 -4.38,1.65 -6.05,0l-12.66 -12.66c-1.66,-1.67 -1.66,-4.38 0,-6.05l59.68 -59.68c1.26,-1.24 1.6,-3.03 0.93,-4.66 -0.68,-1.63 -2.19,-2.64 -3.96,-2.64l-32.81 0c-2.35,0 -4.28,-1.92 -4.28,-4.27l0 -17.9c0,-2.36 1.93,-4.28 4.28,-4.28z"/>\n  </svg>\n`,Et=`\n  <svg class="yes" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250"\n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n    <path d="M46.59 0l156.82 0c25.65,0 46.59,20.94 46.59,46.59l0 156.82c0,25.65 -20.94,46.59 -46.59,46.59l-156.82 0c-25.65,0 -46.59,-20.94 -46.59,-46.59l0 -156.82c0,-25.65 20.94,-46.59 46.59,-46.59zm130.96 87.85c0,6.57 -1.03,12.72 -3.08,18.06 -2.05,5.34 -4.93,9.85 -8.42,13.75 -3.69,3.9 -8,7.39 -13.13,10.47 -4.11,2.46 -8.83,4.93 -13.96,6.98 -1.64,0.82 -2.87,2.46 -2.87,4.51l0 15.19c0,2.67 -2.06,4.72 -4.73,4.72l-25.04 0c-2.66,0 -4.92,-2.05 -4.92,-4.72l0 -25.65c0,-2.26 1.44,-3.9 3.49,-4.52 2.87,-1.02 5.95,-2.05 9.23,-3.28 4.52,-1.85 8.62,-3.9 12.11,-6.57 3.9,-2.67 6.78,-5.75 9.24,-9.24 2.46,-3.49 3.49,-7.59 3.49,-12.31 0,-6.78 -2.05,-11.7 -6.36,-14.78 -4.31,-2.88 -10.06,-4.52 -17.65,-4.52 -5.75,0 -11.7,1.24 -18.07,3.7 -5.33,2.05 -9.85,4.31 -13.13,6.36 -1.03,0.62 -2.26,0.62 -3.29,0 -1.02,-0.62 -1.64,-1.64 -1.64,-2.87l0 -23.2c0,-2.05 1.23,-3.9 3.08,-4.51 4.1,-1.44 9.44,-3.08 15.8,-4.52 8.42,-2.05 17.24,-3.07 26.89,-3.07 8.42,0 16.01,1.02 22.58,3.07 6.36,2.06 12.11,4.72 16.62,8.42 4.52,3.49 7.8,7.8 10.27,12.72 2.26,4.73 3.49,10.06 3.49,15.81l0 0zm-46.19 114.12l-25.04 0c-2.67,0 -4.92,-2.05 -4.92,-4.72l0 -17.24c0,-2.67 2.25,-4.72 4.92,-4.72l25.04 0c2.67,0 4.72,2.05 4.72,4.72l0 17.24c0,2.67 -2.05,4.72 -4.72,4.72z"/>\n  </svg>\n`,St=`\n  <svg class="theme" xmlns="${bt}" \n       width="15" \n       height="15" \n       viewBox="0 0 250 250" \n       style="shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd">\n    <path d="M46.59 0l156.82 0c25.65,0 46.59,20.94 46.59,46.59l0 156.82c0,25.65 -20.94,46.59 -46.59,46.59l-156.82 0c-25.65,0 -46.59,-20.94 -46.59,-46.59l0 -156.82c0,-25.65 20.94,-46.59 46.59,-46.59zm5.64 173.13l65.47 -60.21c4.39,-4.03 11.2,-3.74 15.41,0.47l3.42 3.42c4.21,4.21 4.5,11.02 0.47,15.41l-60.22 65.47c-2.17,2.37 -4.86,3.69 -8.08,3.79 -3.21,0.1 -6.02,-1.01 -8.29,-3.29l-8.68 -8.68c-2.28,-2.28 -3.39,-5.08 -3.29,-8.3 0.1,-3.21 1.42,-5.9 3.79,-8.08zm142.53 -113.72l-4.72 22.03 11.64 21.05c0.62,1.11 0.63,2.35 0.05,3.47 -0.59,1.13 -1.62,1.82 -2.87,1.95l-22.41 2.32 -16.43 17.58c-0.86,0.93 -2.03,1.32 -3.28,1.11 -1.25,-0.21 -2.23,-0.97 -2.74,-2.12l-9.13 -20.59 -21.8 -10.19c-1.15,-0.54 -1.89,-1.53 -2.07,-2.78 -0.19,-1.26 0.23,-2.42 1.17,-3.27l16.76 -15.05 2.96 -23.87c0.16,-1.26 0.87,-2.27 2.01,-2.83 1.13,-0.57 2.37,-0.53 3.47,0.11l19.48 11.29 23.63 -4.57c1.24,-0.24 2.42,0.13 3.31,1.03 0.89,0.91 1.23,2.09 0.97,3.33z"/>\n  </svg>`;function Ct(e,t){e.innerHTML=t?vt:wt,e.title=t?"Hide chat":"Show chat"}function Lt(e,t){e.innerHTML=t?kt:xt,e.title=t?"Collapse chat":"Expand chat"}function jt(){const e=document.getElementById("app-chat-container"),t=document.querySelector(".chat-toggle-button"),n=document.querySelector(".chat-maximize-button");if(!e||!t||!n)return;const o=It();e.classList.toggle("maximized",o.isMaximized),Lt(n,o.isMaximized),o.floating?(e.style.display=o.isVisible?"flex":"none",e.style.opacity=o.isVisible?"1":"0",e.classList.remove("visible-chat","hidden-chat")):(e.classList.toggle("visible-chat",o.isVisible),e.classList.toggle("hidden-chat",!o.isVisible)),Ct(t,o.isVisible);const r=window.innerWidth,a=window.innerHeight,i=getComputedStyle(document.documentElement),s=parseInt(i.getPropertyValue("--min-chat-width"))||250,c=parseInt(i.getPropertyValue("--min-chat-height"))||200;e.style.width=Math.min(r,Math.max(s,o.width))+"px",e.style.height=Math.min(a,Math.max(c,o.height))+"px",e.style.left=ke(o.left,0,r-e.offsetWidth)+"px",o.floating?(e.style.top=ke(o.top,0,a-e.offsetHeight)+"px",e.style.bottom="",e.classList.add("floating-chat")):(e.style.bottom="0",e.style.top="",e.classList.remove("floating-chat")),we()}function It(){const e=localStorage.getItem("chatState"),t={height:300,width:Math.min(window.innerWidth,600),left:0,floating:!1,top:window.innerHeight-300,isVisible:!0,fontSizeMultiplier:1,isMaximized:!1};return e?{...t,...JSON.parse(e)}:t}function Mt(e){const t=document.getElementById("app-chat-container"),n=document.getElementById("message-input");if(!t)return;t.style.fontSize=`${e}em`,n&&(n.style.fontSize="1em");At({...It(),fontSizeMultiplier:e})}function At(e){localStorage.setItem("chatState",JSON.stringify(e))}function Tt(){const e=document.getElementById("app-chat-container"),t=document.querySelector(".chat-toggle-button");if(!e)return;const n=It(),o=n.floating||!1,r=!n.isVisible;o?(e.style.opacity=r?"1":"0",setTimeout((()=>{e.style.display=r?"flex":"none",Ct(t,r),At({...n,isVisible:r}),r&&Pe()}),300)):(e.classList.toggle("visible-chat",r),e.classList.toggle("hidden-chat",!r),Ct(t,r),At({...n,isVisible:r}),r&&Pe())}function $t(){const e=document.getElementById("app-chat-container"),t=document.querySelector(".chat-maximize-button");if(!e||!t)return;const n=It(),o=!n.isMaximized;e.classList.toggle("maximized",o),Lt(t,o),At({...n,isMaximized:o}),requestAnimationFrame((()=>{we();const e=document.getElementById("messages-panel");e&&(e.scrollTop=e.scrollHeight),Pe()}))}class Nt{constructor(e={}){this.container=null,this.options={container:e.container||document.body,helpButton:e.helpButton,onDestroy:e.onDestroy},Nt.instance=this}init(){return this.createPanel(),this.bindEvents(),this}createPanel(){this.container=document.createElement("div"),this.container.className="help-panel",this.content=document.createElement("div"),this.content.className="help-content",this.updatePanelContent(),this.container.appendChild(this.content),document.body.appendChild(this.container),Ce(this.container,"show","1")}updatePanelContent(){const e={en:{heading:"Chat Commands & Hotkeys",sections:[{title:"Chat Commands",items:[{key:"/help",desc:"Show this help panel"},{key:"/me message",desc:"Send an action message"},{key:"/pm username",desc:"Activate private chat mode with the specified user"},{key:"/exit",desc:"Exit private chat mode"},{key:"/reset",desc:"Reset the chat data"},{key:"/colors",desc:"Show the username color panel"},{key:"/import colors",desc:"Import user colors from a json file"},{key:"/export colors",desc:"Export user colors to a json file"},{key:"/ignored",desc:"Show the ignored users panel"}]},{title:"Chat Hotkeys",items:[{key:"Ctrl + Space",desc:"Hide/Show the chat"},{key:"Shift + Ctrl + Space",desc:"Expand/Collapse the chat"},{key:"Ctrl + Click",desc:"Activate private chat mode with the clicked user"},{key:"Long Press (LMB)",desc:"Activate private chat mode with the clicked user (Userlist)"},{key:"Double Click (LMB)",desc:"Replace selected users with one in the input field (Messages)"},{key:"Shift + Click",desc:"Open the user profile by nickname in the message"}]},{heading:"Emoji Panel Actions & Hotkeys",subSections:[{title:"Emoji Panel Actions",items:[{key:"Click an emoji",desc:"Insert the emoji"},{key:"Click outside panel",desc:"Closes the panel (emoji or help)"}]},{title:"Emoji Panel Hotkeys",items:[{key:"Ctrl + ;",desc:"Open the Emoji Panel"},{key:"Enter",desc:"Insert the emoji"},{key:"Ctrl + Enter",desc:"Insert the emoji keeping the panel open"},{key:"Ctrl + Click",desc:"Insert the emoji keeping the panel open"},{key:"Shift + Click",desc:"Remove emoji from recent list (in recent category)"},{key:"q",desc:"Hide the Emoji Panel (single press when search is not focused)"},{key:"qq",desc:"Hide the Emoji Panel (double press 'q' when search is focused)"},{key:"Esc",desc:"Close the panel (emoji or help)"}]}]},{heading:"Image Manipulations",subSections:[{title:"Open/Close",items:[{key:"(LMB) Click",desc:"Open the image"},{key:"Ctrl + (RMB)",desc:"Close the image and copy the link"},{key:"Space or ESC",desc:"Close the image"}]},{title:"Movement and Scaling",items:[{key:"Hold (MMB)",desc:"Drag the expanded image"},{key:"Scroll (MMB)",desc:"Zoom in/out the image"},{key:"Ctrl + (MMB)",desc:"Scale the image. Move the cursor up or down."}]},{title:"Navigation",items:[{key:"Arrow keys (< >)",desc:"Switch between images"},{key:"(LMB), (RMB)",desc:"Switch between images"}]}]},{heading:"Markdown Formatting",items:[{key:"# Heading",desc:"Headings: use # for h1, ## for h2, up to ###### for h6"},{key:"`code`",desc:"Inline code"},{key:"**text**",desc:"Bold text"},{key:"__text__",desc:"Italic text"},{key:"~~text~~",desc:"Strikethrough text"}]},{heading:"Delete / Show / Restore Messages",subSections:[{title:"Deletion",items:[{key:"(RMB) + Message",desc:"Delete message"},{key:"(RMB) + Nickname",desc:"Delete user's messages"},{key:"(RMB) + Time",desc:"Delete his messages from the selected time"},{key:"Ctrl + (RMB) + Time",desc:"Delete all messages from the selected time"}]},{title:"Show / Restore",items:[{key:"(LMB) + Toggle",desc:"Show/Hide messages"},{key:"Ctrl + (LMB) + Toggle",desc:"Restore hidden messages"}]}]}]},ru:{heading:"Команды чата и горячие клавиши",sections:[{title:"Команды чата",items:[{key:"/help",desc:"Показать панель помощи"},{key:"/me сообщение",desc:"Отправить сообщение действия"},{key:"/pm username",desc:"Активировать приватный чат для указанного пользователя"},{key:"/exit",desc:"Выйти из приватного чата"},{key:"/reset",desc:"Сбросить данные чата"},{key:"/colors",desc:"Показать панель цветов имен пользователей"},{key:"/import colors",desc:"Импортировать цвета пользователей из json файла"},{key:"/export colors",desc:"Экспортировать цвета пользователей в json файл"},{key:"/ignored",desc:"Показать панель игнорируемых пользователей"}]},{title:"Горячие клавиши чата",items:[{key:"Ctrl + Space",desc:"Скрыть/Показать чат"},{key:"Shift + Ctrl + Space",desc:"Развернуть/Свернуть чат"},{key:"Ctrl + Click",desc:"Активировать приватный чат для выбранного пользователя"},{key:"Долгое нажатие (ЛКМ)",desc:"Активировать приватный чат для выбранного пользователя (Пользователи)"},{key:"Двойной клик (ЛКМ)",desc:"Замена выбранных пользователей одним в поле ввода (Сообщения)"},{key:"Shift + Click",desc:"Открыть профиль пользователя по никнейму в сообщении"}]},{heading:"Действия и горячие клавиши панели эмодзи",subSections:[{title:"Действия панели эмодзи",items:[{key:"Click an emoji",desc:"Вставить эмодзи"},{key:"Click outside panel",desc:"Закрыть панель (эмодзи или помощь)"}]},{title:"Горячие клавиши панели эмодзи",items:[{key:"Ctrl + ;",desc:"Открыть панель эмодзи"},{key:"Enter",desc:"Вставить эмодзи"},{key:"Ctrl + Enter",desc:"Вставить эмодзи, оставив панель открытой"},{key:"Ctrl + Click",desc:"Вставить эмодзи, оставив панель открытой"},{key:"Shift + Click",desc:'Удалить эмодзи из списка "Недавно использованные"'},{key:"q",desc:"Скрыть панель эмодзи (одиночный нажим, когда поиск не в фокусе)"},{key:"qq",desc:"Скрыть панель эмодзи (дважды нажмите 'q', когда поиск в фокусе)"},{key:"Esc",desc:"Закрыть (эмодзи или помощь)"}]}]},{heading:"Манипуляции с изображением",subSections:[{title:"Открытие/Закрытие",items:[{key:"(ЛКМ) Клик",desc:"Открыть изображение"},{key:"Ctrl + (ПКМ)",desc:"Закрыть изображение и скопировать ссылку"},{key:"Space или ESC",desc:"Закрыть изображение"}]},{title:"Перемещение и масштабирование",items:[{key:"Зажатая (СКМ)",desc:"Перемещайте развернутое изображение"},{key:"Прокрутка (СКМ)",desc:"Увеличивайте/уменьшайте изображение"},{key:"Ctrl + (СКМ)",desc:"Масштабируйте изображение. Курсор вверх или вниз."}]},{title:"Навигация",items:[{key:"Стрелки (< >)",desc:"Переключение между изображениями"},{key:"(ЛКМ), (ПКМ)",desc:"Переключение между изображениями"}]}]},{heading:"Форматирование Markdown",items:[{key:"# Заголовок",desc:"Заголовки: используйте # для h1, ## для h2, до ###### для h6"},{key:"`код`",desc:"Встроенный код"},{key:"**текст**",desc:"Жирный текст"},{key:"__текст__",desc:"Курсивный текст"},{key:"~~текст~~",desc:"Зачёркнутый текст"}]},{heading:"Удаление / Показ / Восстановление сообщений",subSections:[{title:"Удаление",items:[{key:"(ПКМ) + Сообщение",desc:"Удалить сообщение"},{key:"(ПКМ) + Никнейм",desc:"Удалить сообщения пользователя"},{key:"(ПКМ) + Время",desc:"Удалить его сообщения с выбранного времени"},{key:"Ctrl + (ПКМ) + Время",desc:"Удалить все сообщения с выбранного времени"}]},{title:"Показ / Восстановление",items:[{key:"(ЛКМ) + Toggle",desc:"Показать/Скрыть сообщения"},{key:"Ctrl + (ЛКМ) + Toggle",desc:"Восстановить скрытые сообщения"}]}]}]}}[localStorage.getItem("emojiPanelLanguage")||"en"];let t=`<h5 class="help-section-header">${e.heading}</h5>`;e.sections.forEach((e=>{e.title?t+=`<h6 class="help-section-subheader">${e.title}</h6>`:e.heading&&(t+=`<h5 class="help-section-header">${e.heading}</h5>`),e.items&&(t+='<ul class="help-list">',e.items.forEach((e=>{t+=`<li class="help-list-item"><strong class="help-hotkey">${e.key}</strong> ${e.desc}</li>`})),t+="</ul>"),e.subSections&&e.subSections.forEach((e=>{t+=`<h6 class="help-section-subheader">${e.title}</h6>`,t+='<ul class="help-list">',e.items.forEach((e=>{t+=`<li class="help-list-item"><strong class="help-hotkey">${e.key}</strong> ${e.desc}</li>`})),t+="</ul>"}))})),this.content.innerHTML=t}bindEvents(){this._clickOutsideHandler=e=>{this.options.helpButton&&(e.target===this.options.helpButton||this.options.helpButton.contains(e.target))||this.container&&!this.container.contains(e.target)&&(this.remove(),Ne("Help panel has been closed.",{type:"warning",duration:2e3}))},document.addEventListener("click",this._clickOutsideHandler,!0),this._escHandler=e=>{"Escape"===e.key&&(this.remove(),Ne("Help panel has been closed.",{type:"warning",duration:2e3}))},document.addEventListener("keydown",this._escHandler,!0),this._stopPropagationHandler=e=>{e.stopPropagation()},this.container.addEventListener("click",this._stopPropagationHandler)}remove(){this._clickOutsideHandler&&(document.removeEventListener("click",this._clickOutsideHandler,!0),this._clickOutsideHandler=null),this._escHandler&&(document.removeEventListener("keydown",this._escHandler,!0),this._escHandler=null),this.container&&(this.container.removeEventListener("click",this._stopPropagationHandler),this._stopPropagationHandler=null),this.container&&(Ce(this.container,"hide","0"),this.container=null),"function"==typeof this.options.onDestroy&&this.options.onDestroy(),Nt.instance=null}show(){this.container?this.updatePanelContent():this.init(),document.body.contains(this.container)||(document.body.appendChild(this.container),Ce(this.container,"show","1"),Ne("Help panel is now visible."))}toggle(){this.container&&document.body.contains(this.container)?this.remove():this.show()}}Nt.instance=null;(()=>{let e=!1;return function(){e||(document.addEventListener("keydown",(e=>{e.ctrlKey&&"Semicolon"===e.code&&(e.preventDefault(),document.querySelector(".emoji-panel")||new Pt({onEmojiSelect:e=>{const t=document.getElementById("message-input");t&&(t.value+=e,t.dispatchEvent(new Event("input",{bubbles:!0})),t.focus())}}).show())})),e=!0)}})()();class Pt{static instance=null;constructor(e={}){if(Pt.instance)return Pt.instance;Pt.instance=this,this.options={onEmojiSelect:e.onEmojiSelect||(()=>{}),container:e.container||document.getElementById("messages-panel")||document.body,position:e.position||"bottom",onDestroy:e.onDestroy,emojiButton:e.emojiButton},this.container=null,this.searchInput=null,this.emojiContainer=null,this.categoryNav=null,this.infoPanel=null,this.infoIcon=null,this.infoKeywords=null,this.languageSelect=null,this.categories={recent:{icon:"🕒"},smileys:{icon:"😊"},nature:{icon:"🦊"},food:{icon:"🍔"},activities:{icon:"⚽"},travel:{icon:"✈️"},objects:{icon:"💡"},symbols:{icon:"💕"},flags:{icon:"🎌"}},this.categoryLabels={en:{recent:"Recently Used",smileys:"Smileys & People",nature:"Animals & Nature",food:"Food & Drink",activities:"Activities",travel:"Travel & Places",objects:"Objects",symbols:"Symbols",flags:"Flags"},ru:{recent:"Недавно использованные",smileys:"Смайлы и люди",nature:"Животные и природа",food:"Еда и напитки",activities:"Активности",travel:"Путешествия и места",objects:"Объекты",symbols:"Символы",flags:"Флаги"}},this.uiLabels={en:{searchResults:"Search Results"},ru:{searchResults:"Результаты поиска"}},this.emojiData=ue,this.emojiKeywords=pe,this.recentEmojis=this.loadRecentEmojis(),this.batchSize=50,this.loadedIndices={},this.categorySections={},this.currentLanguage=localStorage.getItem("emojiPanelLanguage")||"en"}init(){return this.createPanel(),this.bindEvents(),this.loadAllEmojis(),this}createPanel(){if(document.querySelector(".emoji-panel"))return;this.container=document.createElement("div"),this.container.className="emoji-panel";const e=document.createElement("div");e.className="emoji-search-container",this.searchInput=document.createElement("input"),this.searchInput.type="search",this.searchInput.className="emoji-search",e.appendChild(this.searchInput),this.categoryNav=document.createElement("div"),this.categoryNav.className="emoji-categories",Object.entries(this.categories).forEach((([e,t])=>{const n=document.createElement("button");n.className="emoji-category-btn",n.dataset.category=e,n.innerHTML=t.icon,n.title=this.getLocalizedCategoryName(e),this.categoryNav.appendChild(n)})),this.emojiContainer=document.createElement("div"),this.emojiContainer.className="emoji-container",this.infoPanel=document.createElement("div"),this.infoPanel.className="emoji-info-panel",this.infoIcon=document.createElement("span"),this.infoIcon.className="emoji-info-icon",this.infoKeywords=document.createElement("span"),this.infoKeywords.className="emoji-info-keywords",this.infoPanel.appendChild(this.infoIcon),this.infoPanel.appendChild(this.infoKeywords),this.languageSelect=document.createElement("select"),this.languageSelect.className="emoji-language-select",this.languageSelect.innerHTML='\n      <option value="en">EN</option>\n      <option value="ru">RU</option>\n    ',this.languageSelect.value=this.currentLanguage;const t=document.createElement("div");t.className="emoji-footer",t.appendChild(this.infoPanel),t.appendChild(this.languageSelect),this.container.appendChild(e),this.container.appendChild(this.categoryNav),this.container.appendChild(this.emojiContainer),this.container.appendChild(t),this.options.container.appendChild(this.container),Ce(this.container,"show","1"),et()||this.searchInput.focus()}loadAllEmojis(){this.emojiContainer&&(this.emojiContainer.innerHTML="",this.loadedIndices={},this.categorySections={},Object.keys(this.categories).forEach((e=>{const t=document.createElement("div");t.className="emoji-category-section",t.id=`emoji-section-${e}`;const n=document.createElement("div");n.className="emoji-category-header",n.textContent=this.getLocalizedCategoryName(e),t.appendChild(n);const o=document.createElement("div");o.className="emoji-list",t.appendChild(o),this.emojiContainer.appendChild(t),this.loadedIndices[e]=0,this.categorySections[e]={section:t,emojiList:o,header:n},this.loadMoreEmojisForCategory(e)})))}loadMoreEmojisForCategory(e){const t="recent"===e?this.recentEmojis:this.emojiData[e]||[],n=this.loadedIndices[e],o=t.slice(n,n+this.batchSize);if(!o.length)return;const r=this.categorySections[e].emojiList;o.forEach((t=>{const n=document.createElement("button");n.className="emoji-btn",n.textContent=t,n.addEventListener("mouseenter",(()=>this.updateInfoPanel(t))),n.addEventListener("mouseleave",(()=>this.clearInfoPanel())),n.addEventListener("click",(n=>{n.stopPropagation(),n.shiftKey&&"recent"===e?(n.preventDefault(),this.removeFromRecent(t)):(this.addToRecent(t),this.options.onEmojiSelect(t),n.ctrlKey?this.searchInput.focus():this.destroy())})),r.appendChild(n)})),this.loadedIndices[e]+=o.length}searchEmojis(e){if(!this.emojiContainer)return;this.emojiContainer.innerHTML="";const t=document.createElement("div");t.className="emoji-category-section";const n=document.createElement("div");n.className="emoji-category-header",n.textContent=this.uiLabels[this.currentLanguage].searchResults,t.appendChild(n);const o=document.createElement("div");o.className="emoji-list",t.appendChild(o);const r=[];Object.keys(this.emojiData).forEach((t=>{(this.emojiData[t]||[]).forEach((t=>{const n=this.emojiKeywords[t]||{},o=Object.values(n).flat();(t.includes(e)||o.some((t=>t.toLowerCase().includes(e))))&&r.push(t)}))})),r.forEach((e=>{const t=document.createElement("button");t.className="emoji-btn",t.textContent=e,t.addEventListener("mouseenter",(()=>this.updateInfoPanel(e))),t.addEventListener("mouseleave",(()=>this.clearInfoPanel())),t.addEventListener("click",(t=>{t.stopPropagation(),this.addToRecent(e),this.options.onEmojiSelect(e),t.ctrlKey?this.searchInput.focus():this.destroy()})),o.appendChild(t)})),this.emojiContainer.appendChild(t)}bindEvents(){this._documentClickHandler=e=>{this.container.contains(e.target)||this.destroy()},document.addEventListener("click",this._documentClickHandler),this._emojiKeydownHandler=e=>{"Escape"===e.key&&this.destroy()},document.addEventListener("keydown",this._emojiKeydownHandler),this._qKeydownHandler=e=>{if("KeyQ"===e.code)if(document.activeElement===this.searchInput){const t=Date.now();this._lastQPressTime&&t-this._lastQPressTime<500?(e.preventDefault(),this.destroy(),this._lastQPressTime=0):this._lastQPressTime=t}else e.preventDefault(),this.destroy()},document.addEventListener("keydown",this._qKeydownHandler),this.searchInput.addEventListener("input",(e=>{const t=e.target.value.trim().toLowerCase();t?(this.searchEmojis(t),this.emojiContainer.classList.add("search-active")):(this.loadAllEmojis(),this.emojiContainer.classList.remove("search-active"))})),this.searchInput.addEventListener("keydown",(e=>{if("Enter"===e.key){if(e.preventDefault(),!this.searchInput||!this.emojiContainer)return;if(this.emojiContainer.classList.contains("search-active")){const t=this.emojiContainer?.querySelector(".emoji-btn");if(t){const n=new MouseEvent("click",{bubbles:!0,cancelable:!0,ctrlKey:e.ctrlKey});t.dispatchEvent(n),this.emojiContainer&&(this.emojiContainer.classList.remove("search-active"),this.loadAllEmojis()),this.searchInput&&(this.searchInput.value=""),e.ctrlKey?this.searchInput&&this.searchInput.focus():this.destroy()}}}})),this.categoryNav.addEventListener("click",(e=>{const t=e.target.closest(".emoji-category-btn");if(t){const n=t.dataset.category,o=document.getElementById(`emoji-section-${n}`);o&&this.emojiContainer&&(this.emojiContainer.style.scrollBehavior="smooth",this.emojiContainer.scrollTop=o.offsetTop-this.emojiContainer.offsetTop,e.preventDefault(),e.stopPropagation())}})),this.emojiContainer.addEventListener("scroll",(()=>this.handleScroll())),this.languageSelect.addEventListener("change",(e=>{this.currentLanguage=e.target.value,localStorage.setItem("emojiPanelLanguage",this.currentLanguage);const t=this.infoIcon.textContent;t&&this.updateInfoPanel(t),this.updateCategoryLabels(),this.searchInput.value.trim()&&this.searchEmojis(this.searchInput.value.trim().toLowerCase())})),this.container.addEventListener("click",(e=>{e.stopPropagation()}))}handleScroll(){Object.keys(this.categorySections).forEach((e=>{const{section:t}=this.categorySections[e],n=t.getBoundingClientRect(),o=this.emojiContainer.getBoundingClientRect();n.bottom<o.bottom+100&&this.loadMoreEmojisForCategory(e)}));let e=null,t=1/0;Object.keys(this.categorySections).forEach((n=>{const o=this.categorySections[n].header.getBoundingClientRect(),r=this.emojiContainer.getBoundingClientRect(),a=Math.abs(o.top-r.top);o.top<=r.top+10&&a<t&&(t=a,e=n)})),e&&this.highlightCategory(e)}updateCategoryLabels(){Object.keys(this.categories).forEach((e=>{const t=this.getLocalizedCategoryName(e),n=this.categoryNav.querySelector(`[data-category="${e}"]`);n&&(n.title=t),this.categorySections[e]&&this.categorySections[e].header&&(this.categorySections[e].header.textContent=t)}))}updateInfoPanel(e){if(!this.infoIcon||!this.infoKeywords)return;this.infoIcon.textContent=e;const t=(this.emojiKeywords[e]||{})[this.currentLanguage]||[];this.infoKeywords.textContent=t.join(", ")}clearInfoPanel(){this.infoIcon&&this.infoKeywords&&(this.infoIcon.textContent="",this.infoKeywords.textContent="")}addToRecent(e){if(this.recentEmojis=[e,...this.recentEmojis.filter((t=>t!==e))].slice(0,25),this.saveRecentEmojis(),this.categorySections.recent){this.categorySections.recent.emojiList.innerHTML="",this.loadedIndices.recent=0,this.loadMoreEmojisForCategory("recent")}}removeFromRecent(e){if(this.recentEmojis=this.recentEmojis.filter((t=>t!==e)),this.saveRecentEmojis(),this.categorySections.recent){this.categorySections.recent.emojiList.innerHTML="",this.loadedIndices.recent=0,this.loadMoreEmojisForCategory("recent")}}loadRecentEmojis(){try{return JSON.parse(localStorage.getItem("recentEmojis"))||[]}catch{return[]}}saveRecentEmojis(){try{localStorage.setItem("recentEmojis",JSON.stringify(this.recentEmojis))}catch(e){console.error("Failed to save recent emojis:",e)}}highlightCategory(e){this.categoryNav.querySelectorAll(".emoji-category-btn").forEach((t=>{t.classList.toggle("active",t.dataset.category===e)}))}show(){this.createPanel(),this.bindEvents(),this.loadAllEmojis()}destroy(){document.removeEventListener("keydown",this._emojiKeydownHandler),document.removeEventListener("keydown",this._qKeydownHandler),document.removeEventListener("click",this._documentClickHandler),this.container&&Ce(this.container,"hide","0"),this.container=null,this.searchInput=null,this.emojiContainer=null,this.categoryNav=null,this.infoPanel=null,this.infoIcon=null,this.infoKeywords=null,this.languageSelect=null,Pt.instance=null,this.options.emojiButton&&(this.options.emojiButton.title="Open emoji picker"),"function"==typeof this.options.onDestroy&&this.options.onDestroy()}toggle(){document.querySelector(".emoji-panel")?this.destroy():this.show()}getLocalizedCategoryName(e){return this.categoryLabels[this.currentLanguage][e]||e}}const zt=(e,t,n={})=>{const o=document.createElement(e);return t&&(o.className=t),Object.entries(n).forEach((([e,t])=>{"text"===e?o.textContent=t:o.setAttribute(e,t)})),o};function Bt(){const e=document.createElement("div");e.id="app-chat-container",["top","left","right"].forEach((t=>{const n=document.createElement("div");n.className=`resize-handle ${t}`,e.appendChild(n)}));const t=document.createElement("div");t.className="chat-wrapper";const n=document.createElement("div");n.className="chat-content";const o=document.createElement("div");o.id="messages-panel",o.className="messages-panel";const r=document.createElement("div");r.className="input-container";const a=document.createElement("button");var i,s;a.className="emoji-trigger button",a.innerHTML="🙂",a.classList.add("emoji-button"),a.title="Open emoji picker",a.addEventListener("mouseover",(()=>{a.innerHTML="🙃"})),a.addEventListener("mouseout",(()=>{a.innerHTML="🙂"})),function(e,t){const n=Object.keys(pe),o=setInterval((()=>{const t=n[Math.floor(Math.random()*n.length)];e.innerHTML=t,me(e),setTimeout((()=>{e.innerHTML="🙂"}),1500)}),t);e.randomEmojiIntervalId=o}(a,((i=3e5)>(s=6e5)&&([i,s]=[s,i]),Math.floor(Math.random()*(s-i+1))+i));let c=null;a.addEventListener("click",(e=>{e.stopPropagation(),c&&document.querySelector(".emoji-panel")?c.destroy():(c=new Pt({container:o,position:"bottom",emojiButton:a,onEmojiSelect:e=>{const t=document.getElementById("message-input");if(t){const n=t.selectionStart,o=t.value.substring(0,n),r=t.value.substring(t.selectionEnd);t.value=o+e+r;const a=n+e.length;t.setSelectionRange(a,a),t.focus()}},onDestroy:()=>{a.title="Open emoji picker",c=null}}),c.init(),a.title="Close emoji picker")}));const l=document.createElement("input");l.type="text",l.id="message-input",l.maxLength=300,l.autocomplete="off";const d=document.createElement("button");d.id="send-button",d.className="button send-button",d.innerHTML=yt,r.appendChild(a),r.appendChild(l),r.appendChild(d),n.appendChild(o),n.appendChild(r);const m=document.createElement("div");m.className="user-list-container";const u=document.createElement("div");u.id="user-list",m.appendChild(u),t.appendChild(n),t.appendChild(m),e.appendChild(t);const p=document.createElement("button");p.className="button header-button chat-help-button",p.innerHTML=Et,p.title="Show chat help";let h=null;p.addEventListener("click",(e=>{if(console.log("Help button clicked."),e.stopPropagation(),h&&document.querySelector(".help-panel"))return h.remove(),p.title="Show chat help",h=null,void Ne("Help panel has been closed.",{type:"warning",duration:2e3});console.log("Help panel does not exist. Creating help panel..."),h=new Nt({helpButton:p,onDestroy:()=>{p.title="Show chat help",h=null}}),h.init(),h.show(),Ne('Help panel has been opened. Press "?" or "ESC" key, or click outside to close.',{type:"success",duration:2e3}),p.title="Hide chat help"})),e.appendChild(p);const g=document.createElement("button");g.className="button header-button chat-maximize-button",g.addEventListener("click",$t),e.appendChild(g);const f=document.createElement("button");f.className="button header-button chat-toggle-button",f.addEventListener("click",Tt),e.appendChild(f);const b=document.createElement("button");b.className="button header-button chat-theme-button",b.innerHTML=St,b.title="Change theme",b.addEventListener("click",(()=>{(()=>{const e=document.querySelector(".themes-panel");if(e)return e;const t=zt("div","themes-panel",{html:"<h2>Themes</h2>"}),n=zt("div","themes-list");t.appendChild(n);const o=()=>{const e=localStorage.getItem("selectedTheme")||"dark-theme";n.querySelectorAll(".theme-button").forEach((t=>{t.dataset.theme===e?t.classList.add("active-theme"):t.classList.remove("active-theme")}))};[{name:"Dark",className:"dark-theme"},{name:"Light Gray",className:"light-gray-theme"},{name:"Light",className:"light-theme"}].forEach((e=>{const t=zt("button","theme-button",{text:e.name});t.dataset.theme=e.className,t.addEventListener("click",(()=>{document.body.className=e.className,localStorage.setItem("selectedTheme",e.className),o()})),n.appendChild(t)})),o(),document.body.appendChild(t),Ce(t,"show",1);const r=e=>{"Escape"===e.key&&(Ce(t,"hide",0),document.removeEventListener("keydown",r))};document.addEventListener("keydown",r);const a=e=>{t.contains(e.target)||(Ce(t,"hide",0),document.removeEventListener("click",a,!0),document.removeEventListener("keydown",r))};document.addEventListener("click",a,!0)})()})),e.appendChild(b);const y=document.createElement("div");y.className="chat-drag-area",y.addEventListener("dblclick",Tt),e.appendChild(y),document.body.appendChild(e),function(){let e=localStorage.getItem("selectedTheme");e||(e="dark-theme",localStorage.setItem("selectedTheme",e)),document.body.className=e}(),jt(),function(){if(!document.getElementById("app-chat-container"))return;const e=It(),t=document.createElement("div");t.className="font-size-control";const n=document.createElement("input");n.type="range",n.min="0.8",n.max="1.5",n.step="0.1",n.value=e.fontSizeMultiplier,n.className="font-size-slider",n.addEventListener("mousedown",(e=>{e.stopPropagation()})),n.addEventListener("input",(e=>{Mt(parseFloat(e.target.value))})),t.appendChild(n);const o=document.querySelector(".chat-drag-area");o&&o.appendChild(t)}(),Mt(It().fontSizeMultiplier),requestAnimationFrame((()=>{l&&(l.value=""),Oe=o,Je=document.createElement("div"),Je.className="length-field-popup",Oe.appendChild(Je),Ue=l,Ue?Je&&(Ue.addEventListener("input",Ge),Ue.addEventListener("keydown",Qe)):console.error("chatField is null"),function(e,t,n,o,r){if(et()){const a=document.createElement("style");a.classList.add("global-mobile-styles"),a.textContent="\n      html, body {\n        overflow: hidden !important;\n        height: 0 !important;\n      }\n\n      #app-chat-container .emoji-panel {\n        transform: translate(-50%, 0%) !important;\n        height: 60vh !important;\n        top: 1em !important;\n        left: 50% !important;\n        right: unset !important;\n      }\n\n      #app-chat-container .user-list-container {\n        top: 1em !important;\n        height: fit-content !important;\n        max-height: 70vh !important;\n        border-top: 1px solid var(--border-color) !important;\n        border-bottom: 1px solid var(--border-color) !important;\n        border-radius: 0.5em 0 0 0.5em !important;\n      }\n\n      #app-chat-container .toggle-button {\n        border: none !important;\n        top: 0 !important;\n        right: 0 !important;\n        border-radius: 0.2em !important;\n        margin: 1em !important;\n        box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.1) !important;\n      }\n    ",document.head.appendChild(a),window.visualViewport&&window.visualViewport.addEventListener("resize",(()=>{const a=window.innerHeight-window.visualViewport.height-window.visualViewport.offsetTop;e.style.setProperty("height",`calc(100% - ${a}px)`,"important");const i=e.getBoundingClientRect().height<100;n.style.display=i?"none":"",t.style.margin=i?"0":"",t.style.marginTop=i?"0":"",r.style.position=i?"absolute":"",r.style.bottom=i?"0":"",o.style.display=i?"none":"";const s=document.querySelector(".reveal-userlist-btn");s&&(s.style.display=i?"none":""),n.scrollTop=n.scrollHeight}))}}(e,n,o,y,r)}))}function qt(){localStorage.removeItem("klavoauth"),localStorage.removeItem("chatUsernameColor"),setTimeout((()=>{window.location.href="https://klavogonki.ru/gamelist/"}),500)}const Ht={get username(){const e=localStorage.getItem("klavoauth");return e?JSON.parse(e).username:""},get password(){const e=localStorage.getItem("klavoauth");return e?JSON.parse(e).password:""}};function Dt(){const e="KG_Chat_App_Version",t="https://update.greasyfork.org/scripts/529368/KG_Chat_Application.meta.js?rand="+Date.now();localStorage.getItem(e)||localStorage.setItem(e,"0.0.0");const n=localStorage.getItem(e);fetch(t).then((e=>e.text())).then((t=>{const o=t.match(/@version\s+v?([\d.]+)/i);if(!o)throw new Error("Version not found in meta file");const r=o[1].trim();(function(e,t){const n=e.split(".").map(Number),o=t.split(".").map(Number),r=Math.max(n.length,o.length);for(let e=0;e<r;e++){const t=n[e]||0,r=o[e]||0;if(t>r)return 1;if(t<r)return-1}return 0})(r,n)>0&&function(e,t,n,o){const r=document.createElement("div");r.className="update-overlay";const a=document.createElement("div");a.className="update-popup",a.innerHTML=`\n      <h2 class="update-header">Update Available</h2>\n      <h2 class="update-script">KG_Chat_Application</h2>\n      <p>A new version <span class="version">${e}</span> is available.</p>\n      <p>You are currently using version <span class="version">${t}</span>.</p>\n      <div class="button-container">\n        <button id="update-later" class="update-later">Later</button>\n        <button id="update-skip" class="update-skip">Skip</button>\n        <button id="update-now" class="update-now">Update Now</button>\n      </div>\n  `,document.body.append(r,a),document.getElementById("update-later").addEventListener("click",(()=>{r.remove(),a.remove()})),document.getElementById("update-skip").addEventListener("click",(()=>{o&&o(),r.remove(),a.remove()})),document.getElementById("update-now").addEventListener("click",(()=>{o&&o(),window.open(n,"_blank"),r.remove(),a.remove()}))}(r,n,"https://update.greasyfork.org/scripts/529368/KG_Chat_Application.user.js",(()=>{localStorage.setItem(e,r)}))})).catch((e=>console.error("Update check failed:",e)))}const Rt="usernameColors",_t=e=>{try{const t=e.getItem(Rt);return t?JSON.parse(t):{}}catch(t){return console.error(`Error parsing ${e===sessionStorage?"sessionStorage":"localStorage"} data:`,t),{}}},Ut=(e,t)=>{try{return e.setItem(Rt,JSON.stringify(t)),!0}catch(t){return console.error(`Error saving data to ${e===sessionStorage?"sessionStorage":"localStorage"}:`,t),!1}},Ot=()=>_t(sessionStorage),Jt=(e,t)=>{const n=_t(localStorage);return n[e]=t,Ut(localStorage,n)},Ft=e=>{const t=_t(localStorage);return e in t&&(delete t[e],Ut(localStorage,t))},Kt=e=>e in _t(localStorage),Xt=(e,t,n={})=>{const o=document.createElement(e);return t&&(o.className=t),Object.entries(n).forEach((([e,t])=>{"text"===e?o.textContent=t:"html"===e?o.innerHTML=t:o.setAttribute(e,t)})),o};function Yt(e,t){const n=Math.round(255*t).toString(16).padStart(2,"0");return 7===e.length?e+n:e.slice(0,7)+n}const Wt=(e,t,n)=>{e.style.color=n,Object.assign(t.style,{backgroundColor:Yt(n,.4),color:n}),t.textContent=n},Vt=()=>{const e=document.querySelector(".chat-username-color-picker");if(e)return e;const t=Ot();let n=null,o=null,r=null;const a=Xt("div","chat-username-color-picker",{html:"<h2>Username Colors</h2>"}),i=Xt("div","generated-username-colors",{html:'<h3>Generated Colors <span class="counter">0</span></h3>'}),s=()=>{if(!n){n=Xt("div","saved-username-colors",{html:'<h3>Saved Colors <span class="counter">0</span></h3>'});const e=a.querySelector("h2");e.nextSibling?a.insertBefore(n,e.nextSibling):a.appendChild(n)}};function c(){if(i){const e=i.querySelectorAll(".username-entry").length,t=i.querySelector("h3 .counter");t&&(t.textContent=e)}if(n){const e=n.querySelectorAll(".username-entry").length,t=n.querySelector("h3 .counter");t&&(t.textContent=e)}}const l=()=>{i.querySelectorAll(".username-entry").forEach((e=>{const t=e.querySelector(".user-label").textContent;e.classList.toggle("disabled-entry",Kt(t))})),c()},d=(e,o,r=!1)=>{const a=Xt("div","username-entry"),i=Xt("div","user-label",{text:e}),c=Xt("div","color-box");Wt(i,c,o);const d=Xt("input",null,{type:"color",value:o});if(a._colorInput=d,a.append(i,c,d),r){const t=Gt(a,e,o,(()=>{a.remove(),l(),n&&!n.querySelector(".username-entry")&&(n.remove(),n=null)}));a._removeBtn=t}const u=nt((()=>{const o=d.value;Wt(i,c,o),r?(Jt(e,o),a._removeBtn&&a.contains(a._removeBtn)?Object.assign(a._removeBtn.style,{backgroundColor:Yt(o,.4),color:o}):a._removeBtn=Gt(a,e,o,(()=>{a.remove(),l(),n&&!n.querySelector(".username-entry")&&(n.remove(),n=null)}))):(t[e]=o,Ut(sessionStorage,t),Jt(e,o),s(),m(),l())}),1e3);return d.addEventListener("input",u),a},m=()=>{if(!n)return;const e=_t(localStorage);n.innerHTML='<h3>Saved Colors <span class="counter">0</span></h3>',Object.entries(e).forEach((([e,t])=>{const o=d(e,t,!0);n.appendChild(o)})),n.querySelector(".username-entry")||(n.remove(),n=null),c()};Object.entries(t).forEach((([e,t])=>{const n=d(e,t);i.appendChild(n)})),c(),s(),m(),l(),a.appendChild(i),document.body.appendChild(a),Ce(a,"show",1);const u=e=>{"Escape"===e.key&&(Ce(a,"hide",0),document.removeEventListener("keydown",u))};document.addEventListener("keydown",u);const p=e=>{a.contains(e.target)||(Ce(a,"hide",0),document.removeEventListener("click",p,!0),document.removeEventListener("keydown",u))};function h(){clearTimeout(o),r&&(r._isLongPress=!1,r=null)}return document.addEventListener("click",p,!0),a.addEventListener("click",(e=>{const t=e.target.closest(".remove-btn");if(t){const e=t.closest(".username-entry");if(!e)return;const o=e.querySelector(".user-label").textContent;return Ft(o),e.remove(),l(),void(n&&!n.querySelector(".username-entry")&&(n.remove(),n=null))}const o=e.target.closest(".color-box");if(o){const e=o.closest(".username-entry");if(!e||e.classList.contains("disabled-entry")||e._customInputActive)return;e._colorInput&&e._colorInput.click()}})),a.addEventListener("pointerdown",(e=>{const t=e.target.closest(".color-box");if(!t)return;const n=t.closest(".username-entry");n&&!n.classList.contains("disabled-entry")&&(o=setTimeout((()=>{n._isLongPress=!0,function(e){if(e.querySelector(".custom-color-input"))return;e._customInputActive=!0;const t=Xt("div","custom-color-input"),n=Xt("input","hex-input",{type:"text",placeholder:"Enter hex color"}),o=Xt("button","confirm-btn",{text:"Confirm"});t.append(n,o),e.appendChild(t),n.focus();const r=()=>{const o=n.value.trim();/^#[0-9A-Fa-f]{6}$/.test(o)?(e._colorInput&&(e._colorInput.value=o,e._colorInput.dispatchEvent(new Event("input",{bubbles:!0}))),e.removeChild(t),e._customInputActive=!1):alert("Invalid hex color")};o.addEventListener("click",(e=>{e.stopPropagation(),r()})),n.addEventListener("keypress",(e=>{"Enter"===e.key&&(e.stopPropagation(),r())})),t.addEventListener("click",(e=>e.stopPropagation()))}(n)}),500),r=n)})),a.addEventListener("pointerup",h),a.addEventListener("pointerleave",h),a.addEventListener("pointercancel",h),a},Gt=(e,t,n,o)=>{let r=e.querySelector(".remove-btn");return r&&e.removeChild(r),r=Xt("div","remove-btn"),r.appendChild((()=>{const e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("width","12"),e.setAttribute("height","12"),e.setAttribute("fill","none"),e.setAttribute("stroke","currentColor"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round"),e.classList.add("remove-icon"),["M18 6L6 18","M6 6L18 18"].forEach((t=>{const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",t),e.appendChild(n)})),e})()),r.title="Remove saved color",Object.assign(r.style,{backgroundColor:Yt(n,.4),color:n}),r.addEventListener("click",(n=>{n.stopPropagation(),Ft(t),e.removeChild(r),"function"==typeof o&&o()})),e.appendChild(r),r};const Qt=[{name:"reset",pattern:/^\/reset\s*$/,handler:()=>(qt(),localStorage.removeItem("userAvatarCache"),localStorage.removeItem("chatState"),sessionStorage.removeItem("userAvatarCache"),Ne("Chat settings have been reset. Reloading...",{type:"info",duration:2e3}),!0)},{name:"colors",pattern:/^\/colors\s*$/,handler:()=>(Vt(),Ne("Username color picker has been opened",{type:"info",duration:2e3}),!0)},{name:"export colors",pattern:/^\/export\s+colors\s*$/,handler:()=>(function(){const e=localStorage.getItem("usernameColors");if(!e)return void Ne("No username colors found to export",{type:"error",duration:2e3});const t=JSON.stringify(JSON.parse(e),null,2),n=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(n),r=document.createElement("a");r.href=o,r.download="usernameColors.json",r.click(),URL.revokeObjectURL(o),Ne("Username colors exported as JSON file",{type:"info",duration:2e3})}(),!0)},{name:"import colors",pattern:/^\/import\s+colors\s*$/,handler:()=>(function(){const e=document.createElement("input");e.type="file",e.accept="application/json",e.style.display="none",document.body.appendChild(e),e.addEventListener("change",(e=>{const t=e.target.files[0];if(!t)return void Ne("No file selected",{type:"error",duration:2e3});const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);localStorage.setItem("usernameColors",JSON.stringify(t)),Ne("Username colors imported successfully",{type:"info",duration:2e3})}catch(e){Ne("Invalid JSON file",{type:"error",duration:2e3})}},n.readAsText(t)})),e.click(),document.body.removeChild(e)}(),!0)},{name:"help",pattern:/^\/help\s*$/,handler:()=>{if(Nt.instance)Nt.instance.remove(),Ne("Help panel has been closed.",{type:"warning",duration:2e3});else{const e=new Nt({onDestroy:()=>{}});e.init(),e.show(),Ne("Help panel is now visible.",{type:"info",duration:2e3})}return!0}},{name:"ignored",pattern:/^\/ignored\s*$/,handler:()=>(ct(),Ne("Ignored users panel has been opened",{type:"info",duration:2e3}),!0)}];function Zt(e){e&&e.addEventListener("input",(()=>{!function(e){if(!e)return!1;const t=e.value;for(const n of Qt)if(n.pattern.test(t)){const t=n.handler();return t&&(e.value=""),t}}(e)}))}let en,tn,nn,on,rn=!1;let an,sn,cn,ln,dn,mn,un=!1,pn=null,hn=0;function gn(e,t,n,o){const r=e=>e&&t.updatePresence(e),a=e=>e&&n.processMessages(e);let i=null;function s(){if(i)return i;if(!sessionStorage.getItem("usernameColors"))return console.log("usernameColors key does not exist in sessionStorage, skipping userInfo calculation"),null;try{const e=JSON.parse(sessionStorage.getItem("usernameColors")),t=Se(o),n=t.toLowerCase(),r=e[n]||"#ff00c6",a=(e=>{console.log("Optimizing color for contrast:",e);let{h:t,s:n,l:o}=he.hexToHSL(e),r=e;for(;he.contrastRatio(r,"#FFFFFF")<4.5&&o>0;)r=he.hslToHex(t,n,--o);return r})(r),s=`/storage/avatars/${o.split("#")[0]}.png`,c=Math.floor(Date.now()/1e3);return i={cleanedUsername:t,usernameKey:n,storedColor:r,optimizedColor:a,baseAvatarPath:s,timestamp:c},i}catch(e){return console.error("Error parsing usernameColors from sessionStorage:",e),null}}const c={userManager:t,messageManager:n,isHttpBindingActive:!1,isReconnecting:!1,isConnected:!1,messageQueue:new Map,lastSentMessage:null,_createMessageStanza(t,n,r,a){const i=s(),c=localStorage.getItem("chatUsernameColor"),l=c||(i?i.optimizedColor:q),d=`\n      <x xmlns='klavogonki:userdata'>\n        <user>\n          <login>${i.cleanedUsername}</login>\n          <avatar>${i.baseAvatarPath}?updated=${i.timestamp}</avatar>\n          <background>${l}</background>\n        </user>\n      </x>\n      `,m=r&&a?a:"general@conference.jabber.klavogonki.ru",u=r?"chat":"groupchat";return Ze(`\n      <body rid='${e.nextRid()}' sid='${e.sid}' xmlns='http://jabber.org/protocol/httpbind'>\n        <message \n          from='${o}@jabber.klavogonki.ru/web' \n          to='${m}' \n          type='${u}' \n          id='${n}' \n          xmlns='jabber:client'>\n          <body>${t}</body>\n          ${d}\n        </message>\n      </body>\n      `)},async processQueue(){if(this.isConnected&&!this.isReconnecting)for(const[t,o]of this.messageQueue){const r=this._createMessageStanza(o.text,o.id,o.isPrivate,o.fullJid);try{await e.sendRequestWithRetry(r),this.messageQueue.delete(t),n.updatePendingStatus(o.id,!1),a(null)}catch(e){console.error(`Failed to send queued message (${o.id}): ${e.message}`);break}}},async connect(){try{this.stopHttpBinding();let t=5;for(;t>0&&!this.isConnected;)try{const t=await e.connect();console.log("💬 Step 8: Joining chat room...");const i=s(),c=i?i.cleanedUsername:Se(o),l=i?i.baseAvatarPath:`/storage/avatars/${o.split("#")[0]}.png`,d=i?i.timestamp:Math.floor(Date.now()/1e3),m=localStorage.getItem("chatUsernameColor"),u=m||(i?i.optimizedColor:q),p=Ze(`\n            <body rid='${e.nextRid()}' xmlns='http://jabber.org/protocol/httpbind' sid='${t.sid}'>\n              <presence from='${o}@jabber.klavogonki.ru/web' to='general@conference.jabber.klavogonki.ru/${o}' xmlns='jabber:client'>\n                <x xmlns='http://jabber.org/protocol/muc'/>\n                <x xmlns='klavogonki:userdata'>\n                  <user>\n                    <login>${c}</login>\n                    <avatar>${l}?updated=${d}</avatar>\n                    <background>${u}</background>\n                  </user>\n                </x>\n              </presence>\n            </body>\n            `),h=await e.sendRequestWithRetry(p);console.log("📥 Join response:",h),r(h),a(h);const g=Ze(`\n              <body \n                rid='${e.nextRid()}' \n                sid='${t.sid}' \n                xmlns='http://jabber.org/protocol/httpbind'>\n                <iq \n                  type='get' \n                  id='info_${Math.random().toString(36).substring(2,10)}' \n                  xmlns='jabber:client' \n                  to='general@conference.jabber.klavogonki.ru'>\n                  <query xmlns='http://jabber.org/protocol/disco#info'/>\n                </iq>\n              </body>\n            `);await e.sendRequestWithRetry(g),console.log("🚀 Step 10: Connected!"),this.isConnected=!0,this.isReconnecting&&(Ne("Chat connected successfully!",{type:"success"}),n.refreshMessages(!0),this.isReconnecting=!1),this.startHttpBinding(),this.processQueue();break}catch(e){console.error(`💥 Connection error: ${e.message}`),t--,0===t?(console.log("⏳ Scheduling reconnection attempt in 3 seconds..."),this.isReconnecting=!0,setTimeout((()=>this.connect()),N)):(console.log(`🔄 Retrying connection... (${t} attempts left)`),await new Promise((e=>setTimeout(e,N))))}}catch(e){console.error(`💥 Final connection error: ${e.message}`),this.isConnected=!1,this.isReconnecting||(console.log("⏳ Scheduling reconnection attempt in 3 seconds..."),this.isReconnecting=!0,setTimeout((()=>this.connect()),N))}},async startHttpBinding(){if(this.isHttpBindingActive)return;this.isHttpBindingActive=!0,console.log("💬 Starting XMPP HTTP binding...");const t=async()=>{if(this.isConnected&&!this.isReconnecting&&this.isHttpBindingActive)try{const n=await e.sendRequestWithRetry(`<body rid='${e.nextRid()}' sid='${e.sid}' xmlns='http://jabber.org/protocol/httpbind'/>`);r(n),a(n),this.isHttpBindingActive&&t()}catch(e){console.error("HTTP binding error:",e.message),e.message.includes("404")&&!this.isReconnecting&&(console.log("🛑 Chat connection lost. Reconnecting..."),Ne("Chat connection lost. Reconnecting...",{type:"warning"}),n.refreshMessages(!1),this.isReconnecting=!0,this.isConnected=!1,this.isHttpBindingActive=!1,this.connect())}else this.isHttpBindingActive=!1};t()},stopHttpBinding(){this.isHttpBindingActive&&(this.isHttpBindingActive=!1,console.log("💬 HTTP binding stopped."))},sendMessage(e){const t=`msg_${Date.now()}`;let o=!1,r=null,a=null;const i=!this.isConnected||this.isReconnecting;Be.isPrivateMode&&Be.fullJid?(o=!0,r=Be.fullJid,a=Be.targetUsername,n.addSentMessage(e,{isPrivate:!0,recipient:a,pending:i})):n.addSentMessage(e,{pending:i});const s=Date.now();this.lastSentMessage&&this.lastSentMessage.text===e&&s-this.lastSentMessage.timestamp<2e3?console.log("Duplicate message prevented:",e):this.messageQueue.has(t)?console.log("Message already in queue:",t):(this.lastSentMessage={text:e,timestamp:s},this.messageQueue.set(t,{text:e,id:t,isPrivate:o,fullJid:r,recipient:a,pending:i,enqueueTime:s}),this.isConnected&&!this.isReconnecting&&this.processQueue())}};return window.addEventListener("offline",(()=>{console.log("Network offline. Stopping HTTP binding."),c.stopHttpBinding(),c.isConnected=!1,Ne("Network connection lost.",{type:"warning"}),n.refreshMessages(!1,"network")})),window.addEventListener("online",(()=>{console.log("Network online. Reconnecting immediately..."),c.isConnected||c.isReconnecting||c.connect(),Ne("Network connection restored.",{type:"success"}),n.refreshMessages(!0,"network")})),window.addEventListener("beforeunload",(()=>{c.stopHttpBinding()})),c}function fn(){if(function(){try{return window!==window.top}catch(e){return!0}}())return console.error("Application cannot run in an iframe"),!1;const e=new URLSearchParams(window.location.search);if("/g/"===window.location.pathname&&e.has("gmid"))return!1;if(window.location.href.includes("/gamelist/"))return function(){if(window.location.href.startsWith("https://klavogonki.ru/gamelist/"))try{const e=Array.from(document.scripts).find((e=>e.text.includes("PageData")));if(!e)throw new Error("PageData script not found");const t=e.text.match(/\.constant\('PageData', ([\s\S]*?})\)/)[1],n=JSON.parse(t.replace(/(\w+):/g,'"$1":').replace(/'/g,'"')),o=`${n.chatParams.user.id}#${n.chatParams.user.login}`,r=n.chatParams.pass;localStorage.getItem("klavoauth")||(localStorage.setItem("klavoauth",JSON.stringify({username:o,password:r})),localStorage.setItem("chatUsernameColor",n.chatParams.user.background),setTimeout((()=>{window.location.href="https://klavogonki.ru"}),500))}catch(e){console.error("Auth error:",e),qt(),alert(`Auth failed: ${e.message}\nPlease refresh the page.`)}}(),!1;return!!(localStorage.getItem("klavoauth")&&Ht.username&&Ht.password)||(localStorage.removeItem("klavoauth"),window.location.href="https://klavogonki.ru/gamelist/",!1)}(async function(){try{if(function(){if(!document.querySelector('meta[name="viewport"]')){const e=document.createElement("meta");e.name="viewport",e.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",document.head.appendChild(e),console.log("Viewport meta tag added dynamically")}}(),!fn())return;Bt(),function(){const e=document.getElementById("app-chat-container"),t=document.getElementById("chat-close-btn"),n=document.getElementById("chat-header");if(!e)return;const o=JSON.parse(localStorage.getItem("chatState"))||{},r=o.floating||!1,a=!1!==o.isVisible;r?(e.style.display=a?"flex":"none",e.style.opacity=a?"1":"0"):(e.classList.remove("visible-chat","hidden-chat"),e.classList.add(a?"visible-chat":"hidden-chat")),document.addEventListener("keydown",(e=>{e.ctrlKey&&e.shiftKey&&"Space"===e.code?(e.preventDefault(),$t()):e.ctrlKey&&"Space"===e.code&&(e.preventDefault(),Tt())})),t&&t.addEventListener("click",Tt),n&&n.addEventListener("dblclick",Tt)}(),document.addEventListener("mousedown",(e=>{if(!e.target.closest(".chat-drag-area"))return;const t=document.getElementById("app-chat-container");let n=It();if(rn=!0,en=e.clientX,tn=e.clientY,nn=t.offsetLeft,on=parseInt(t.style.top)||t.getBoundingClientRect().top,!n.floating){const e=window.innerHeight-t.offsetHeight;t.style.top=e+"px",t.style.bottom="",n.top=e,n.floating=!0,t.classList.add("floating-chat"),At(n)}document.body.style.userSelect="none"})),document.addEventListener("mousemove",(e=>{if(!rn)return;const t=document.getElementById("app-chat-container"),n=window.innerWidth,o=window.innerHeight,r=e.clientX-en,a=e.clientY-tn,i=ke(nn+r,0,n-t.offsetWidth),s=ke(on+a,0,o-t.offsetHeight);t.style.left=i+"px",t.style.top=s+"px";let c=It();c.left=i,c.top=s,c.floating=!0,At(c)})),document.addEventListener("mouseup",(()=>{if(!rn)return;rn=!1;const e=document.getElementById("app-chat-container"),t=window.innerWidth,n=window.innerHeight,o=e.getBoundingClientRect(),r=o.left<0||o.top<0||o.right>t||o.bottom>n,a=n-o.bottom<50;let i=It();r||a?(e.style.top="",e.style.bottom="0",i.floating=!1,e.classList.remove("floating-chat")):(i.floating=!0,i.top=o.top,e.classList.add("floating-chat")),At(i),document.body.style.userSelect=""})),document.addEventListener("mousedown",(e=>{const t=e.target.closest(".resize-handle");if(!t)return;un=!0,pn=t.classList[1];const n=document.getElementById("app-chat-container");an=e.clientX,sn=e.clientY,cn=n.offsetWidth,ln=n.offsetHeight,dn=n.offsetLeft,mn=parseInt(n.style.top)||n.getBoundingClientRect().top,hn=e.clientY-mn,document.body.style.userSelect="none"})),document.addEventListener("mousemove",(e=>{if(!un)return;const t=document.getElementById("app-chat-container"),n=window.innerWidth,o=window.innerHeight,r=getComputedStyle(document.documentElement),a=parseInt(r.getPropertyValue("--min-chat-width"))||250,i=parseInt(r.getPropertyValue("--min-chat-height"))||200;let s=It();if("left"===pn){const o=Math.max(a,cn-(e.clientX-an)),r=ke(dn+(e.clientX-an),0,n-o);t.style.width=o+"px",t.style.left=r+"px",s.width=o,s.left=r}else if("right"===pn){const o=n-t.getBoundingClientRect().left,r=Math.min(o,Math.max(a,cn+(e.clientX-an)));t.style.width=r+"px",s.width=r}const c=e.clientY-hn;if("top"===pn)if(!1===s.floating){let e=ke(c,0,o-i),n=o-e;t.style.top=e+"px",t.style.height=n+"px",s.top=e,s.height=n}else{let e=ke(c,0,mn+ln-i),n=ln-(e-mn);n=Math.min(n,o),t.style.top=e+"px",t.style.height=n+"px",s.top=e,s.height=n}if("left"===pn||"right"===pn)if(!1===s.floating){let e=ke(c,0,o-i),n=o-e;t.style.top=e+"px",t.style.height=n+"px",s.top=e,s.height=n}else{let e=ke(c,0,mn+ln-i),n=ln-(e-mn);n=Math.min(n,o-e),t.style.top=e+"px",t.style.height=n+"px",s.top=e,s.height=n}t.offsetHeight>o&&(t.style.height=o+"px",!1===s.floating&&(t.style.top="0px",s.top=0),s.height=o),At(s),we()})),document.addEventListener("mouseup",(()=>{un=!1,document.body.style.userSelect=""})),window.addEventListener("resize",(()=>{jt(),we()})),function(){const e=document.getElementById("messages-panel");if(!e)return;new MutationObserver((()=>{we(),de(),ee(),$e(250)})).observe(e,{childList:!0,subtree:!0})}();const t=new ut("user-list"),n=new ft("messages-panel",xe(Ht.username)),o=gn(new rt({username:Ht.username,password:Ht.password,bindUrl:$,connectionDelay:100}),t,n,Ht.username),r=document.getElementById("message-input"),a=()=>{const e=r.value.trim();e&&(o.sendMessage(e),r.value="",r.focus())};document.getElementById("send-button").addEventListener("click",a),r.addEventListener("keypress",(e=>"Enter"===e.key&&a())),r.addEventListener("paste",(e=>requestAnimationFrame((()=>r.value=r.value.replace(/\b(https?:\/\/[^\s]+)/gi,(e=>je(e)?Ie(e):e)))))),(e=r)&&e.addEventListener("input",(()=>{De(e)})),Zt(r),await o.connect(),window.xmppClient=o}catch(e){console.error("App init error:",e),qt()}var e})().then((()=>{!function(){const e=document.querySelectorAll(".messages-panel .message");if(0===e.length)return;const t=new Set(Array.from(e).map((e=>ht(e)))),n=JSON.parse(localStorage.getItem("deletedChatMessagesContent")||"[]").filter((e=>t.has(e)));if(localStorage.setItem("deletedChatMessagesContent",JSON.stringify(n)),0===n.length){const e=document.querySelector(".toggle-button");e&&e.remove()}}(),Dt()}))})();